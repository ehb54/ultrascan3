<head>
   <title>Finite Element Simulations</title>
   <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
   <LINK href="mainstyle.css" rel="styleSheet" type="text/css">
</head>
<body TEXT="#000000" bgcolor="#FFFFFF" LINK="#0000EF" VLINK="#CF30CF" ALINK="#FF0000">
<table border=0 cellpadding=5>
<tr>
<td>
<img src=ultrascan1.png border=0>
</td>
<td align=vcenter>
<h1 align=center>"Manual"</h1>
</td>
</tr>
</table>
<hr>
<p>
<H2>Finite Element Simulations:</H2>
<p>
The Finite Element Simulation module can be started from the 
<a href=menu_simulation0.png>Simulation Menu</a> in the Main Menu.
<p>
<center>
<img src=finsim1.png>
</center>
<p>
<b>General Purpose:</b>
<p>
This program can be used to simulate sedimentation velocity and
sedimentation approach to equilibrium experiments with the finite element
method. You can choose from several models and define all pertinent model
parameters such as sedimentation and diffusion coefficients, partial
concentration, concentration dependency parameters as well as equilibrium
constants for equilibrating systems. The run parameters can be set to
control speed, duration of the experiment, presence and extent of time
invariant and gaussian distributed noise, scan numbers and frequency,
loading concentration and volume as well as cell dimensions. Finite
element discretization stepsizes can also be adjusted. The simulated data
can then be saved in UltraScan or in the ASCII Beckman XL-A data acquisition format for import into another spreadsheet
format, or analysis with various analysis methods. The purpose of the
simulation routine is twofold: 
<p>
<ol>
<li>Allow the researcher to model a velocity or equilibrium experiment
based on prior knowledge about the components in the system, so run
parameters such as rotor speed and time can be optimized for a particular
experiment
<p>
<li>to serve as an educational module for graduate level
courses teaching theory and application of sedimentation analysis. 
</ol>
<p>
When using the program to simulate experimental data to determine
optimal run conditions, approximate parameters such as molecular
weight or stoichiometry are often know. This knowledge can be used to
estimate sedimentation and diffusion coefficients with the module for
<a href=predict1.html>modeling "s", "D" and "f" from
molecular weight for 4 basic shapes</a>. After optimal run conditions
have been determined, they can be applied to the actual experiment to
minimize loss of expensive samples due to misconfigured XL-A/I settings.
<p>
The program can also be used in conjunction with the <a
href=calc_equil.html>Equilibrium Speed Estimator</a> to simulate approach
to equilibrium experiments. By monitoring the dcdt window, 
it is possible to determine when further change in concentration is lost
in noise and you can effectively tell the time by which
equilibrium has been reached (see below).
<p>
<b>Model Selection:</b>
<p>
The first step in simulating a sedimentation run is to define a
model. This is accomplished by pressing the <b>"Create New Model"</b>
button. This will display the <a href=finsim2.png>Model Selection</a>
Dialogue. Select a model from the list. For the non-interacting model you
can define the number of components to be modeled with the system. There
is no limit to the number of components that can be modeled with this
program. After selecting the appropriate model, click on the <b>"Assign
Coefficients (s, D, etc)"</b> button to assign values to the model's
parameter list.
<p>
If you chose a non-interacting system, you will be prompted with a
<a href=finsim3.png>dialogue</a> for entering partial concentration,
"s", "D" and concentration dependency parameters sigma and delta.
If you have selected to model more than one component, clicking on the
<b>"Next"</b> button will cycle through the list of selected components,
presenting coefficient dialogues for each component. After entering
the last component's parameters, click on the <b>"OK"</b> button to be
returned to the <a href=finsim2.png>Model Selection</a> dialogue.
<p>
If you choose an equilibrating system, an <a href=finsim4.png>information
message</a> will be displayed informing you that one of the four possible
parameters "s" and "D" can be left blank (assigned to zero)
because of the molecular weight constraints for the second component.
The Svedberg relationship allows three parameters to be specified,
while the fourth can then be automatically calculated.  The <a
href=finsim5.png>coefficient dialogue</a> for equilibrating systems
will display a single screen for both components, While it is possible
to assign values for all parameters, you should always leave one of the
four parameters set to zero so it can be more accurately assigned by
the program itself.
<p>
After entering all model parameters, you have the opportunity to save
the newly defined model. A <a href=finsim6.png>file dialogue</a>
will appear which allows you to save the model to a file. You will be
<a href=finsim7.png>prompted</a> to enter a short description for
your model to facilitate later identification. Once saved,
the model can be retrieved at a later time with the <b>"Load existing
Model"</b> button from the main finite element simulation panel.
<p>
<b>Selection of Run Conditions:</b>
<p>
To continue, you click on the <b>"OK"</b> button of the model definition
dialogue. You now have the opportunity to enter all relevant run parameters
into the <a href=finsim8.png>run control dialogue</a>. The following run 
properties can be defined:
<p>
<table border=1 cellspacing=5 cellpadding=5>
<tr>
<td>
<img src=finsim9.png>
</td>
<td>
<li>Run Duration - the length in hours and minutes of the experiments
<li>Time Delay for Scans - the time in hours and minutes before the 
first scan is recorded. This is similar to the Beckman Data Acquisition
program which allows you to program time delays with the Scan Methods.
<li>Rotor speed - an acceleration period is <i>not</i> considered
in this module. 
<li>Time Discretization Increment - The size of the time increments
used in the finite element simulation. The smaller the increment, the
more accurate the simulation, especially for faster sedimenting samples.
The tradeoff is that smaller time increments require longer computation
times.
<li>Radial Discretization Increment - The size of the radial increments
used in the finite element simulation. The smaller the increment, the
more accurate the simulation, This is especially important for steep 
concentration gradients as are often caused by fast sedimentation and
small diffusion coefficients, particularly at the bottom of the cell.
There, oscillations of the absorbance may occur as an artifact of the 
simulation, when the radial increment is too large. The tradeoffs for 
smaller radial increments are increased memory requirements and 
longer computation times.
<li>Meniscus Position - determined by the bottom of the cell position
(below) and the loading volume
<li>Bottom of Cell Position - This value will remain fixed for most cases,
but can be used to simulate rotor stretching (which has an influence on
the bottom of the cell position) and 6-channel centerpiece geomtry.
<li>Scans to be saved - the number of scans to be saved. All scans will
be equally distributed in time over the duration of the experiment minus
the time delay for scanning.
<li>Random Noise - Gaussian (normally) distributed noise with a standard
deviation in percentage points of the total absorbance (concentration).
A different noise distribution will be simulated for each scan. Random
noise can be mixed with time invariant noise by giving both non-zero values
to simulate both simulaneously. 
<li>Time Invariant Noise - Gaussian (normally) distributed noise with
a standard deviation in percentage points of the total absorbance
(concentration). The noise distribution will remain the same for all
scans in the run, simulating time-invariant noise. Time-invariant 
noise can be mixed with random noise by giving both non-zero values
to simulate both simulaneously.
</td>
</tr>
<tr>
<td>
<img src=finsim10.png>
</td>
<td>
You can save any method for a run for later retrieval by clicking on the
<b>"Save"</b> button. Previously saved run methods can be retrieved by 
clicking on the <b>"Load"</b> button. Click on the <b>"OK"</b>
button to be returned to the main finite element simulation panel.
To cancel changes in this dialogue, click on the <b>"Cancel"</b> button.
</td>
</tr>
</table>
<p>
<b>Running the Simulation:</b>
<p>
After defining model and run conditions, you are ready to simulate the
experiment. Click on the <b>"Start Simulation"</b> button to start the
calculation. In the upper panel you will see a movie of the simulation
process. In the legend of the upper panel the elapsed time and the component
that is being calculated will be shown. For models involving an equilibrium,
The letter "E" is displayed to indicate that an interacting equilibrium 
model is being simulated.
<p>
The lower panel will display selected snapshots (scans) from the simulation
process, defined by the scan number and delay selected in the run conditions
panel. For multi-component non-interacting systems, the scans will not
be shown until the last component is being calculated. The scan number and
the progress of the overall simulation status is updated in the lower 
legend. The simulation can be stopped at any time by clicking on the "<b>Stop
Calculation"</b> button. A summary of the current run conditions is always
shown to the left of the lower plot panel, a comprehensive list of model and
run conditions can be displayed by clicking on the <a href=finsim11.png>
<b>"Display all Settings"</b></a> button.
<p>
<b>Running an Approach to Equilibrium Simulation:</b>
<p>
You can simulate approach to equilibrium experiments with this module and 
use the software to monitor the time it takes to reach equilibrium. When
selecting this feature, you need to consider the following settings in the 
<a href=finsim8.png>run control dialogue</a>:
<p>
<ol>
<li>Only simulate a single component system for this feature - for multi -
component systems select the component with the smallest diffusion coefficient,
since it will determine the rate-limiting step.
<li>Select a short column length, perhaps 3 mm, by setting the meniscus
to 6.9 cm, and the bottom of the cell to 7.2 cm. Other centerpiece geometries
can be simulated by changing these values.
<li>Set the length of the experiment to a sufficiently long time to 
allow all simulated speeds to come to equilibrium (perhaps 2-3 days)
<li>Use the <a href=predict1.html>"Model s, D and f from Molecular 
Weight for 4 basic shapes"</a> module to estimate the sedimentation-
and diffusion coefficient for your molecule
<li>Use the <a href=calc_equil.html>"Equilibrium Speed Prediction"</a>
module to estimate the correct speeds for your experiment
<li>Add a little bit of random noise to your experiment to determine
a good reference for your signal to noise ratio.
<li>Set the number of scans such that the difference in time between scans
is at least 2-3 hours.
<li>Start the <a href=finsim22.png>dC/dt window</a> by clicking on the <b>
dC/dt Window"</b> button to monitor the approach to equilibrium. When
the residuals indicate that the change in concentration from scan to
scan is only due to noise, i.e, the <a href=finsim23.png>residuals
are random about zero</a>, you can click on the <b>"Change Speed"</b>
button to <a href=finsim24.png>change the speed</a> to the next higher speed.
</ol>
<p>
When the simulation is completed, a <a href=finsim25.png>time
window</a> will be shown to indicate how you should set up your XLA
to acquire data at the simulated times. This file can be printed
out and is available in your results directory under the name <a
href=equiltimes.txt>"equiltimes.dat"<a>.  The equilibrium distributions
for the simulated speeds will be shown in the <a href=finsim26.png>data
window</a>.

<p>
<b>Repeating a Model Simulation with Different Run Condition Settings:</b>
<p>
You can simulate the same model under different run conditions without 
having to redefine your model by simply pressing the <b>"Simulation
Parameters"</b> button. This will return you to the <a href=finsim8.png>
Run Parameter Setup Panel</a>, where you can change the run parameters.
The run is repeated simply by clicking on the <b>"Start Simulation</b>"
button again.
<p>
<b>Saving Simulated Data Scans to File:</b>
<p>
To save the scan files from your simulation for import into a third-party
plotting program, click on the <b>"Save Scan Files"</b> button. You will 
have the <a href=finsim21.png>option</a> to save the data to an <b><i>UltraScan</b></i>
compatible "us.v" velocity data file, or to the generic XLA format used
in the Beckman data acquisition software.
<p>
<b>Data Analysis of Simulated Data:</b>
<p>
Using the Analysis features of the finite element simulation program it is
possible to project the analysis results various methods would yield on a
system if it would have been run on the XL-A/I. The analysis modules are
particularly useful for teaching the theory of these analysis methods and
visualizing the particular strengths of each method.  Before any analysis
method can be used, it is necessary to actually simulate the data,
otherwise an <a href=finsim12.png>error message</a> will be displayed.
<p>
Analysis results from each method can be saved to an ASCII output datafile
for import into a third-party plotting program. A description of the
file format of this and all other UltraScan output files can be found
<a href=file_format.html>here</a>. The following analysis methods are
available for analyzing your simulated data:
<ul>
<p>
<li><a href=finsim13.png><b>van Holde - Weischet Analysis:</b></a> This method
is particularly useful to identify and quantify heterogeneity in the sample
and to measure concentration dependency of "s". <a href=finsim14.png>
Integral distributions</a> of the van Holde - Weischet data can be constructed
to assist in the quantification of the heterogeneity. 
<li><a href=finsim16.png><b>Second Moment Analysis:</b></a> The Second Moment
analysis is useful to detect global changes that occur over the course of the
run. These may include degradation, time-dependent aggregation, and pelleting
of sample. If the sample has not cleared the meniscus (as defined by 1/2000
of the total absorbance), and <a href=finsim15.png>error message</a> is 
displayed, and the plot points corresponding to scans with uncleared meniscus
absorbance are printed in red.
<li><a href=finsim17.png><b>Time Difference - Delta-C/Delta-t Analysis:</b></a>
The Time difference method excels at eliminating time invariant noise, as
may be present in interference data or absorbance data with dirty windows.
<a href=finsim18.png>Delta-C/Delta-t scan averages</a> can be displayed by clicking on the
<b>"Average"</b> button in the dcdt window.
<li><a href=finsim19.png><b>Radial Difference - Delta-C/Delta-r Analysis:</b></a> The radial difference method also provides derivative-domain data, although
for most practical purposes the analysis is often compromised by noise in
the experimental data. The <a href=finsim20.png>average</a> of multiple scans 
can sometimes compensate for some of the noise.
</ul>
<p>
To exit the program, click on the <b>"Close Simulation"</b> button.
<p>
<hr>
<font face=helvetica size=-1>
www contact: <a href=mailto:demeler@biochem.uthscsa.edu>Borries Demeler</a>
<p>
This document is part of the <i><b>UltraScan</i></b> Software
Documentation distribution. <br><a href=copyright.html>Copyright &copy; notice</a>
<p>
The latest version of this document can always be found at:
<p>
<ol>
<a href=http://www.ultrascan.uthscsa.edu>http://www.ultrascan.uthscsa.edu</a>
</ol>
<p>
Last modified on January 12, 2003.
</body>
</html>
 
