<head>
   <title>Finite Element Whole Boundary Fitting Data Analysis</title>
   <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
   <LINK href="mainstyle.css" rel="styleSheet" type="text/css">
</head>
<body TEXT="#000000" bgcolor="#FFFFFF" LINK="#0000EF" VLINK="#CF30CF" ALINK="#FF0000">
<table border=0 cellpadding=5>
<tr>
<td>
<img src=ultrascan1.png border=0>
</td>
<td align=vcenter>
<h1 align=center><i>Manual</i></h1>
</td>
</tr>
</table>
<hr>
<p>
<H2>Finite Element Whole Boundary Fitting Data Analysis:</H2> 
<b>(Nonlinear least squares by automatic differentiation)</b>
<p>
The Finite Element Whole Boundary Fitting method is based on the numerical
solution of the Lamm equation, which is achieved through discretization
of the two major variables, radius and scan time, into finite elements.
As such, it is possible to accurately model not only the boundary, but also
the boundary conditions, such as meniscus and cell bottom. The main purpose
of using the Finite Element method is for the modeling of well-defined 
homogeneous or paucidisperse solutions. This includes single and dual-component
systems, simple self-associating systems and isomerizing systems. Modeling
with the Finite Element method will result in both <i>s</i> and <i>D</i>,
which can be used to calculate <i>f</i> and either molecular weight or
the partial specific volume, provided one or the other is known 
<i>a priori</i>. 
<p>
Fitting experimental data to a model involves a nonlinear least squares
minimization algorithm. This finite element fitting module utilizes the 
Automatic Differentiation method (AD). More information about this method
can be found <a href=http://www.math.tu-dresden.de/wir/project/adolc/>
here</a>. With the help of the automatic differentiation library "ADOLC", 
this method generates all entries of the Jacobian
matrix using the chainrule to arrive at an exact derivative, accurate to
within machine error and comparable to an analytical derivative. Such 
a fitting algorithm tends to converge within just a few iterations. 
The disadvantage of this method is that it needs to generate very large
temporary files ("tapes") of the derivative calculations, which requires
fast memory input/output and large storage.
<p>

You start the Finite Element data analysis by clicking on "<A HREF="menu_velocity0.png">
Finite Element</A>" in the Velocity sub-menu of the main menu. The main 
<A HREF="finite-dud1.png">Finite Element Data analysis window</A> will appear.
<p>
The first step in the analysis requires that you load an
<b><I>UltraScan</I></b> dataset that has previously been edited with
the <b><I>UltraScan</I></b> editing module. <b><I>UltraScan</I></b>
sedimentation velocity datasets always have the suffix ".us.v". Click on
the <a href=finite-dud1.png><b><I>Load Dataset</I></b></a> button in the
left upper corner of the control panel. Simply select the desired run from
the selection of available runs in the <A HREF="load_sed.png">dataset
loading dialog</A>. Once loaded, the first available dataset of the
selected run will be <a href=finite-dud2.png>displayed</a> in the
data window on the lower right panel. To start the analysis, a model
has to be defined. Click on <a href=finite-dud2.png><b><i>Create a new
Model</i></b></a> to define a <a href=finite_model.html>model</a>. To
assist you in defining the proper model it is <b><i>strongly</i></b>
recommended to analyze the data first by the <a href=vhw.html>van Holde
- Weischet analysis method</a>. This method will allow you to identify
very accurately the presence of multiple components and provide you
with reasonable starting guesses for your model. After defining the
model, you can start the fitting process by clicking on the button <a
href=nls.html><b><i>Fitting Control</i></b></a>. During fitting, the 
program will graphically show the converging fit by <a href=nls9.png>displaying the 
residuals and the experimental data overlaid with the fit</a>. After
fitting is complete, the analysis will be shown in the <a
href=finite-dud5.png>main window</a>, with the first five residuals shown
in the analysis window, and the first five scans overlayed in red with
the finite element solution. The <a href=finite-ad2.png>fitting control
window</a> will indicate the final variance of the last iteration. Next,
you can print out the residuals and overlayed data by clicking on the <a
href=printer_control.html> <b><i>Print Data</i></b></a> button, export the
result files (<b><i>Save Data</i></b>, see <a href=file_format.html>File
Format Information</a>), or view the <a href=finite_report.txt>Analysis
Result Report</a>.

<p><b>Analysis Functions:</b>
<br>
<table BORDER CELLSPACING=5 CELLPADDING=5 bgcolor="#FFFFFF" NOSAVE >
<tr>
<td><img src="finite-dud7.png" ></td>

<td>Click on these buttons to control the time derivative analysis.
<UL>
<li>
<b>Load Data:</b> Load edited data sets (with the *.us.v suffix). A 
<a href=load_sed.png>file dialogue</a> will allow you to select a
previously edited and saved velocity experiment. If the data was edited 
with a previous version of UltraScan, an <a href=version.png>error
message</a> will be displayed.

<li>
<b>Run Details:</b> View the <A HREF="run_details_veloc.png">diagnostic details</A>
for a particular run.

<li>
<b>Monte Carlo:</b> Perform <a href=monte_carlo.html>Finite Element
Monte Carlo statistics</a> on the analyzed data.
Due to the high computational needs of this function, this feature 
should only be used with the Beowulf/SMP versions of 
<i><b>UltraScan</b></i>. This feature is disabled until a converged fit
has been obtained or loaded with <b>Load Fit</b>.

<li>
<b>Save Data:</b> Write out a copy of all results to an ASCII formatted
data file suitable for import into a spreadsheet plotting program. See
"<A HREF="file_format.html">File Structures and Formats</A>" for details.
Note: These files are overwritten each time this button is clicked. Only
the last version of the analysis will be saved!

<li>
<b>Print Data:</b> Load the <a href=printer_control.html>printer control
panel</a> for printing of plot
graphics 

<li>
<b>View Data Report:</b> See the data report for the last analysis setting.
Note: This file is re-written each time it is accessed. Only the current
analysis result is available. Click <a href=finite_report.txt>here</a> 
for a sample of a finite element data report

<li>
<b>Help:</b> This help file

<li>
<b>Close:</b> Close the Finite Element analysis window.
</UL>
</td>
</tr>
</table>
<b></b><b></b>

<p><b>Run Information:</b>
<br>
<table BORDER CELLSPACING=5 CELLPADDING=5 NOSAVE >
<TR NOSAVE>
<TD NOSAVE><img src="vhw-5.png" ></td>

<TD NOSAVE>
<UL>
<li>
Run ID: The name of the run given during editing

<li>
Temperature: The average temperature calculated from the entire run

<li>
Available Cells: The numbers the cells that contain analyzable data
</UL>
Clicking on a cell and wavelength selection will bring up the cell contents
description for that cell and wavelength. Scroll through this list to bring
up information for cells > 3. If there is no data available for the selected
cell, the program will list "No Data available". Selecting a cell/wavelength
combination will automatically bring up the corresponding dataset and present
the raw data in the lower plot window.</td>
</tr>
</table>
<p><b>Experimental Parameters:</b>
<br>
<table BORDER CELLSPACING=5 CELLPADDING=5 bgcolor="#FFFFFF" NOSAVE >
<tr>
<td><img src="finite-dud8.png" ></td>

<td>Here you can enter the corrections for density and viscosity of
your buffer. When you change the information in these fields, the
program will automatically update the analysis to correct the S-value
according to the specified buffer conditions. If you change the settings
for density and viscosity after you finished a calculation, be sure to
click on the <i><b>Update for 20<sup>o</sup>C,W</b></i> button in the
<a href=finite_model_ctrl1.png>Model Control window</a> to make sure that all
parameters are recalculated for the updated buffer settings.
<UL>
<li>
<b>Density:</b> Click to <A HREF="hydro.html">calculate</A> the density
based on the composition of your buffer.

<li>
<b>Viscosity:</b> Click to <A HREF="hydro.html">calculate</A> the viscosity
based on the composition of your buffer.
</ul>
</td>
</tr>
</table>

<br>

<p><b>Analysis Controls:</b>
<br>
<table BORDER CELLSPACING=5 CELLPADDING=5 NOSAVE >
<tr>
<td><img src="finite-dud9.png" ></td>

<td>
<UL>
<li><b> Create new Model:</b> This button allows you to <a href=finite_model_ctrl.html>
create a new model</a> to be fitted to your data with the finite element 
analysis

<li>
<b>Reset Data </b>- use this button to reset the default settings for the
analysis.

<li>
<b>Load Fit:</b> With this function you can recall a previously saved fit
(saved with "<b>Save Fit</b>"  - see below). It will recall the exact
memory state when the fit was saved, including vbar, density and viscosity 
settings, residuals, raw data and data details. The only requirement is
that the file containing the edited data on which the fit is based is
available in the "Results Directory" set in the <a href=config.html>
configuration</a>.  

<li>
<b>Fitting Control:</b> This button will recall the <a
href=nls.html> fitting control panel</a>.  Before pressing
this button, a valid model has to be defined.

<li>
<b>Model Control:</b> This button will recall the <a
href=finite_model_ctrl.html> model control panel</a>.  Before pressing
this button, a valid model has to be defined.

<li>
<b>Save Fit:</b> Use this button to save a converged fit (either for later
review or for later Monte Carlo Analysis). The routine will save all pertinent
data including the fitted data, the residuals, the parameter values, the model,
the hydrodynamic settings (vbar, density, viscosity), data range and excluded
scans. 
<li>
<b>Residuals:</b> Once the fitting process has completed, this counter 
allows you to display the residuals of the fit in groups of 5 scans. Use the
counters to select different groups of residuals. The single arrow will 
move in single steps (5 scans at a time), while the double arrow will 
advance the groups by 10 with each click (jumps 50 scans).
is feature to smooth the experimental data.

<li>
<b>% of Boundary:</b> This setting allows you to select only a portion of
the boundary to be fitted to a finite element solution.

<li>
<b>Boundary Position (%):</b> Use this counter to move the selected boundary
portion up and down between the baseline absorbance and the plateau absorbance.

<li>
<b>Exlude Single Scan:</b> When setting this counter to a non-zero value,
the respective scan will be highlighted in red. Clicking on "Excl. Single
Scan" while a scan is highlighted in red will delete this scan from the
analysis. Deleting scans from the analysis is irreversible and can only
be reset by clicking on the "Reset" button or by reloading the data.

<li>
<b>Exclude Scan Range: </b>Same as "<b>Exclude Single Scan</b>", except
for multiple scans. To use this feature, select first the start scan of
the range by using "<b>Exclude Single Scan</b>", then complete the scan
range by using "<b>Exclude Scan Range</b>". To be excluded scans are
highlighted in red and will be deleted from the dataset when clicking
on "<b>Exclude Scan Range</b>".

<li>
<b>Status: </b>The status bar is reserved for the Beowulf/SMP version of
UltraScan to monitor the progress of the Monte Carlo fitting statistics
and is without effect for all other <i><b>UltraScan</i></b> releases.
</UL>
</td>
</tr>
</table>
<p>
<hr>
<font face=helvetica size=-1>
www contact: <a href=mailto:demeler@biochem.uthscsa.edu>Borries Demeler</a>
<p>
This document is part of the <i><b>UltraScan</i></b> Software Documentation
distribution. <br><a href=copyright.html>Copyright &copy; notice</a>.<p> The latest version of this document can always be found at:
<p>
<ol>
<a href=http://www.ultrascan.uthscsa.edu>http://www.ultrascan.uthscsa.edu</a>
</ol>
<p>
Last modified on January 12, 2003.
</body>
</html>
