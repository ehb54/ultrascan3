<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta content="text/html;charset=ISO-8859-1" http-equiv="Content-Type">
	<title>SOMO HPLC/KIN Module</title>
	<link href="mainstyle3.css" rel="styleSheet" type="text/css">
</head>
<body>
<table BORDER=0 CELLPADDING=5 >
<tr>
<td><img SRC="USSOMO-banner.png" BORDER="0" ALT="UltraScan Version"> </td>
<td>
<center>
<h1>
<i>Manual</i></h1></center>
</td>
</tr>
</table>

<hr>
<center>
<h2>
SOMO HPLC/KIN Module:</h2></center>
<h3><center>Last updated: July 2024 </center></h3><p>

<center><span style="color:#CC0000">NOTICE: this module is being developed by E. Brookes, J. P&eacute;rez, P. Vachette, and M. Rocco.<br>
Portions of this help file are taken from the Supplementary Materials of Brookes et al., "Fibrinogen species as resolved by HPLC-SAXS data processing within the UltraScan SOlution MOdeler (US-SOMO) enhanced SAS module", J. Appl. Cryst. 46:1823-1833 (2013), and from Brookes et al. "US-SOMO HPLC-SAXS Module: Dealing with Capillary Fouling, and Extraction of Pure Component Patterns from Poorly Resolved SEC-SAXS Data", J. Appl. Cryst. 49:1827-1841, 2016. Some subsequent improvements are discussed in Brookes and Rocco, "Recent advances in the UltraScan SOlution MOdeller (US-SOMO) hydrodynamic and small-angle scattering data analysis and simulation suite", Eur. Biophys. J. 47:855-864 (2018). The most recent (July 2024) developments will be subsequently published (Brookes and Rocco, in preparation).</span>
</center>

<p>
This <b>US-SOMO</b> module was originally conceived for the analysis of HPLC-SAXS data, in particular from size-exclusion chromatography (SEC). From the <b><i>US-SOMO</i></b> <span style="color:#CC0000">July 2024 intermediate release</span>, it has been renamed <b><i>HPLC/KIN</i></b> to reflect the enhancements that were made to deal with kinetics-derived data, which are similar in certain aspects to the on-line chromatography-derived data. The vast majority of this <b>Help</b> will still extensively deal with the treatment of SEC-SAXS data.<br>

<center>
<img SRC="somo-HPLC-SAXS_3.png" ALT="SOMO HPLC-SAXS Lysozyme I(q) data" width="1000">
</center>
<p>
In the image above, the main panel of the <b><i>HPLC/KIN</i></b> module is shown. The buttons with the black labels are the ones currently active, the ones with the red labels become active when allowed by the processing/visualization stage. The graphics panel shows a collection of HPLC-SAXS log<sub>10</sub>[<i>I(q)</i>] vs. <i>q</i> SAXS data frames (points with 0 or negative values are automatically omitted from the visualization only) for a chicken egg-white lysozyme chromatographic separation   on a Agilent BioSec-3 (3 &mu;m particle size, 300 &Aring; pore-size) 4.6&nbsp;&times;&nbsp;300&nbsp;mm column, eluted with Hepes 50&nbsp;mM, NaCl&nbsp;100 mM, pH&nbsp;7. Note the permanent upturn at very small <i>q</i>-values, due to biological material aggregated by the intense X-ray beam on the capillary cell walls under these far from optimal experimental conditions. While this kind of problem should be (and has been) preferentially dealt with at the experimental level, we use this dataset to demonstrate the potential for correcting data still presenting such an issue.<p>

The left side of the window is divided in three sections, labeled "<b><i>Data files</i></b>", "<b><i>Produced Data</i></b>", and "<b><i>Messages</i></b>". By clicking on these labels, the corresponding panel below each label will disappear, allowing for an expansion of the remaining other panel(s). If every panel is made to disappear, the main graph will expand to cover the full size of the <b><i>HPLC/KIN</i></b> module window. By clicking again on the labels, the corresponding panels will be restored.<p>

On the top left panel (<b><i>Data files</i></b>) there are seven buttons:
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_top_buttons.png" ALT="Somo-HPLC/KIN Top buttons"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
<ul>
<li>
<span id="conc_load"></span>
The first button, <b><i>Conc. file load</i></b>, is used to upload any chromatographic data files containing a concentration-related elution profile, such as those produced by UV-VIS absorption or refractive index detectors (the program will then internally keep track of such datasets, distinguishing them from SAXS datasets). In theory, a similar concentration-profile file can be generated and used for kinetics data, where, howewer, the concentration is usually constant and thus can be entered as a single parameter (see below). By default, the program will look for "*.txt" and "*.csv" files, but the choice could be expanded to other extensions in the file upload dialogue. The currently recognized format for non-CSV concentration data is similar to the SAXS data format with the addition of the string "Frame data" in any place on the first line. The two or three columns of data are the frame number, concentration-related data, and optionally an associated SD value. For loading CSV format concentration data files, see <a href=saxs_hplc_conc_csv_frames.html>here</a>. <p>

<li>
<b><i>Concentrations</i></b> will show every file listed together with their associated concentration [mg/mL], if appropriate and properly set (see below). Concentrations can also be entered and modified manually. They can be used to normalize the <i>I(q)</i> vs. <i>q</i> data (see below).<p>

<li>
<b><i>View Selected</i></b>, active when up to ten datasets are selected, will show them in text format.<p>

<li>
The <b><i>Add files</i></b> button is used to load SAXS data into the module. An operating directory can be pre-selected by clicking on the path shown on the top of this section, and navigating in the file system (selecting the <i>Lock</i> checkbox will fix that directory). The file format for SAXS data recognized by the <b>US-SOMO</b> <b><i>HPLC/KIN</i></b> module consist of .dat files with two or three TAB- or space-separated columns containing the <i>q</i>, <i>I(q)</i>, and optionally their associated standard deviation (SD) values, respectively. Each frame number (or time value) must be present somewhere in the filename with a common prefix and suffix. For example, data1saxs.dat, data2saxs.dat, data3saxs.dat will be recognized as frames 1,2,3, where "data" and "saxs" can be replaced by any common sequence of characters. Consequently, 1.dat, 2.dat, 3.dat would be acceptable, but abc1.dat, qrs2.dat, xyz3.dat would not, because the prefix characters are not common. Furthermore, the loader will also arrange the data files sequentially, in increasing frame number (or time value) order.  <i>I(q)</i> vs. <i>q</i> and concentration data frames are automatically recognized and the labels on the <i>x</i>- and <i>y</i>-axes are then properly set in the graphics window.<br>
Note that when loading <i>I(q)</i> data files containing <i>q</i> values, they are expected to be in 1/Angstrom or 1/nm units. If the 1st line of the data file contains the text <i>Units:1/A</i> or <i>Units:1/nm</i>, it will be automatically loaded in the proper format.  Otherwise, it is controlled by the setting of the <a href=somo_saxs_options.html#sasmiscellaneous>SAS Miscellanous Options</a>, in particular, the <i><b>I(q) curves in 1/angstrom</b></i> and the <i><b>I(q) curves in 1/nanometer</b></i> mutually exclusive checkboxes.  All 1/nm data will be converted into 1/Angstrom data upon loading. Files saved will be written with the <i>Units:1/A</i> header text automatically.<br>
Loaded files can be displayed on the graphics panel by individually clicking on them (shift-click will select a contiguous series, ctrl-click allows multiple irregularly spaced selections). Produced data will also show up in this panel with associated putative filenames.<p>
<li>
<b><i>Add Dir.</i></b> will allow loading all files within a selected directory. <span style="color:#CC0000">Warning</span>: you must be sure that all files in the selected directory are consistent with each other, <i>i.e.</i>, that no other kind of files are present. Also, no sub-directories must be present within the selected directory.<p>
<li>
<b><i>To SOMO/SAS</i></b> will transfer selected datasets back into the <b>US-SOMO <i>SAS</i></b> module.<p>
<li>
<b><i>Remove files</i></b> will discard previously selected files (see below); if the files were produced by the module, and were not previously saved, a warning window will pop-up, allowing to save them, proceed without saving, or to stop removing the selected items:
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_remove_panel.png" ALT="Somo-HPLC/KIN question asked on removing"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
</ul>
<br>
Below the window with the loaded files listing there is a second section of buttons:
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_second_set_buttons.png" ALT="Somo-HPLC/KIN Second Set of buttons"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
<ul>
<li>
<b><i>Sel. all</i></b> will select all files.<p>
<li>
<b><i>Sel. Unsel.</i></b> will allow toggling the selection between selected files and everything else not currently selected.<p>
<li>
<b><i>Adv. Sel.</i></b> will open up a panel in which several selection options can be utilized (see <a href=saxs_hplc_nth.html>here</a>).<p>
<li>
<b><i>Conc. Norm.</i></b> will divide the selected <i>I</i>(<i>q</i>) data by the stored/entered concentrations, if available.<p>
<li>
<b><i>Average</i></b> will produce an average with propagated SDs of selected data. The <i>I</i>(<i>q</i>) values from each frame will be averaged, and then a scaling factor will be determined for each frame against the average resulting frame. The scaling factor for each original frame multiplies the frames's SD. The average intensity SDs are computed as the square root of the sum of the squares of each curves scaled SDs, and this is divided by the number of curves. The resulting datset filename will contain the number of frames averaged, and the initial and final frame numbers, followed by "_avg".<p>
<li>
<b><i>Bin</i></b> allows averaging adjacent points in <i>I</i>(<i>q</i>) datasets, starting with the first point in the file and using a binning size defined in a pop-up dialogue:<p>

<center>
<img SRC="somo-HPLC-SAXS_bin.png" ALT="SOMO HPLC-SAXS binning window panel">
</center>
<p>
<li>
<b><i>Smooth</i></b> performs a regularization of selected data using a moving window, whose dimension is defined in a pop-up menu (shown below), using a Gaussian smoothing kernel of 2<i>n</i>+1 points.<p>
<center>
<img SRC="somo-HPLC-SAXS_smoothing.png" ALT="SOMO HPLC-SAXS smoothing window panel">
</center>
<p>
<li>
<b><i>SVD/EFA</i></b> opens a pop-up window were a Single-Value Decomposition (SVD) analysis (e.g., see Williamson et al.,  Biophys J. 94, 4906-4923, 2008) and an Evolving Factor Analysis (EFA) (e.g., see Meisburger et al., J. Am. Chem. Soc. 138:6506-6516, 2016) can be performed on the selected data (see <a href=somo_saxs_hplc_svd.html>here</a>). <span style="color:#CC0000">Important:</span> the data must be all on the same grid; if not, a warning message will appear in the bottom left <b><i>Messages</i></b> window: "<span style="color:#CC0000">SVD: curves must be on the same grid, try 'Crop Common' first</span>" (see below for the use of the <b><i>Crop Common</i></b> button).<p>
<li>
<b><i>Make I#,I*(q)</i></b>. This is a new function, available from the <span style="color:#CC0000">July 2024</span> <b><i>US-SOMO</i></b> release. It was developed because of the new <b><i>US-SOMO SAS</i></b> module features allowing to join <i>Multi-Angle Light Scattering (MALS)</i></b> data with SAXS data, for global analyses on an expanded <i>q</i> range. Joining is possible only if the <i>intensities</i> of the two datasets are in the same, absolute scale. A first absolute scale for the intensity is in [g<sup>2</sup>/(cm<sup>3</sup>*mol)], that we identify with the symbol "<i>I#</i>(<i>q</i>)". By dividing <i>I#</i>(<i>q</i>) data by the concentration of the sample in mg/mL, one obtains the data in the absolute scale of [g/mol], which we previously identified with the symbol "<i>I*</i>(<i>q</i>)" (see <a href=saxs_hplc_parameters.html><b><i>here</b></i></a> for a listing of the required parameters and the equations used). The <i>I*</i>(<i>q</i>) units are also needed by the <a href=somo_saxs_options.html><b><i>Guinier analysis</b></i></a> feature of the <b><i>US-SOMO SAS</i></b> module, allowing to directly determine the weight-average molecular weight &lt;<i>M</i>&gt;<sub>w</sub> from the Guinier fit intercept.<br>
On pressing this button, a first pop-up panel will appear:
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_MakeIdashIstar_popup1.png" ALT="Somo-HPLC/KIN Make I#(q) or I*(q) first pop-up panel"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
listing the SAXS processing parameters as stored in the <a href=saxs_hplc_parameters.html><b><i>SAXS Processing parameters</b></i></a> sub-module of the <a href=saxs_hplc_options.html><b><i>HPLC/KIN Options</b></i></a> module. If these parameters are deemed not correct for the sample being analyzed, pressing <i>No</i> will stop the operation, otherwise pressing <i>Yes</i> the <i>I</i>(<i>q</i>) vs. <i>q</i> data will be later on internally converted to <i>I#</i>(<i>q</i>) or <i>I*</i>(<i>q</i>) vs. <i>q</i>, and another pop-up panel will appear:
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_MakeIdashIstar_popup2.png" ALT="Somo-HPLC/KIN Make I#(q) or I*(q) second pop-up panel"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
asking for <i>optionally</i> converting the frame numbers to times with the default values shown in the image. The <i>Starting time [s]</i> can be left to "0" (the choice for kinetic data if they have been already trimmed to the starting point of the reaction), or it allows to correctly assign the elution time of the first frame for SEC-SAXS data, which are usually not recorded until the beginning of the sample elution from the column. The <i>Exposure time [s]</i> (default "0") can also be <i>optionally</i> inserted in the second field, in which case be <i>careful</i> to correctly enter the <i>Frame interval [s]</i> (default "1") in the third field. For instance, if the exposure time is 0.01 s, a frame interval of 0.99 s will then produce a step of 1 s between the frames.<br>
Pressing <i>Cancel</i> will avoid converting frame numbers to times, pressing <i>OK</i> will perform this operation. Regardless of the choice (we hit <i>Cancel</i> in this example), a third pop-up panel will appear:
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_MakeIdashIstar_popup3.png" ALT="Somo-HPLC/KIN Make I#(q) or I*(q) third pop-up panel"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
this time asking if a <i>normalization</i> of the <i>I</i>(<i>q</i>) data should be performed. The values shown for the <i>experimental</i> and <i>theoretical</i> <i>I0</i> of the standard are also taken from the <a href=saxs_hplc_parameters.html><b><i>SAXS Processing parameters</b></i></a> sub-module of the <a href=saxs_hplc_options.html><b><i>HPLC/KIN Options</b></i></a> module, but they can be modified here.<br>
Pressing <i>Cancel</i> will avoid normalizing the <i>I</i>(<i>q</i>) data (the usual choice since nowadays data are given to the user already normalized), pressing <i>OK</i> will perform this operation (we hit <i>OK</i> for this example as the data were not already normalized). A fourth pop-up panel will then appear:
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_MakeIdashIstar_popup4.png" ALT="Somo-HPLC/KIN Make I#(q) or I*(q) fourth pop-up panel"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
in which a solute <i>global concentration</i> [mg/mL] can be entered. Entering a concentration is appropriate for kinetic or batch data, where it is expected to remain constant for all frames. For chromatographic data (as in this case), the solute concentration varies frame-to-frame, and can be later asessed from UV or RI monitors data.<br>
Pressing <i>Cancel</i> will then produce <i>I#</i>(<i>q</i>) vs. <i>q</i> frames (as in this example), while entering a concentration and pressing <i>OK</i> will produce <i>I*</i>(<i>q</i>) vs. <i>q</i> frames, as indicated in the final pop-up panel:
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_MakeIdashIstar_popup5.png" ALT="Somo-HPLC/KIN Make I#(q) or I*(q) fifth pop-up panel"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
Pressing <i>OK</i> the procedure completes, and the <i>I#</i>(<i>q</i>) or <i>I*</i>(<i>q</i>) vs. <i>q</i> produced data will be shown in the <i><b><i>Data files</i></b></i> panel, automatically selected only and thus appearing in the graphics window with the correct units posted on the <i>y</i>-axis label:
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_MakeIdashIstar_final.png" ALT="Somo-HPLC/KIN Make I#(q) or I*(q) results" width="1000"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
<br>
As a kinetics data processing example, we load SAXS data on a fibrin re-polymerization experiment, where fibrin monomer obtained from solubilization of a fibrin clot with sodium acetate 100 mM, pH 4.6,  and purified by SEC on a preparative column, was mixed it in a 1:1 ratio with Tris 65 mM, NaCl 100 mM, pH 12.3, restoring near-physiological conditions of pH &sim;7.4. The reaction mixture was sequentially injected into a <i><b>Multi-Angle Light Scattering (MALS)</i></b> detector and in the SAXS capillary. SAXS frames were recorded every 2.5 s with a sample-to-detector distance of 2.56 m (Rocco, Thureau, P&eacute;rez, et al., manuscript in preparation): 
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="SAS_HPLC_KIN_FG_poly1.png" ALT="Somo-HPLC/KIN loading fibrin polymerization data" width="1000"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
After entering the appropriate parameters for this sample/buffer in the <a href=saxs_hplc_parameters.html><b><i>SAXS Processing parameters</b></i></a> sub-module of the <a href=saxs_hplc_options.html><b><i>HPLC/KIN Options</b></i></a> module, we press <b><i>Make I#,I*(q)</i></b>, and the pop-up will appear:
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_MakeIdashIstar_popup1FB.png" ALT="Somo-HPLC/KIN Make I#(q) or I*(q) first pop-up panel"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
listing the new SAXS processing parameters. Pressing <i>Yes</i> the <i>I</i>(<i>q</i>) vs. <i>q</i> data will be later on internally converted to <i>I#</i>(<i>q</i>) or <i>I*</i>(<i>q</i>) vs. <i>q</i>, and the second pop-up panel will appear:
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_MakeIdashIstar_popup2FB.png" ALT="Somo-HPLC/KIN Make I#(q) or I*(q) second pop-up panel"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
We leave the <i>Starting time [s]</i> "0" as these kinetic data were collected immediately after injection. We set the <i>Exposure time [s]</i>  to 0.5 s and the <i>Frame interval [s]</i> t0 2 s. Pressing <i>OK</i> will perform this operation, and the third pop-up panel will appear:
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_MakeIdashIstar_popup3.png" ALT="Somo-HPLC/KIN Make I#(q) or I*(q) third pop-up panel"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
asking if a <i>normalization</i> of the <i>I</i>(<i>q</i>) data should be performed. We press <i>Cancel</i> since the data were already normalized at the beamline. The fourth pop-up panel will then appear:
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_MakeIdashIstar_popup4FG.png" ALT="Somo-HPLC/KIN Make I#(q) or I*(q) fourth pop-up panel"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
in which a solute <i>global concentration</i> [mg/mL] can be entered. We enter 0.303 mg/mL, appropriate for these kinetic data, where it is expected to remain constant for all frames. Pressing <i>OK</i> will produce <i>I*</i>(<i>q</i>) vs. <i>q</i> frames, as indicated in the final pop-up panel:
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_MakeIstar_popup5.png" ALT="Somo-HPLC/KIN Make I#(q) or I*(q) fifth pop-up panel"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
Pressing <i>OK</i> the procedure completes, and the <i>I*</i>(<i>q</i>) vs. <i>q</i> produced data will be shown in the <i><b><i>Data files</i></b></i> panel, automatically selected only and thus appearing in the graphics window with the correct units posted on the <i>y</i>-axis label:
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_MakeIstarFB_final.png" ALT="Somo-HPLC/KIN Make I*(q) for FB results" width="1000"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
These data can be then joined with MALS-derived data in the <b><i>MALS+SAXS</i></b> module (see <a href=somo_mals_saxs.html>here</a>).<p>
<br>

<hr>
We return now to the previous SEC-SAXS sample to describe the use of other features.<p>
<li>
The next button, <b><i>Make I(t)</i></b>, launches one of the crucial operations in the <b><i>HPLC/KIN</i></b> module. Since a typical HPLC-SAXS experiment produces a series of <i>I(q)</i> vs. <i>q</i> data collected at some time interval ("frames"), they can be inserted in a 2D matrix where each line corresponds to a frame number (or time value) and the columns contain the intensities <i>I(q)</i> and their associated SDs at the various scattering angles <i>q</i>. It is then a simple operation to generate another matrix where the lines correspond to the <i>q</i>-values and each column contains the intensities <i>I(t)</i> (and their associated SDs) corresponding to each frame number (or time value). A new data set consisting of <i>I(t)</i> vs. <i>t</i> "chromatograms" for each <i>q</i>-value can then be generated, where <i>t</i> can be real elution time or frame number) for each <i>q</i>-value present in the original data files (see below). A test could be automatically performed each time an <i>I</i>(<i>q</i>) vs. <i>q</i> dataset is converted into an <i>I</i>(<i>t</i>) vs. <i>t</i> dataset to ascertain if any <i>I</i>(<i>t</i>) vs. <i>t</i> "chromatogram" contain useful data, on the basis of a comparison between the signal and its associated SDs, by selecting its relative checkbox and the SD factor in the <b><i>Options</i></b> menu accessible from the button provided at the bottom of this window (see <a href=saxs_hplc_options.html>here</a>).<p>
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_MakeIt_discard_It.png" ALT="Somo-HPLC/KIN Make I(t) discarding files without signal above 3SD"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>

In this case, relatively few files did not pass this test, all in the high <i>q</i>-range. Pressing <i>OK</i> will allow the process to proceed, and a second test is performed, the negative integral window test (with a sliding size of 25 points):
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_MakeIt_integral_test.png" ALT="Somo-HPLC/KIN Make I(t) discarding files that failed the integral test"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
Here, just one file failed the test (see <a href=saxs_hplc_options.html>here</a> for a full explanation of this test's significance). Pressing <i>OK</i> will allow the process to complete:
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_MakeIt.png" ALT="Somo-HPLC/KIN Make I(t) result" width="1000"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
resulting in the data been shown as a series of <i>I#(t)</i> vs. <i>t</i> chromatograms (automatically selected only), one for each scattering angle, whose value is reported in the generated files names with the extension <i>"qx_xxxxx"</i>, where "x_xxxxx" is the <i>q</i>-value with "_" replacing the decimal point. Visual inspection of the <i>I(t)</i> vs. <i>t</i> chromatograms can already hint at problems, such as in the lysozyme data here used as an example. In this case, it is evident that many <i>I(t)</i> vs. <i>t</i> chromatograms starting from the low-<i>q</i> region do not return to pre-peak elution baseline intensity values. Most likely, this is due to capillary fouling, and without proper correction these data would be mostly useless. For this, and for less evident cases, an Integral Baseline correction procedure has been devised (see below and <a href=somo_saxs_hplc_baseline_corr.html>here</a> for a full description of this utility).<br>

<li>

<b><i>Test I(t)</i></b> Checks the <i>I</i>(<i>t</i>) vs. <i>t</i> selected curves to see if any fail the negative region test as described above.<p>

<li>

<b><i>Make I(q)</b></i> is the other crucial operation in the <b><i>HPLC/KIN</i></b> module. It allows to re-generate <i>I</i>(<i>q</i>) vs. <i>q</i> files for each frame after data treatment in time space. This operation will be described in details later on.<p>

</ul>

<br>


The file names of produced data are shown in the <b><i>Produced Data</b></i> panel to the centre-left, and can be selected and saved to files using the appropriate buttons below it.<p>
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_Produced_data.png" ALT="Somo-HPLC/KIN Produced Data section"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>

<ul>
<li>
<b><i>Select all</i></b> will select all files in this panel.<p>
<li>
<b><i>Sel. Unsel.</i></b> will allow toggling the selection between selected files and everything else not currently selected.<p>
<li>
<b><i>Remove</i></b> will discard the selected files.<p>
<li>
<b><i>Show</i></b> will add the selected file(s) among those produced to the ones already displayed in the graphics window.<p>
<li>
<b><i>Show only</i></b> will show only the selected file(s) among those produced in the graphics window.<p>
</ul>
Two types of files can be produced:<p>
<ul>
<li>
csv-style (<b><i>Save CSV</i></b>)<p>
<li>
or regular 3-columns .dat files (<b><i>Save</i></b>).<p>
</ul>
<br>

In the <b><i>Messages</i></b> area, the operations performed are tracked, and computed parameters are shown. The display can be copied or cleared from the <i>File</i> pull-down menu: <p>
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_Messages.png" ALT="Somo-HPLC/KIN Messages section"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>

The bottom line of this module contains the <i><b>Help</i></b>, <i><b>Options</i></b>, and <i><b>Close</i></b> buttons, with in between a progess bar showing in blue color and with a numeric % value the advancement of the currect action:
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_bottom line.png" ALT="Somo-HPLC/KIN bottom line of commands"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>


On pressing <i><b>Options</i></b>, a pop-up panel will be shown:<p>

<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-SAXS_options_new.png" ALT="Somo-HPLC/KIN bottom line of commands"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>

See <a href=saxs_hplc_options.html>here</a> for a description of this module.<p>

On the top of the graphics window there is a row of round "<b><i>Plot buttons:</i></b>" checkboxes each one controlling the showing of a series of buttons:
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_plot_buttons.png" ALT="Somo-HPLC/KIN graphics plot buttons"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>

The <i>Options</i> checkbox will enable these buttons:<p>

<ul>
<li>
<b><i>Rescale X-Y</i></b>: adjusts the X-Y axes on the graphics window to maximize the display of shown datasets (no effect on the data themselves).<p>
<li>
<b><i>Rescale Y</i></b>: adjusts only the Y axis on the graphics window to maximize the display of shown datasets only along this direction (no effect on the data themselves).<p>
<li>
The <b><i>Log X</i></b> (<b><i>Lin X</i></b>) and <b><i>Log Y</i></b> (<b><i>Lin Y</i></b>) buttons allow to toggle between linear and log<sub>10</sub> scaling of the data on the <i>x</i>- and <i>y</i>-axes, respectively (if zero or negative values are present, they will be temporarily removed when the scale is set to log<sub>10</sub> mode, as they cannot be shown on the display in this mode). The buttons will change their respective label once pressed, to underscore what is the action currently available.<p>
<li>
Selecting the <b><i>Err</i></b> checkbox, active when up to 10 files are selected, will switch their representation from the dots connected with a line mode, to symbols (diamonds) with their associated SDs represented as error bars mode.<p>
<li>
Selecting the <b><i>Dots</i></b> checkbox will switch the data representation from the dots connected with a line mode to dots only mode.<p>
<li>
Each time the <b><i>Width</i></b> button is pressed, it increments the data line (or symbol) size of the plots, until it goes back to the initial value.<p>
<li>
<b><i>Color</i></b> shifts the colors used in the graphics window; the operation can be repeated until a better contrast with the background is achieved. Note that the background color can be changed by right-clicking on the plot borders, which will open up a pop-up dialogue panel where all plot characteristics can be modified.<p>
<li>
<b><i>Legend</i></b> will turn on below the graphics window a display of the correspondence between colours and filenames (automatically disabled if the selected files are 20 or more and/or if the <b><i>Err</i></b> checkbox is selected).<p>
</ul>

In the image below two files were selected, the <b><i>Dots</i></b> checkbox was checked, <b><i>Width</i></b> was pressed twice, and <b><i>Legend</i></b> was pressed:
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_Plot_Options_demo.png" ALT="Somo-HPLC/KIN graphics plot buttons demo"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
<br>
The <i>Selections</i> checkbox will enable these buttons:<p>
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_selections_buttons.png" ALT="Somo-HPLC/KIN graphics selections buttons"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
<ul>
<li>
<b><i>Select Visible</i></b> will select the files shown in the graphics window, which can be zoomed using the mouse (left click and drag). For instance, this is a practical way of selecting only a few files, by zooming on a region where only them are present.<p>
<li>
<b><i>Remove Vis(ible)</i></b> will instead remove the files shown in the graphics window.<p>
<li>
<b><i>Movie</i></b>: Pressing this button will open a pop-up window with the commands allowing to view in the main graphics window of the <b>US-SOMO <i>HPLC/KIN</i></b> module a series of selected data files in a movie-like manner, and to optionally save each frame as an image for real movie-making operations (see <a href=somo_saxs_hplc_movie.html>here</a>).<p>
<li>
<b><i>Save plots</i></b> allows saving the data shown in any of the plots currently visualized in csv-formatted files. Pressing it will open a pop-up dialogue window where the location and the root filename for the cvs files can be set.<p>
</ul>
<br>

The <i>Cropping</i> checkbox will enable these buttons:<p>
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_cropping_buttons.png" ALT="Somo-HPLC/KIN graphics cropping buttons"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
When a part of the graph is selected using the mouse/left button, the buttons become all available (only <b><i>Crop Zeros</i></b> and <b><i>Crop Common</i></b> are available when files are just displayed after selection).<p>
<ul>
<li>
<b><i>Crop Common</i></b> will crop all selected files so that they have identical x-axis values by dropping points outside of the union of all selected file's x-axis values.<p>
<li>
<b><i>Crop Vis(ible)</i></b> will remove what is shown in the graphics window. For instance, this is practical way to trim the data on the <i>x</i>-axis.<p>
<li>
<b><i>Crop to Vis(ible)</i></b> will keep only what is shown in the graphics window. Again, this is practical way to trim the data on the <i>x</i>-axis.<p>
<li>
<b><i>Crop Zeros</i></b> will remove data having zero or negative values in the intensity columns (<span style="color:#CC0000">discouraged: a warning panel will pop-up, asking the user whether she/he really wants to proceed, since experimental zero or negative values have statistical significance</span>).<p>
<li>
<b><i>Crop Left</i></b> and <b><i>Crop Right</i></b> will remove one point on the left or right of the selected data, respectively.<p>
<li>
<b><i>Undo</i></b> will undo the last operation.<p>

</ul>

The <i>Conc. Util.</i> (Concentration Utility) checkbox will enable these buttons:<p>
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_conc_util_buttons.png" ALT="Somo-HPLC/KIN graphics concentration utility buttons"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
They are used to deal with chromatography data coming from a concentration detector, such as absorbance (UV-Vis) or refractive index (RI). These data are usually on a diffent intensity scale, and time-shifted because of the placement of these detectors either before or after the SAXS cell. To deal with these problems, we need first to scale the concentration-associated chromatogram to a SAXS <i>I</i>(<i>t</i>) vs. <i>t</i>  chromatogram at a <i>q</i> value, and then to time-shift it to align it in the time domain.<br>
To demonstrate these procedures we employ a bovine serum albumin (BSA) SEC-SAXS run using two 7.8 &times; 300 mm ID columns packed with hydroxylated polymethacrylate particles (TSK G4000PWXL, 10 &micro;m size, 500 &Aring; pore size, and G3000PWXL, 6 &micro;m size, 200 &Aring; pore size, Tosoh Bioscience, Tokyo, Japan) connected in series, protected by a 6 &times; 40 mm guard column filled with G3000PW resin (Tosoh). The data presented capillary fouling evidence, and were thus subjected to Integral Baseline correction (not shown). The concentration-associated data were an absorption profile at 280 nm collected with a DAD (Diode Array Detector).<br>
The concentration data are first loaded with the <b><i>Conc. File Load</i></b> button (see <a href="#conc_load">here</a>) and then selected:
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_conc_util_load_data.png" ALT="Somo-HPLC/KIN graphics concentration utility loaded concentration-associated file" width="1000"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
Then, usually a low-<i>q</i>, high-intensity but low-noise <i>I</i>(<i>t</i>) vs. <i>t</i> chromatogram is also selected:
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_conc_util_add_SAXS_data.png" ALT="Somo-HPLC/KIN graphics concentration utility loaded concentration-associated and SAXS file" width="1000"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
<ul>
<li>
The <b><i>Repeak</i></b> button becomes available, and it is used to effectively scale the concentration-associated data on the <i>y</i>-axis to the target SAXS data, using the maximum intensity found in the target SAXS data. On pressing it, a pop-up panel will appear:<p>
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_conc_util_pop_up1.png" ALT="Somo-HPLC/KIN graphics concentration utility pop-up SD question"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
Usually the SD are ignored by pressing the first option presented, but the module offers two other alternatives, <i>Match target SD % pointwise</i> and <i>Set S.D.'s to 5%</i> (these two choices could be useful in the Gaussian decomposition procedure if less stringent constraints are sought for the concentration associated data). Whatever the choice, the repeak operation affects the data, a new file is generated with "rp" extension and the scaling factor, which will be used to re-generate the proper intensity scale when needed, added at the end of the filename:
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_conc_util_repeak.png" ALT="Somo-HPLC/KIN graphics concentration utility repeaked" width="1000"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
At the same time, another pop-up panel will ask if you want to "*Set*" (see below) the repeaked concentration file:
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_conc_util_pop_up2.png" ALT="Somo-HPLC/KIN graphics concentration utility pop-up repeaked set question"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
In this case the answer will be <i>No</i>, since the two chromatograms are still time-shifted one in respect to the other.

<li>
<b><i>Timeshift</i></b> can then be used to align the two chromatograms. On pressing it, the program will automatically traslate the concentration chromatogram so that the top of the maximum intensity peaks will coincide:
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_conc_util_timeshift.png" ALT="Somo-HPLC/KIN graphics concentration utility timeshifted"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
If this traslation doesn't occur automatically, it can be initialized by acting on the "&lt;" and "&gt;" buttons at the extremities of the cyan-shades bar-wheel below the graphics window. The resulting traslation of the concentration-associated dataset can be either refused by pressing <b><i>Cancel</i></b>, or accepted by pressing <b><i>Keep</i></b> using the buttons placed below the graphics window. On pressing <b><i>Keep</i></b>, another pop-up panel will show up: <p>
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_conc_util_pop_up3.png" ALT="Somo-HPLC/KIN graphics concentration utility pop-up timeshifted set question"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
Pressing <i>No</i> will defer this important decision, pressing <i>Yes</i> will already define this repeaked, time-shifted concentration-associated chromatogram as the source of frame-by-frame concentration values for the SAXS data: 
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_conc_util_timeshift_set.png" ALT="Somo-HPLC/KIN graphics concentration utility repeaked, time-shifted, set" width="1000"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>

<li>
<b><i>Set</i></b> will set an already uploaded and currently selected file containing the UV or refractive index profile vs. time or frame number as the source of the concentration-dependent signal.<p>

<li>
<b><i>Time scale</i></b> will let you change the time scale of a concentration-associated chromatogram, to bring it un the same units as the SAXS chromatograms. On pressing it, another pop-up panel will appear:
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_conc_util_pop_up4.png" ALT="Somo-HPLC/KIN graphics concentration utility pop-up time scaling multiplier value"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
were a multiplying factor can be entered. For instance, if the time units of the concentration data were minutes, and of the SAXS data were seconds, entering "60" and pressing <i>Ok</i> will bring the concentration data on the same time units as the SAXS data. This operation, if needed, should be done <b>before</b> any other in this panel. Pressing <i>Cancel</i> will abort this operation.<p>

</ul>

<br>

The <i>S.D. Util</i> checkbox relates to another feature present in the <b><i>US-SOMO HPLC/KIN</i></b> module, an alternative way of estimating the errors associated with the SAXS data. This might become useful if no errors have been already associated with the experimental data, or if their reliability is questionable.<br>
The method is based on the assumption that the fluctuations of the signal at the baseline level are a good representation of the error associated with the data an any other point along each <i>I(t)</i> vs. <i>t</i> chromatogram. Therefore, by estimating the average fluctuations in flat regions of the chromatogram, a <b>constant</b> SD value can be associated with <b>every</b> datapoint in that particular chromatogram. Obviously, different chromatograms will have different values for their respective constant SD.<br>
Two buttons will become availble on selecting the <i>S.D. Util</i> checkbox: 
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_SD_eval_buttons.png" ALT="Somo-HPLC/KIN graphics S.D. Evaluation buttons"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
For this example, we use an <i>Integral Baseline</i> corrected <i>I(t)</i> vs <i>t</i> chromatogram produced from the lysozyme SEC-SAXS data employed at the beginning of this <b>Help</b> section (see <a href=somo_saxs_hplc_baseline_corr.html>here</a> for a full description of this utility).<p>  
The actual SD associated with it can be visualized by selecting the <b><i>Err</i></b> checkbox in the <i>Options</i> menu as described above:<p>

<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_errors1.png" ALT="Somo-HPLC/KIN errors visualization" width="1000"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
<ul>
<li>
By pressing the <b><i>SD eval.</b></i> button, the commands panel below the graphics window will switch to a different mode, and two vertical red lines will be superimposed on the initial region of the chromatogram, with two red-background fields controlling their position in the bottom row:<p>

<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_errors2.png" ALT="Somo-HPLC/KIN SD evaluation initial image" width="1000"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
<li>
An additional checkbox, <i><b>2 regions</i></b>, if selected will duplicate the vertical lines and their associate fields (colored magenta this time), allowing to utilize more than one flat region for the SD estimation:<p> 

<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_errors3.png" ALT="Somo-HPLC/KIN SD evaluation 2 zones" width="1000"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>

The SD evaluation is carried out by fitting the data included between each zone with a 3<sup>rd</sup> degree polynomial, and taking the RMSD of the fit as the SD. If two regions are chosen, the final SD will be an average between the values computed from each region. These values are reported on the <i><b>Messages</i></b> section.<p>
<li>
After adjusting the zone(s) for the SD evaluation (values continuously updated in the <i><b>Messages</i></b> section), pressing <b><i>Keep</i></b> will accept the values, and the <b><i>SD apply</i></b> button becomes available. Pressing it will apply the SD calculation to any selected chromatogram, creating new files with the same name but with the extension "<i>sde</i>" ("SD evaluated"). In the example below, the same chromatogram is plotted twice, with the old (salmon) and new (light cyan) SDs:<p>
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_errors4.png" ALT="Somo-HPLC/KIN SD evaluation 2 zones actual" width="1000"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>

A zoom-in of the main peak region highlights how the two SDs are very close to each other:
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_errors5.png" ALT="Somo-HPLC/KIN SD evaluation 2 zones actual blow up two graphs"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>

demonstrating that the assumptions taken for this alternative SD evaluation produce SDs which are very similar to the ones that have been associated to the original SAXS data using a Poisson distribution. The main difference is that the original SDs vary slightly with the intensity for each <i>I(t)</i> vs. <i>t</i> chromatogram, while the baseline fluctuations method produces constant SD values for each <i>I(t)</i> vs. <i>t</i> chromatogram.<p>
<li>
The last checkbox above the graphics window, <i>None</i>, will just hide the buttons row below the round checkboxes row.<p>
</ul>
<br>
<hr><p>
Below the <b><i>US-SOMO HPLC/KIN</i></b> module graphics panel there are a series of buttons for performing several operations on the files displayed, some of which will become available only when multiple files are selected, or a region of the graph is zoomed, while others will become available only when single files are selected:<p>

<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_commands1.png" ALT="SOMO HPLC/KIN below graphics commands"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>

Note: some buttons are not always visualized, but will appear in place of others when some functions are called, such as in the SD evaluation procedure described above.<p>


<ul>
<li>
The use of the <b><i>Concentration reference</i></b> button will be described later on (see <a href="#ConcRef">here</a>).<p>
<li>
The <b><i>Residuals</i></b> main use is to visualize the residuals of a fit, as will be described in detail later on (see <a href="#ResFit">here</a>). However, it could be used also in directly comparing two curves. In this example two <i>I(q)</i> vs. <i>q</i> frames at the top of the peak for the lysozyme SEC-SAXS data were selected. Pressing <b><i>Residuals</i></b> a second graph below the main one is generated, with the differences between the two curves plotted on an absolute scale:<p>
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_Residuals_twocurves.png" ALT="SOMO HPLC/KIN residuals between two curves"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>

Selecting the <i>Reverse</i> checkbox will inverted the order of comparison and thus the sign of the differences. Selecting the <i>Use standard deviations</i> checkbox will weight the residuals by the associated SD of each point:
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_Residuals_twocurvesSD.png" ALT="SOMO HPLC/KIN residuals between two curves weighted by SD"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
Selecting instead the <i>By percent</i> checkbox the residuals will be plotted as % values:
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_Residuals_twocurves_percent.png" ALT="SOMO HPLC/KIN residuals between two curves as % values"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
The residuals plot can be toggled off by pressing again <b><i>Residuals</i></b>.<p>

<li>
<b><i>PVP</i></b> (Previously named <b><i>CorMap Analysis</i></b>) will launch a pairwise similarity comparison between all currently selected datasets, according to our implementation of <i>P</i>-value pair computations and comparisons derived from the Correlation Map method developed by Franke </span><span lang="en-US"><i>et al.</i></span><span lang="en-US"> (Franke D, Jeffries CM, Svergun DI. Correlation Map, a goodness-of-fit test for one-dimensional X-ray scattering spectra. Nature Methods, 12, 419-422, 2015). A in depth <i><b>PVP</i></b> module description with examples can be found <a href=cormap.html>here</a>.<p>
<li>
<b><i>Cancel</i></b> and <b><i>Keep</i></b> buttons become available when some functions have been performed, and allow to either exit (<b><i>Cancel</i></b>) from the procedure, or to keep the results obtained.<p>
<li>
<b><i>Blanks analysis</i></b>, <b><i>Baseline</i></b>, and  <b><i>Baseline apply</i></b> buttons by default are used within the <i>Integral Baseline</i> correction procedure. See <a href=somo_saxs_hplc_baseline_corr.html>here</a> for a full description of this utility. However, for special needs or very minor baseline correction requirements, the original linear baseline implementation (Brookes et al., J. App. Cryst. 46:1823-1833, 2013) is available by selecting the <b><i>Linear baseline removal</i></b> checkbox in the <a href=saxs_hplc_options.html><i><b>Options</i></b> panel </a>. If this option is selected, the <b><i>Baseline</i></b> button becomes available once a single <i>I(t)</i> vs. <i>t</i> chromatogram is selected (multiple <i>I(t)</i> vs. <i>t</i> chromatograms must be selected for this button to become active if the default <i>Integral Baseline</i> correction procedure is active). A description of the linear baseline removal tool can be found <a href=somo_saxs_hplc_linear_baselines.html>here</a>).<p> 

</ul>
<br>

<hr>
<p>
Gaussian decomposition of not baseline-resolved peaks is another utility present in the <b>US-SOMO <i>HPLC/KIN</i></b> module. Decomposition with symmetrical Gaussian functions will be first described using a bovine serum albumin (BSA) SEC-SAXS run using two 7.8 &times; 300 mm ID columns packed with hydroxylated polymethacrylate particles (TSK G4000PWXL, 10 &micro;m size, 500 &Aring; pore size, and G3000PWXL, 6 &micro;m size, 200 &Aring; pore size, Tosoh Bioscience, Tokyo, Japan) connected in series, protected by a 6 &times; 40 mm guard column filled with G3000PW resin (Tosoh). The data presented capillary fouling evidence, and were thus subjected to Integral Baseline correction (not shown).<p>

<p>
<center>
<img SRC="somo-HPLC-SAXS_BSA_I_t.png" ALT="SOMO HPLC-SAXS BSA I(t) for symmetrical Gaussian decomposition" width="1000">
</center>
<p>

Before proceeding to Gaussian analysis (whose theory can be seen <a href=saxs_hplc_Gaussian_theory.html>here</a>), a SVD analysis could be useful. In SVD analysis, the number of significant singular values in the decomposition should be equal to the number of components in the data, and thus to the minimum number of Gaussians required to accurately reconstruct the data (see <a href=somo_saxs_hplc_svd.html>here</a>).<p>
<br>
Three buttons control the <i>Gaussian decomposition</i> procedure in the <b><i>HPLC/KIN</i></b> module of <b><i>US-SOMO</i></b>: <b><i>Gaussian options</i></b>, <b><i>Gaussians</i></b>, and <b><i>Global Gaussians</i></b>.<p>

<ul>
<li>
<b><i>Gaussian options</i></b>. On pressing this button, a pop-up panel will appear asking to revise the type of Gaussians that are currently set in the <a href=saxs_hplc_options.html><i><b>HPLC/KIN Options</i></b> module </a>:
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_Gaussian_options.png" ALT="SOMO HPLC/KIN Gaussians Options selection"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
It also offers the possibility of re-initializing the Gaussian analysis by pressing the <b><i>Clear cached Gaussian values</i></b> button. For this demonstration, we will leave the <b><i>default</i></b> <i>Standard Gaussian</i> checkbox selected. <i><b>Quit</i></b> will exit from this pop-up without retaining any changes, <i><b>Ok</i></b> will exit maintaining any changes made.<p>

<li>
<b><i>Gaussians</i></b> will become active if just one <i>I(t)</i> vs. <i>t</i> chromatogram is selected.<p>

By default, the <b><i>US-SOMO HPLC/KIN</i></b> module will consider symmetrical Gaussians, but distorted Gaussian functions are also availble and can be selected from the <b><i>Gaussian Options</b></i> menu (see above). The choice must be done before starting the following procedure. An example of a data processing with non-symmetrical Gaussians is presented <a href=somo_saxs_hplc_skewedGauss.html><b>here</b></a>.<p>

On pressing <b><i>Gaussians</i></b>, two new rows of buttons/fields and a checkbox will appear at the bottom of the graphics window, together with two vertical red dashed lines indicating the <i>Fit start</i> and <i>Fit end</i> points of the Gaussian fitting region, whose directly editable values (<b>default: at the beinning and end of the available data</b>) appear in the two red-background fields in the bottom row:

<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_Gaussian_start.png" ALT="SOMO HPLC/KIN Gaussians start"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>

<li>
<b><i>Clear</i></b> will remove currently-generated Gausssian, and allow to start a new analysis. If Gaussians had been loaded from file, the <i><b>Clear cached Gaussian values</i></b> button accessible from the <b><i>Gaussian options</i></b> button (see above) should be used.<p>
<li>
Each time the <b><i>New</i></b> button is pressed, a new Gaussian will be added (green colour), with pre-set center, width and amplitude shown in the three rightmost fields (additional fields will be present if distorted Gaussians functions are used; see <a href=somo_saxs_hplc_skewedGauss.html>here</a>). By clicking on each field, and then using the cyan-shades bar-wheel, each Gaussian can be adjusted to initialize the process (usually, only the centers need to be positioned under the peaks). If the <i>Match</i> checkbox is selected, the height of each Gaussian will be automatically adjusted so to match the height of the experimental <i>I</i>(<i>t</i>) vs. <i>t</i> curve at the Gaussian current position.<p>
<li>
<b><i>Del</i></b> will remove only the current Gaussian.<p>

If a previously-generated set of Gaussians was present or loaded from file, the Gaussians will show up under the peak(s) together with vertical lines indicating their centers, such as in the example shown below, where also the <i>Fit end</i> vertical line has been moved to a new position from the default settings:<p>
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_Gauss1new.png" ALT="SOMO HPLC-KIN Gaussian initialization" width="700"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
<li>
Clicking on the "<b>&lt;</b>" and "<b>&gt;</b>" buttons will toggle among the Gaussian present, whose identifying number is shown in the field between them. The active Gaussian is identified by a magenta vertical line positioned at its center, while blue lines are used for the others.<p>
<li>
The <i>SD</i> checkbox controls whether the data associated std. dev. values will be used in the fitting procedure (<b><i>default: not selected</i></b>). It is recommended to select this checkbox only after a first round of fitting with the various algorithms provided has been performed, as the SD can only be used with the LM algorithm at the time of updating this Help section (July 2024).<p>
<li>
Once the initialization is completed, pressing the <b><i>Fit</i></b> button will bring up a window controlling the fit procedure, shown below:<p>

<p><center>
<img SRC="somo-HPLC-SAXS_GaussFit.png" ALT="SOMO HPLC-SAXS Gaussian Fit panel">
</center>
<p>

See <a href=somo_saxs_hplc_fit.html>here</a> for a description of the <b><i>Fit</b></i> module.<p>

In the first cycle of iterations, it is best to keep the original centers fixed:<p>
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-SAXS_Gauss1anew.png" ALT="SOMO HPLC-SAXS Gaussian first round center fixed" width="1000"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>

In the example shown, a not well-defined aggregates peak is present at the beginning, and an extended initial baseline is not present. If the first Gaussian is left free to adjust, it will expand too much to compensate for the missing initial baseline. Therefore, in such situations it is best to keep fixed the position of the first Gaussian:<p>
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-SAXS_Gauss1bnew.png" ALT="SOMO HPLC-SAXS Gaussian first round center fixed peak 1" width="1000"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>

A final round of fitting can then be performed using the SD and allowing a 5% variation on the Gaussian centers at each iteration, until a satisfactory fit of the main peak(s) is obtained:<p>
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-SAXS_Gauss2new.png" ALT="SOMO HPLC-SAXS Gaussian first round center fixed peak 1" width="1000"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>

If some datasets have missing or NaN values for one or more SD values, a pop-up menu will appear listing all the files presenting this problem, and with how many occurrences. The user can then select between three options: drop the datasets containing these non-defined SDs; drop just the frame (or time) point missing the SD(s); or not use SD weighting.<p>

The global improvement of the fit can be also judged by the rmsd (<i>SD</i> checkbox not selected) or &chi;<sup>2</sup> (<i>SD</i> checkbox selected) value which is updated next to the <b><i>Fit</b></i> button. 
<a id="ResFit"></a>
The residuals of the fit can be visualized by pressing the <b><i>Residuals</i></b> button, which will split the graphics window in two, and show a plot of the fit residuals below the main plot. The residuals plot can be removed by pressing <b><i>Residuals</i></b> again (see more below). In the example shown above, the residuals are weighted by the std. dev. associated with the experimental points (<i>SD</i> checkbox selected; a <i>By percent</i> residuals option is also available). <p>

Once a satisfactory fit is reached, pressing <b><i>Keep</i></b> will accept the current Gaussians for further work. But to save the parameters of the current Gaussians in a file, the <b><i>Save</i></b> button has to be pressed before <b><i>Keep</i></b>.<p>
<li>
<b><i>Cancel</i></b> will cancel the operations and remove all the Gaussians.<p>

Once an initial set of fitted Gaussians has been produced, it should be globally fitted to all chromatograms. However, performing this operation directly on all chromatograms can be very computationally intensive. For this reason, it is best to perform it on a subset of all chromatograms, and the global fit results are then propagated to all remaining chromatograms. <span style="color:#CC0000"><b>Importantly</b></span>, in the global fitting procedure the centers and widths of each particular Gaussian are optimized so to be the same across all chromatograms, and only the amplitudes are then fitted.<p>
<li>
To select a subset of data, the <b><i>Adv. Sel.</i></b> button is pressed, which will open the pop-up selection panel (see image below and <a href=saxs_hplc_nth.html>here</a>).

<p><center>
<img SRC="somo-HPLC-SAXS_GaussSelect.png" ALT="SOMO HPLC-SAXS Global Gaussian Nth selection">
</center>
<p>

It is advisable to perform the global fitting avoiding the very first few low-<i>q</i>, very noisy, and the last high-<i>q</i>, very low signal <i>I</i>(<i>t</i>) vs. <i>t</i> chromatograms. In the example we are illustrating, we start from chromatogram # 8 (<i>q</i> = 0.007813 &Aring;<sup>-1</sup>) and select every 4 chromatograms up to # 454 (<i>q</i> = 0.12020 &Aring;<sup>-1</sup>). The <i>I</i>(<i>t</i>) vs. <i>t</i> chromatogram on which the initial set of Gaussians was optimized is also included (<i><b>Select Additionally</i></b> button). Pressing <b><i>Transfer selection to main window</i></b> will close the pop-up window and the selected files will be shown in the main <b><i>HPLC/KIN</i></b> module graphics window (whose frame for this screenshot has been enlarged so that the information regarding the four Gaussian present in the <b><i>Messages</i></b> panel is fully visible):<p>
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-SAXS_Gauss3anew.png" ALT="SOMO HPLC-SAXS Global Gaussian on Nth" width="1000"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
<li>
The <b><i>Global Gaussians</i></b> button is now available. This utility has two main usages. During the search for the best Gaussians parameters, it will find the amplitudes best fitting all the selected chromatograms based on the centres and widths found on the initial chromatogram. This operation has to be performed before the global fit. SD should be used in the Gaussian fittings from this point on, selecting the <i>SD</i> checkbox. If this selection was not done, on pressing the <b><i>Global Gaussians</i></b> button a pop-up panel will appear:

<p><center>
<img SRC="somo-HPLC-SAXS_GlobalGaussianSDreminder.png" ALT="SOMO HPLC-SAXS Global Gaussians mode: turn on SD question">
</center>
<p>

<i>Turn on</i> is then selected. <b><i>Global Gaussians</i></b>  will allso restore the saved parameters saved in a file after a satisfactory fitting is attained. For this reason, another pop-up panel will appear:

<p><center>
<img SRC="somo-HPLC-SAXS_GlobalGaussianOptions.png" ALT="SOMO HPLC-SAXS Global Gaussians mode: fit amplitudes or restore saved ones">
</center>
<p>
In this case, the answer is <i>Yes</i>, and the amplitudes will be set for all the selected chromatograms.<p>

If datasets having points with missing or NaN std. dev. values are found, a third pop-up panel will appear:<p>

<p><center>
<img SRC="somo-HPLC-SAXS_Drop0SD.png" ALT="SOMO HPLC-SAXS Drop 0 SD pop-up">
</center>
<p>

When just a few problematic points are found for each chromatogram, the <i>Drop points with 0 SDs</i> option can be safely used. The global Gaussians operation will then be completed:<p>
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-SAXS_Gauss3new.png" ALT="SOMO HPLC-SAXS Global Gaussian on Nth final" width="1000"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>

In the image above, the <b><i>Global Gaussians</i></b> results on the <b><i>Nth</i></b> selected files are shown, together with the grouped fit residuals. The common centers and widhts, <span style="color:#CC0000">not optimized but just based on the initial chromatogram fit</span>, are displayed in the graph as vertical and horizontal bars, respectively. Note that the <i>x</i>-axis scale and the <i>Residuals</i> <i>y</i>-axis scales were manually optimized (right-click on the scale to access the plot options menu). The global <i>P-value</i> analysis for this initial Gaussian propagation is also shown in the <b><i>Messages</i></b> panel. Both the residuals and the <i>P-value</i> analysis indicate a poor fitting of the initial Gaussian when just propagated to the other selected chromatograms.<p>
<li>
<b><i>Save</i></b> will save the resulting Gaussians to the current selected directory, with extension -gauss.dat for symmetrical Gaussians of single files and -mgauss.dat for Gaussians of multiple files. For distorted Gaussians, the extensions will be -mgmg.dat, -memg.dat, and -memggmg.dat for the GMG, EMG and EMG+GMG Gaussians, respectively.<p>
<li>
Pressing <b><i>Keep</i></b> will accept the current Gaussians for further work.<p>
<li>
<b><i>Global fit</i></b>, which becomes available instead of the <b><i>Fit</i></b> button once a series of chromatogram is selected and after at least an initial set of Gaussians is generated/loaded, can now be used to optimize all the centres and widths of each Gaussian along all the chromatograms to common values for each family of Gaussians. The operation is controlled by the same pop-up <b>Fit</b> panel as for the single chromatogram case (see <a href=somo_saxs_hplc_fit.html>here</a>), but only the LM method is still currently (July 2024) available. In this example, it is best to first perform a global fit round keeping the Gaussians 1, 2 and 4 fixed, and then perform a second round leaving all parameters free:

<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-SAXS_Gauss4new.png" ALT="SOMO HPLC-SAXS Gaussian Global fit" width="1000"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>

In the image above, the results of the <b><i>Global fit</i></b> are shown together with the grouped fit residuals. Furthermore, a new set of tools is available to judge the goodness of the fit.<p>

<li>
A pairwise <b>PVP</b> analysis in automatically performed between each original <i>I</i>(<i>t</i>) vs. <i>t</i> chromatogram and its reconstruction based on the sum of the fitting Gaussians, for each <i>q</i>- value.<p>

<li>
A new kind of plot becomes available, visualized by pressing <b><i>Global fit by q</i></b>. The normalized &chi;<sup>2</sup> (diamonds connected by a line) and the pairwise <i>P</i>-values (squares) are plotted as a function of the <i>q</i>-value, as shown below:<p>

<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-SAXS_Gauss4bnew.png" ALT="SOMO HPLC-SAXS Gaussian Global fit with Global fit by q" width="1000"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>

In the <i>Global fit by q</i> graph it is possible to visualize either one of or both the two plots, by selecting/deselecting their respective checkboxes positioned just below it (<i>Plot Chi^2/RMSD</i> and <i>Plot P values</i>). The fit is clearly not optimal.
Note that in the image above, where both plots are shown, their respective <i>y</i>-axis scales have been manually modified to allow a better visualization of each plot. The dashed green and yellow horizontal lines mark the usual cut-off <i>P</i>-values (<i>P</i> &ge; 0.05, above the green line; 0.05 &gt; <i>P</i> &gt; 0.01 between the green and yellow lines; <i>P</i> &lt; 0.01, below the yellow line).<p> 

We can move the limits of the fit to exclude the first peak and the tail of the main peak, to concentrate the goodness-of-fit indicators toward the most important part of the fit, including the top (2/3)<sup>rds</sup> of peaks 2, 3 and 4. Each time the limits are moved, the normalized &chi;<sup>2</sup> and <i>P</i>-values are recomputed by pressing the <b><i>Recompute nChi^2</i></b> button):
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-SAXS_Gauss4cnew.png" ALT="SOMO HPLC-SAXS Gaussian Global fit with Global fit by q limits moved" width="1000"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>

With these limits, the normalized &chi;<sup>2</sup> values display "reasonable" values, &asymp;1.5-2.5 for the lowest <i>q</i> angles (up to <i>q</i> &asymp;0.035 &Aring;<sup>-1</sup>), then almost linearly decaying to &asymp;0.7 for <i>q</i> &asymp;0.8 &Aring;<sup>-1</sup>, being stable afterwards, for a global &chi;<sup>2</sup> &asymp;0.95. Likewise, the <i>P</i>-values show a slight trend toward better values as the <i>q</i> increases, but the distribution of really "bad" <i>P</i>-values appears to be substantially random.<p> 
<li>
The correlation between the goodness-of-fit indicators and the distribution of the residuals can be examined for each original/fit <i>I</i>(<i>t</i> vs. <i>t</i> pair by selecting the <i>Scroll</i> checkbox:<p>

<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-SAXS_Gauss5cnew.png" ALT="SOMO HPLC-SAXS Gaussian Global fit scroll 1" width="800"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>

In the image above, only the <i>P</i>-value are shown. The current chromatograms pair is highlighted in the <i>P</i>-values plot by an enlarged symbol (purple square in this case). Scrolling is performed by either using the cyan-scale bar-wheel, or by clicking on the the "<b><i>&lt;</i></b>" and "<b><i>&gt;</i></b>" buttons placed at its sides. By selecting/deselecting the three checkboxes next to the <i>Scroll</i> checkbox (<i>P >= 0.05</i>, <i>0.05 > P >= 0.01</i>, <i>P < 0.01</i>), only the subset(s) whose <i>P</i>-values are within those of the selected chechbox(es) will by scrolled.<p>

In the example shown above, by examining the residuals' plot it is clear that the "bad" <i>P</i>-value it is due to a poor fit in the inflection point betweern the 3<sup>rd</sup> and 4<sup>th</sup> peaks. If we examine a chromatograms pair just three <i>q</i> values above the first one examined in detail, we can see that oscillations in this zone produce an excellent <i>P</i>-value, although this still appears to be a difficult zone to fit with symmetric Gaussians:<p>
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-SAXS_Gauss4dnew.png" ALT="SOMO HPLC-SAXS Gaussian Global fit scroll 2" width="800"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>

The noticeable worse fitting and the end of the main peak could indicate either a slight non-pure Gaussian shape of the peak, or the presence of a small amount of some trailing material in this region.<p>
<li>
It is best to first <b><i>Save</i></b> and then <i><b>Keep</i></b> the results, and then select all the available <i>I(t)</i> vs. <i>t</i> chromatograms (use <b><i>Select all</i></b> if only <i>I(t)</i> vs. <i>t</i> data are present in the <b><i>Data files</i></b> section).<p>
<li>
<b><i>Global Gaussians</i></b> could now be applied to all the selected chromatograms. However, having moved the fit limits to exclude the first peak will lead to poor propagation of the Gaussians parameters in this case. Therefore, at least the left-side fit limit has to be restored by first re-selecting only the original chromatogram on which the Gaussians fit was first optimized and pressing <b><i>Gaussians</i></b>, then repositioning the left-side fit limit, followed by <i><b>Keep</i></b>.<p>
<li>
<b><i>Global Gaussians</i></b> could now be pressed, and again a pop-up panel will appear:

<p><center>
<img SRC="somo-HPLC-SAXS_GlobalGaussianOptions.png" ALT="SOMO HPLC-SAXS Global Gaussians mode: fit amplitudes or restore saved ones">
</center>
<p>
Also in this case, the answer is <i>Yes</i>, and the amplitudes will be set for all the selected chromatograms.<p> Again, if datasets having points with missing or NaN std. dev. values are found, a pop-up panel will appear (not shown).<p>
If we hadn't restored the left-side fit limit to include the first peak, another pop-up panel would have appeared:
<p><center>
<img SRC="somo-HPLC-SAXS_GlobalGaussianFitRange.png" ALT="SOMO HPLC-SAXS Global Gaussians mode: fit range warning">
</center>
<p>
Pressing <i>Ok</i> will allow the operation to complete anyway, and if the results are poor they can be refused by pressing <i><b>Cancel</i></b> and proceeding as explained above, leading to a better Gaussians propagation: 
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-SAXS_Gauss5new.png" ALT="SOMO HPLC-SAXS Global Gaussian Global on all" width="1000"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>

The image above shows the global Gaussians results after applying the global fit parameters found on a subset of data to all chromatograms. <b><i>Save</i></b> and <i><b>Keep</i></b> can then be sequentially pressed to store and accept the global Gaussian results.<br>
Note, however, how the <i>P</i>-values plot shows a large increase of "bad" <i>P</i>-values at increasing <i>q</i>-values. This is due to the global Gaussians propagation failing to reach true mininima by some peaks values getting "trapped" by spikes in the data. To alleviate this problem, starting from the  <span style="color:#CC0000">July 2024 intermediate release</span> we offer two alternative ways leading to a better global Gaussians propagation. In the <a href=saxs_hplc_options.html><i><b>HPLC/KIN Options</i></b></a> module there are two checkboxes labeled "<i>Experimental: Global Gaussian Initialization smoothing. Maximum smoothing points:</i>" followed by a field that becomes available if this checkbox is selected, and <i>Experimental: Global Gaussian cyclic fit</i>. <p>
The first feature deals with the problem of how to avoid local minimima when propagating a set of Gaussians optimized on a few chromatograms to all other chromatograms, by resorting to smoothing the data. Especially for high scattering angles, very noisy data, local spikes can lead the optimization of the individual fits to stop before reaching a true global minimum. Smoothing at the fit level alleviates this problem. (<span style="color:#CC0000">Note: importantly, the final decomposition when regenerating the <i>I(q)</i> vs. <i>q</i> data for each peak is done on the <i>original</i>, <b>not</b> on the <i>smoothed</i> <i>I(t)</i> vs. <i>t</i> chromatograms!</span>).<br>
After selecting this checkbox with 7 as the maximum smoothing points, we can return to the <b><i>HPLC/KIN</i></b> module and restart <b><i>Global Gaussians</i></b>. The pop-up asking for re-fitting the Gaussians amplitudes or keeping the actual values will again appear, and we choose <i>Yes</i>, leading to an iterative procedure where for each chromatogram a smoothing pass increasing from 1 to the maximum chosen points (7 in this case) is launched, followed with the amplitudes fitting. The procedure stops at each chromatogram level when a further increase in smoothing doesn't improve the fit, leading to these results:
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-SAXS_Gauss_smooth7.png" ALT="SOMO HPLC-SAXS Global Gaussian Global on all with smoothing 7 points max" width="1000"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>

The final smoothed data for each chromatogram appear in the <b><i>Data files</i></b> and <b><i>Produced Data</i></b> sections with the extension "<i>sm-x</i>", with "<i>x</i>" the maximum smoothing value reached. The improvement in the fitting can be seen in the <b><i>Messages</i></b> section, where the global "good" <i>P</i>-values have increased from &sim;50 % to &sim;63 %. The <i>Global fit by q</i> plot also shows an improved distribution of the i>P</i>-values. The effect of the smoothing on any chromatogram can be checked by selecting any pair as in this example, where the maximum smoothing points allowed was reached:
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-SAXS_Gauss_smooth7_pair.png" ALT="SOMO HPLC-SAXS Global Gaussian Global on all with smoothing 7 points max comparing two chromatograms" width="700"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
Obviously, while this procedure can resolve some of the local minima problems, it cannot cure poor fitting issues.<p>

The second procedure we developed can be run by choosing the <i>Experimental: Global Gaussian cyclic fit</i> in the <a href=saxs_hplc_options.html><i><b>HPLC/KIN Options</i></b></a> module. If this checkbox is selected, during the initial <i>Global Gaussian</i> fitting instead of directly fitting the all Gaussian curves simultaneously, each Gaussian first is fit sequentially, keeping the others fixed, followed by fitting all Gaussians simultaneously.<p>
After selecting this checkbox, to allow a direct comparison of this cyclic procedure versus the "standard" procedure, the <i>Experimental: Global Gaussian - Enable legacy Gaussian fit display</i> is also checked. We can now return to the <b><i>HPLC/KIN</i></b> module and restart <b><i>Global Gaussians</i></b>. The pop-up asking for re-fitting the Gaussians amplitudes or keeping the actual values will again appear, and we choose <i>Yes</i>, leading to the cyclic fit being launched (as reported in the <b><i>Messages</i></b> section) with these results:
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-SAXS_Gauss_cyclic_fit.png" ALT="SOMO HPLC-SAXS Global Gaussian Global on all with cyclic fit" width="1000"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
The improvement in the fitting can be seen in the <b><i>Messages</i></b> section, where the global "good" <i>P</i>-values have now increased from &sim;50 % to &sim;76 %. The <i>Global fit by q</i> plot also shows an improved distribution of the <i>P</i>-values. As for the <i>smoothing</i> procedure while the <i>cyclic fit</i>  procedure can significantly resolve some of the local minima problems, it cannot cure poor fitting issues. Selecting then the <i>Scroll</i> and the "<i>Raw</i>" checkboxes, we can directly see the effect of the cyclic procedure on any chromatogram, as in this example: 
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-SAXS_Gauss_cyclic_scroll.png" ALT="SOMO HPLC-SAXS Global Gaussian Global on all cyclic scroll" width="700"></td>
</tr> 
</table>
</center>
<td align=justify><p>

where the sum of the cyclic fit and that of the "raw" fit derived Gaussians are the green and white lines, respectively. The improvement is clear by examining peaks #2, #3, and the main peak (#4): peak #2 has practically some random noise at this high <i>q</i> value, which was still interpreted as a Gaussian in the "raw" fit while the cyclic fit correctly interpreted the signal. For peak #3, the fit is significatly improved, avoiding being caught on some spikes, and even for peak #4 the top appears to be better interpreted.<p>
After exiting from the <i>Scroll</i> mode, <i><b>Keep</i></b> can then be pressed to accept these Global Gaussian results for further analysis.<p>
<br>
<li>
<span id="trialmakeiq">After Gaussian decomposition, the <b><i>Trial make I(q)</b></i> procedure can be launched. First, all the available <i>I</i>(<i>t</i>) vs. <i>t</i> chromatograms for which Gaussians have been produced are selected, and the <b><i>Trial make I(q)</b></i> button is pressed. The third commands row under the graphics window will now show additional options:<p></span>

<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-SAXS_Gauss_test_I_q_new.png" ALT="SOMO HPLC-SAXS Test I(q) after Global Gaussians decomposition" width="1000"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>

The <i>Time range for I(q):</i> two red fields allow selecting a particular region of the chromatograms, by either clicking on each one and then typing in the times, or using the cyan-scale bar-wheel and/or the "<b><i>&lt;</i></b>" and "<b><i>&gt;</i></b>" buttons placed at its sides. The <i>I(q) from Gaussian:</i> round checkboxes labeled <i>none</i>, <i>1</i>, <i>2</i>, <i>3</i>, and <i>4</i> allow selecting which Gaussian will be used to produce the corresponding decomposed <i>I</i>(<i>q</i>) vs. <i>q</i> data, as a pointwise % of the original <i>I</i>(<i>t</i>) vs. <i>t</i> data based on the relative contribution of <span style="color:#CC0000">all</span> Gaussians at that particular point in <i>t</i> space. The square <i>as pure Gaussian</i> checkbox appears once a Gaussian is selected; if it is checked, the actual Gaussian value will instead be used (effectively smoothing the data).<p>
In the first example shown below, we start by first selecting the region of the main peak and checking the 4<sup>th</sup> Gaussian.<p>  
<li>
We can then press the <i><b>Guinier</i></b> button, that will launch the Guinier analysis of all the temnporarily generated <i>I</i>(<i>q</i>) vs. <i>q</i> curves in the selected time interval, and the approximate <i>MW[RT]</i> calculations (see description in the <a href=saxs_hplc_options.html><i><b>HPLC/KIN Options</i></b></a>). However, since the <i>q</i>-range available for this dataset doesn't reach the minimum 0.2 &Aring;<sup>-1</sup> <i>q</i><sub>max</sub> value found to be valid for the <i>MW[RT]</i> calculations, a pop-up message will appear on top of the new screen:

<p><center>
<img SRC="somo-HPLC-SAXS_MWRT_limit_warning.png" ALT="SOMO HPLC-SAXS Trial I(q) Guinier ME[RT] limit warning pop-up">
</center>
<p>

Pressing <i>Ok</i> will allow access to the new screen:
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-SAXS_Gauss_test_I_q_Guinier.png" ALT="SOMO HPLC-SAXS Test I(q) after Global Gaussians decomposition Guinier" width="1000"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
where the preset limit for <i>q<sub>max</sub>*R<sub>g</sub></i>=1.3 was used. The results of the Guinier analyses and of the <i>MW[RT]</i> calculations for each individual <i>I</i>(<i>q</i>) vs. <i>q</i> curve are reported in the <b><i>Messages</i></b> area, while the average values for the entire dataset are reported at the bottom of the command buttons, which now present several new buttons, checkboxes, and fields.<p>
<li>
By clicking on the <i>q^2 range</i> left red field and using the cyan-scale bar-wheel and/or the "<b><i>&lt;</i></b>" and "<b><i>&gt;</i></b>" buttons placed at its sides, we can first re-do the Guinier regressions by changing the <i>q<sub>min</sub></i> value to exclude the first very noisy points; likewise, the <i>q<sub>max</sub></i> value can be changed from the <i>q^2 range</i> right red field.<p>
<li>
The <i>q<sub>max</sub></i> value can also be changed by first unchecking the <i>q<sub>max</sub>*R<sub>g</sub></i> checkbox, then typing in a new value suxh as "1.1" and then re-checking it:
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-SAXS_Gauss_test_I_q_Guinier1.png" ALT="SOMO HPLC-SAXS Test I(q) after Global Gaussians decomposition Guinier with changed limits" width="1000"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
In the image above, the <i><b>Residuals</i></b> button was also pressed, with the <i>Standard deviation</i> checkbox selected, allowing to evaluate the cumulative quality of the Guinier analyses.
<li>
The <i>SD</i> checkbox governs the use of the standard deviations associated with each <i>I</i>(<i>q</i>) vs. <i>q</i> curve in the Guinier analysis (<i><b>default: checked</i></b>).<p>
<li>
The <i>plot extension</i> fields allow extending the visualized plot limits to the left and right sides by the amounts typed in the two fields, respectively.<p>
<li>
The <i>Scroll</i> checkbox if checked will allow to see each individual Guinier plot:
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-SAXS_Gauss_test_I_q_Guinier2.png" ALT="SOMO HPLC-SAXS Test I(q) after Global Gaussians decomposition Guinier with changed limits" width="700"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
scrolling is accomplished by using the cyan-scale bar-wheel and/or the "<b><i>&lt;</i></b>" and "<b><i>&gt;</i></b>" buttons placed at its sides. Pressing again <i><b>Residuals</i></b> will make that plot disappear.
<p>
<li>
Pressing <i><b>Rg plot</i></b> will allow to visualize the <i>R<sub>g</sub></i> values plotted under the chosen peak represented by its Gaussian (solid magenta line) superimposed to the reconstructed profile (dashed green line): <p>
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-SAXS_Gauss_test_q1new.png" ALT="SOMO HPLC-SAXS Test I(q) after Global Gaussians decomposition G4 main peak" width="700"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
The original contribution of the 3<sup>rd</sup> Gaussian under the main peak can be now evaluated by first clicking on  <b><i>Trial make I(q)</b></i> and then selecting the <i>I(q) from Gaussian:</i> "<i>none</i>" round checkbox, followed by pressing <i><b>Guinier</i></b> and <i><b>Rg plot</i></b>:<p>

<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-SAXS_Gauss_test_q2new.png" ALT="SOMO HPLC-SAXS Test I(q) after Global Gaussians decomposition G none under main peak" width="700"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>

here the <i>q<sub>min</sub></i> and <i>q<sub>max</sub></i> limits were also manually reset to the ones used in the previous analysis. As can be seen, there was a slight contribution of the 3<sup>rd</sup> peak, consistent with near baseline-separation between the 3<sup>rd</sup> and 4<sup>th</sup> peaks.<p>
<br>
If we perform this analysis selecting the top region of the dimer (3<sup>rd</sup>) peak (frames 71-91) and its Gaussian, we find very different <i>R<sub>g</sub></i> values, &#8776; 43 &Aring;, almost evenly distributed across the peak:<p>
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-SAXS_Gauss_test_q3new.png" ALT="SOMO HPLC-SAXS Test I(q) after Global Gaussians decomposition G3 main peak" width="700"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
here the <i>q<sub>max</sub></i> limits was manually reset. Note that some of the curves present an upward curvature at low <i>q</i>-values, likely indicating a non-ideal baseline correction for this sample.<p>
<br>
Finally, the contribution of the 2<sup>nd</sup> peak under the 3<sup>rd</sup> peak in absence of Gaussian decomposition can be seen again by selecting the <i>I(q) from Gaussian:</i> "<i>none</i>" round checkbox, followed by pressing <i><b>Guinier</i></b> and <i><b>Rg plot</i></b>:<p>
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-SAXS_Gauss_test_q4new.png" ALT="SOMO HPLC-SAXS Test I(q) after Global Gaussians decomposition contribution of peak 2 under peak 3 no Gaussians" width="700"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>

finding higher <i>R<sub>g</sub></i> values on the ascending part of the peak, consistent with no baseline separation of these two peaks which was effectively cured by the Gaussian decomposition.<p>
<li>
The <b><i>Approx. MW plot</b></i> can show the approximate molecular weight values calculated with the Rambo and Tainer method (Accurate assessment of mass, models and resolution by small-angle scattering. Nature 496:477-481, 2013) . However, as it requires to produce meaningful results a more extended <i>q</i> range than that available for the HPLC-SAXS BSA study presented here, we will not present such plots here.<p> 
<li>
The <i>Lock range</i> checkbox can be used in association with the <b><i>Replot</b></i> button to better visualize the <i>R<sub>g</sub></i> and <i>Approx. MW</i> plots.<p>
<li>
Pressing <b><i>Trial make I(q)</b></i> will return to its main screen.<p> 
<li>
The analysis range can be reset by pressing <b><i>Vis. range</b></i>.<p>
<li>
Pressing <b><i>Create I(q) set</b></i> will generate a set of <i>I</i>(<i>q</i>) vs. <i>q</i> curves using the selected Gaussian peak and time range:
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-SAXS_Gauss_test_I_q_generate_I_q.png" ALT="SOMO HPLC-SAXS Test I(q) after Global Gaussians decomposition generating a set of I(q)" width="1000"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
as indicated in the <b><i>Data files</i></b> and <b><i>Produced Data</i></b> sections, with additional parameters printed in the <b><i>Messages</i></b> section. The produced <i>I</i>(<i>q</i>) vs. <i>q</i> curves can be visualized in the graphics window by first exiting from the <i>Trial make I(q)</i> procedure by clicking on <b><i>Cancel</b></i>, and then pressing <b><i>Sel. Unsel.</b></i> in the <b><i>Data files</i></b> section:
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-SAXS_Gauss_test_I_q_visualize_generated_I_q.png" ALT="SOMO HPLC-SAXS Test I(q) after Global Gaussians decomposition visualizing a generated set of I(q)" width="700"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
here the <b><i>Log X</b></i> and <b><i>Log Y</b></i> buttons have been pressed to change the <i>x</i>- and <i></i>-axis visualization mode.<p>
<li>
Pressing the <b><i>Scale Analysis</b></i> button will allow to scale the produced <i>I</i>(<i>q</i>) vs. <i>q</i> curves to asses their similarity:
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-SAXS_Gauss_test_I_q_generate_I_q_scaling.png" ALT="SOMO HPLC-SAXS Test I(q) after Global Gaussians decomposition scaling a generated set of I(q)" width="700"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
here the <i>q</i> limits for the scaling region have been set by clicking on the <i>q range for scaling:</i> red fields and using the cyan-shades bar-wheel to postion the two vertical red lines (pressing the <b><i>Reset q range</b></i> button will restore the full <i>q</i>-range).<p>
<li>
The <i>Scale to</i> <i>Minimum</i> and <i>Maximum</i> checkboxes will select the minimum or maximum intensity <i>I</i>(<i>q</i>) vs. <i>q</i> curve on which to perform the scaling (<b>default: minimum</b>; here <i>Maximum</i> was chosen).<p>
<li>
The <i>Save interpolated to target</i> square checkbox if selected will allow curves potentially on a different <i>q</i> grid to be interpolated to the target <i>q</i> grid on saving (<b>default: unchecked</b>).<p>
<li>
Pressing <b><i>Apply</b></i> will launch the scaling operation:
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-SAXS_Gauss_test_I_q_generate_I_q_scaled.png" ALT="SOMO HPLC-SAXS Test I(q) after Global Gaussians decomposition scaled a generated set of I(q)" width="1000"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
with the scaling parameters reported in the <b><i>Messages</b></i> section. Here the <b><i>Residuals</b></i> button was also pressed.<p>
<li>
<i>Scroll</i> will allow to compare each scaled <i>I</i>(<i>q</i>) vs. <i>q</i> curve the target curve (<b>default: unchecked</b>).<p>
<li>
<b><i>Reset scaling</b></i> will cancel the current scaling.<p>
<li>
<b><i>Create scaled set</b></i> will generate the scaled <i>I</i>(<i>q</i>) vs. <i>q</i> curves with the extension <i>scaled_qx_xxxxxx_y_yyyyyy</i> with "<i>x_xxxxxx</i>" and "<i>y_yyyyyy</i>" being the <i>q</i> limits used for scaling (0.0105713 and 0.100552 &Aring;<sup>-1</sup> in this case).<p>
<li>
<b><i>Cancel</b></i> will exit from the <i>scaling</i> mode. 

</ul>

<p>

<hr>
We can now return to the <i>Global Gaussians</i> features by clicking again <b><i>Sel. Unsel.</b></i> in the <b><i>Data files</i></b> section and then the <b><i>Lin X</b></i> and <b><i>Lin Y</b></i> buttons. We restore the Gaussian by clicking on <b><i>Global Gaussians</b></i> and this time we'll answer "<i>No</i>" to the pop-up question:
<p><center>
<img SRC="somo-HPLC-SAXS_GlobalGaussianOptions.png" ALT="SOMO HPLC-SAXS Global Gaussians mode: fit amplitudes or restore saved ones">
</center>
<p>
since we do not need to re-fit the data:
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-SAXS_Gauss_GlobalGauss_no_refit.png" ALT="SOMO HPLC-SAXS Global Gaussians decomposition without refitting" width="700"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>

Each individual Gaussian is defined by three to five numbers: the amplitude, width and center, and optionally the distorsions parameters. As such, they are not "curves" in the sense of the loaded files, which are collections of data points. Therefore, the Gaussians can not be visualized with the facilities of the program outside of Gaussian or Global Gaussian modes.<p>
<ul>
<li>


To allow the visualization of the Gaussians, the <b><i>To produced data</i></b> button is provided which produces curves of individual Gaussians and their sum. This is available in either Gaussian or Global Gaussian modes. The resulting curves are collections of data points that can be visualized outside of the Gaussian modes. The Global Fit method requires a simultaneous fit of all the selected curves. This is internally represented by joining all the selected curves along the time/frame dimension to produce one long curve. Of course, each curve is generally on the same time/frame axis range, so to maintain increasing time/frame numbers, curves subsequent to the first one are placed into the joined curve with an offset in time/frame.
After pressing <b><i>Keep</b></i>, a set of curves are selected using the <b><i>Adv. Sel.</i></b> module in the <b><i>Data files</i></b> section:
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-SAXS_Gauss_Adv_Sel.png" ALT="SOMO HPLC-SAXS selecting Joined result curves and original data"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>

Here, files having  "<i>q0_0100813</i>" in their filename were searched and one original dataset and its derived Gaussians were selected and the transferred to the graphics screen: 
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-SAXS_Gauss8new.png" ALT="SOMO HPLC-SAXS Joined result curves and original data" width="700"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
To return to the original data, in the <b><i>Produced Data</i></b> section we press <b><i>Select all</b></i> and then <b><i>Show only</b></i>, followed by <b><i>Sel. Unsel.</b></i> in the <b><i>Data files</i></b> section. <b><i>Global Gaussians</b></i> can be again pressed answering <i>No</i> to the pop-up question. <p>
<li>
To visualize the joined curve and the Global Gaussian fit to the joined curve the <b><i>Make result curves</i></b> button is provided. This will create the joined curve along with the joined Global Gaussian fit as a pair of curves that can be visualized outside of the Global Gaussian mode, pressing <b><i>Keep</b></i> and then selecting the two produced files:<p>
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-SAXS_Gauss8anew.png" ALT="SOMO HPLC-SAXS Joined result curves and original data" width="1000"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
By zooming-in in this graph, any region of the joined original data and their fitting Gaussians can be examined, bearing in mind that the times (or frame numbers) have been sequentially added:
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-SAXS_Gauss8bnew.png" ALT="SOMO HPLC-SAXS Joined result curves and original data zoom 1" width="700"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>

<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-SAXS_Gauss8cnew.png" ALT="SOMO HPLC-SAXS Joined result curves and original data zoom 2" width="700"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
The produced data for the individual Gaussians and/or their sum can now be saved or discarded.<p>

<hr>
<hr>

If available, a concentration chromatogram deriving from UV or refractive index monitors can now be processed. After uploading a suitable file with the <b><i>Concentration load</i></b> button:<p>
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-SAXS_Conc_chrom.png" ALT="SOMO HPLC-SAXS Concentration Chromatogram" width="1000"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>

the first operation is to rescale it to one of the high intensity but relatively low-noise <i>I(t)</i> vs. <i>t</i> chromatograms. This is done by selecting the two files:<p>
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-SAXS_Conc_chrom1.png" ALT="SOMO HPLC-SAXS Concentration Chromatogram and target file" width="1000"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>

and pressing <b><i>Repeak</i></b> in the left-side command panel. In case multiple <i>I(t)</i> vs. <i>t</i> were selected, it will bring up a small window asking to identify the target chromatogram:<p>

<p><center>
<img SRC="somo-HPLC-SAXS_Conc_chrom2.png" ALT="SOMO HPLC-SAXS Target Chromatogram selection">
</center>
<p>

On pressing <i>Ok</i>, a pop-up panel will appear:<p>
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_conc_util_pop_up1b.png" ALT="Somo-HPLC/KIN graphics concentration utility pop-up SD question"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
Usually the SD are ignored by pressing the first option presented, but the module offers two other alternatives, <i>Match target SD % pointwise</i> and <i>Set S.D.'s to 5%</i> (these two choices could be useful in the Gaussian decomposition procedure if less stringent constraints are sought for the concentration associated data). For this example we choose <i>Match target SD % pointwise</i>. Whatever the choice, the repeak operation affects the data, a new file is generated with "rp" extension and the scaling factor, which will be used to re-generate the proper intensity scale when needed, added at the end of the filename:
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_conc_util_repeak1.png" ALT="Somo-HPLC/KIN graphics concentration utility repeaked" width="1000"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
At the same time, another pop-up panel will ask if you want to "*Set*" (see below) the repeaked concentration file:
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_conc_util_pop_up2.png" ALT="Somo-HPLC/KIN graphics concentration utility pop-up repeaked set question"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
If no time-shift between the concentration and the SAXS detectors is present, the repeaked concentration file can then be directly associated with the SAXS datasets. In this case the answer will be <i>No</i>, since the two chromatograms are still time-shifted one in respect to the other.

<li>
<b><i>Timeshift</i></b> can then be used to align the two chromatograms. On pressing it, the program will automatically traslate the concentration chromatogram so that the top of the maximum intensity peaks will coincide. The alignment can then be refined manually by left-clicking and moving the mouse over the cyan-shades bar-wheel below the graphics window until the two chromatograms are best aligned.<p>
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_conc_util_time_shift.png" ALT="Somo-HPLC/KIN concentration utility time shift" width="1000"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>

The value of the timeshift is reported in the field next to the cyan-shades bar-wheel.<p>

<b><i>Cancel</i></b> will stop the operation.<p>

<b><i>Keep</i></b> will keep the time-shifted data. The produced data will have the timeshift value added to its filename on saving.<p>

Then, the pop-up panel will ask if you want to "*Set*" the repeaked concentration file:
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_conc_util_pop_up2.png" ALT="Somo-HPLC/KIN graphics concentration utility pop-up repeaked set question"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>

Answering "yes" will then associate the re-peaked, time-shifted concentration data to the <i>I(t)</i> vs. <i>t</i> SAXS dataset under analysis. This operation can be anyway performed at any time by selecting only a concentration chromatogram dataset, and pressing <b><i>Set</i></b>. The concentration chromatogram shown in this example is then cropped to remove the extra frames on the right side, matching the SAXS <i>I</i>(<i>t</i>) vs. <i>t</i> chromatograms:
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_conc_util_time_shift_crop.png" ALT="Somo-HPLC/KIN concentration utility time shifted cropped" width="1000"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>

The re-peaked, time-shifted concentration chromatogram can be now fitted with Gaussians, using for initialization the set derived from the <i>I(t)</i> vs. <i>t</i> chromatograms (note: it is mandatory that the same number of Gaussians be used for both the concentration and <i>I(t)</i> vs. <i>t</i> chromatograms).<p>

This is done by first selecting only the concentration chromatogram and then pressing <b><i>Gaussian</i></b>, which will bring up the current Gaussian parameters automatically rescaled to the highest intensity in the concentration chromatogram:<p> 
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_conc_chrom_init_Gauss.png" ALT="Somo-HPLC/KIN Conc. Chromatogram initial Gaussians" width="1000"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>

Pressing <b><i>Fit</i></b> will then bring up the <b>Fit</b> window (see <a href=somo_saxs_hplc_fit.html>here</a>) and an initial round is done by keeping fixed both the position and widths:
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_conc_chrom_first_Gauss_fit.png" ALT="Somo-HPLC/KIN Conc. Chromatogram first Gaussians fit" width="1000"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
If necessary, a refinement can be done by keeping fixed the smallest, front eluting peak(s), and allowing only a limited shift to a % of the initial values from the widths and positions determined from the SAXS data (suggested: 2-3% max). This should compensate for slight misalignment between the concentration and SAXS detectors chromatograms:
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_conc_chrom_second_Gauss_fit.png" ALT="Somo-HPLC/KIN Conc. Chromatogram second Gaussians fit" width="1000"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>

As evidenced in the image above, some band broadening has occurred between the UV-VIS and SAXS detectors. While the issue appears to be relatively minor here, it can be more serious. To at least partially mitigate this issue, we have implemented a re-shaping routine that re-aligns the shape of the concentration detector chromatogram to that of the SAXS detector chromatograms. It is based on determining first the area under each Gaussian peak in the concentration chromatogram after fitting it with the SAXS-derived Gaussians with minimal centers and widths changes, as described above. Then, when the <b><i>Make I(q)</i></b> routine is launched, the concentration chromatogram Gaussians can be optionally re-shaped on the SAXS-optimized Gaussians, keeping their areas fixed and adjusting the other parameters (see below).<p>
<li>
The <b><i>Save</i></b> and <b><i>Keep</i></b> buttons must be then pressed to store and associate the resulting Gaussians to the concentration chromatogram. On re-generating the <i>I(q)</i> vs. <i>q</i> frames (see below), each concentration Gaussian peak will be mapped onto the corresponding <i>I(t)</i> vs. <i>t</i> peaks.<p>
<li>
The <b><i>Make I(q)</i></b> button becomes available every time that more than one <i>I</i>(<i>t</i>) chromatogram is selected. If Gaussian fitting was performed, pressing it will produce a series of <i>I(q)</i> vs. <i>q</i> curves for each Gaussian peak for each frame of the chromatogram on which the global operations have been carried out. An option panel in a pop-up window will allow several choices:
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_Make_Iq.png" ALT="Somo-HPLC/KIN Make I(q)" width="1000"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>

A description of this module can be found <a href=saxs_hplc_ciq.html>here</a>.<p>
</ul>
At the end of the <i>Make I(q)</i> operations, if the <i>Average and normalize resulting I(q) curves by Gaussian, using top % of max. intensity"</i> checkbox had been selected, the graphics window will report the averaged curves for each Gaussian-decomposed peak:
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_Make_Iq_results.png" ALT="Somo-HPLC/KIN Make I(q) results" width="1000"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
shown here in log<sub>10</sub>-log<sub>10</sub> mode and after zooming. Note that since the <i>Make I*(q) using the concentration curve "filename"?</i> checkbox was also selected, we have produced <i>I*</i>(<i>q</i>) vs. <i>q</i> data in [g/mol] units. The intercepts at <i>q</i>=0 then give an approximate molecular weight estimation. This could be immediately verified by selecting a single averaged <i>I*</i>(<i>q</i>) vs. <i>q</i> dataset, like peak #4, and pressing the <b><i>Guinier</i></b> button:<p>
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_Make_Iq_results_Guinier.png" ALT="Somo-HPLC/KIN Make I(q) results I*(q) Guinier" width="700"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
Here we can see that the Guinier-extrapolated <i>I*</i>(0) gives a value that although a bit high is consistent with monomeric BSA (&sim;66,500 g/mol). The <i>R<sub>g</sub></i> value is in excellent agreement with that computed from the structure (28.3 &Aring;).<p> 

If the <i>Make I*(q) using the concentration curve "filename"?</i> checkbox is <b>not</b> selected, two averaged <i>I</i>(<i>q</i>) vs. <i>q</i> curves for each Gaussian-decomposed peak will be produced, simple average and average normalized by the concentration:
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_Make_Iq_results1.png" ALT="Somo-HPLC/KIN Make I(q) results no I*(q)" width="1000"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>
Here we see just the two <i>I</i>(<i>q</i>) vs. <i>q</i> curves for peak #4.<p>
<ul>
<li>
The re-generated <i>I(q)</i> or <i>I*(q)</i> vs. <i>q</i> data can be directly exported to the main <a href=somo_saxs.html><b><i>US-SOMO SAS</i></b></a> module for further operations by pressing the <b><i>To SOMO/SAS</b></i> button.<p>
</ul>

<a id="ConcRef"></a>
If a concentration chromatogram is associated with the data, an additional utility present in this module allows to map a single selected <i>I(q)</i> vs. <i>q</i> dataset onto the concentration chromatogram, by pressing the <b><i>Concentration reference</i></b> button:<p> 
<p>
<center>
<table id="somomainwindow" BORDER CELLSPACING=2 CELLPADDING=5 bgcolor="#FFFFFF">
<tr>
<td><center><img SRC="somo-HPLC-KIN_conc_ref.png" ALT="SOMO HPLC-SAXS concentration reference" width="1000"></td>
</tr> 
</table>
</center>
<td align=justify>
<p>

In the example shown above, the <i>I(q)</i> vs. <i>q</i> data for the decomposed peak #3 frame #80 are shown with their associated errors, and below it the position of this dataset is shown by the vertical red line on the associated concentration cromatogram. Each time a different chromatogram is selected, its position will be mapped on the concentration plot.<p>
Pressing the <b><i>Concentration reference</i></b> button again will make this additional plot disappear.<p>
<p>
Finally, the data shown in any of the plots currently visualized can be saved in csv-formatted files by pressing the <b><i>Save plots</i></b> button accessible from the <i>Selections</i> checkbox at the top of the graphics window. This will open a pop-up dialogue window where the location and the root filename for the cvs files can be set.<p>

<p>

<br>
<hr>
<font face="helvetica" size="-1">
www contact: <a href="mailto:emre.brookes@umt.edu">Emre Brookes</a>
</font>
<p>
<font face="helvetica" size="-1">
This document is part of the <i><b>UltraScan</b></i> Software Documentation
distribution. <br><a href=copyright.html>Copyright &copy; notice</a>.<br><br> The latest version of this document can always be found at:
</font>
<p>
<font face="helvetica" size="-1">
<a href="http://somo.aucsolutions.com">http://somo.aucsolutions.com</a>
</font>
<p>
<font face="helvetica" size="-1">
Last modified on July 11, 2024.
</font>
</body>
</html>
