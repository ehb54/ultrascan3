<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
   "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta content="text/html;charset=ISO-8859-1" http-equiv="Content-Type">
	<title>SOMO HPLC-SAXS Module SVD Utility</title>
	<link href="mainstyle1.css" rel="styleSheet" type="text/css">
</head>
<body>
<table BORDER=0 CELLPADDING=5 >
<tr>
<td><img SRC="USSOMO-banner.png" BORDER="0" ALT="UltraScan Version"> </td>
<td>
<center>
<h1>
<i>Manual</i></h1></center>
</td>
</tr>
</table>

<hr>
<center>
<h2>
SOMO HPLC-SAXS Module SVD Utility:</h2></center>
<h3><center>Last updated: April 2016 </center></h3><p>


This utlity was developed to perform single-value decomposition (SVD; e.g., Williamson et al.,  Biophys J. 94, 4906-4923, 2008) on a set of <i>I(q)</i> vs. <i>q</i> data, which can come from a HPLC-SAXS experiment, or from any other SAS type of data, like a concentration series. <p>
A single SAS experimental dataset is typically represented as <i>I(q)</i>, where <i>q</i> is a grid of  points. A sequence  of <i>n I(q)<sub>t(j)</sub></i> on the same <i>q</i>-grid can be assembled into a <i>m</i>&nbsp;&times;&nbsp;<i>n</i> matrix <i><b>I</b></i>&nbsp;=&nbsp;[<i><b>I</b><sub>ij</sub></i>]&nbsp;= [<i>I(q)<sub>t(1)</sub></i>, <i>I(q)<sub>t(2)</sub></i>, ..., <i>I(q)<sub>t(n)</sub></i>]. Each column of <i><b>I</b></i> contains an <i>I(q)</i> curve for a specific <i>t</i> and each row contains an <i>I(t)</i> curve for a specific <i>q</i>. If standard deviations of the experimental data are available, these can be analogously placed in a matrix <i><b>S</b></i>. If a synchronized concentration dataset <i>C(t)</i> is available, it can be added to <i><b>I</b></i> as an additional row.<p>
In a SVD analysis, if <i><b>I</b></i> is the matrix containing the original data, then:<p>

<i><b>I</i></b> = <b><i>USV<sup>T</sup></i></b> <p>

where <i><b>U</b></i> is an orthogonal <i>m</i>&nbsp;&times;&nbsp;<i>m</i> matrix, <i><b>S</i></b> is a diagonal <i>m</i>&nbsp;&times;&nbsp;<i>n</i> matrix, and <i><b>V<sup>T</sup></i></b> is an orthogonal <i>n</i>&nbsp;&times;&nbsp;<i>n</i> matrix. The elements of the diagonal of <i><b>S</i></b> are the singular values. Reconstructing an approximation of the matrix <i><b>I</i></b> proceeds by setting some diagonal elements of <i><b>S</i></b> to zero, forming <i><b>S'</i></b> and performing the multiplication<p>

<i><b>I'</i></b> = <b><i>US'V<sup>T</sup></i></b> <p>

SVD can be performed either on the original or on the baseline-subtracted I(q) vs. q data or subset of data (if significant baseline drift occurs, the SVD will try to fit also that part of the signal).<p>
After selecting the data, pressing the <i><b>SVD</i></b> button in the <b>HPLC-SAXS</b> module will open a new window:<p>

<p><center>
<img SRC="somo-HPLC-SAXS_SVD.png" ALT="SOMO HPLC-SAXS SVD Utility">
</center>
<p>


The top left box labelled <b>Data files</b> will contain a list of the data set in an expandable format. The first set will be labelled "Original data". Opening the item will show its contents, "I(q)" and "I(t)", which can be further expanded to show/select the individual curves in the data set.<p>

<b><i>Replot</i></b> will become active when a selection is changed from what is currently plotted; pressing it will refresh the plot display. For example, selecting "Original data" at the top level and pressing <b><i>Replot</i></b> will plot the entire dataset, but only in the "I(q)" or "I(t)" mode.<p>

<b><i>TO HPLC window</i></b> will transfer the selected dataset back to the <b>HPLC-SAXS</b> module main window.<p>

<b><i>Show I(t)</b></i> or <b><i>Show I(q)</i></b> toggle button below the plot window will show the <i>I(t)</i> vs. <i>t</i> or <i>I(q)</i> vs. <i>q</i> view of the data and automatically replot.<p>

<b><i>Color</i></b> will rotate the plot colors based upon a pre-defined palette.<p>

When a single data set or sub-selection of individual <i>I(q)</i> curves from a single dataset are selected and the plot window is in "I(q)" mode, the <b><i>Compute SVD</i></b> button in the <b>Process</b> box becomes active.<p>

<p><center>
<img SRC="somo-HPLC-SAXS_SVD1.png" ALT="SOMO HPLC-SAXS SVD Utility">
</center>
<p>


Pressing <b><i>Compute SVD</i></b> will compute the singular value decomposition (Lawson &amp; Hanson, &nbsp;Solving least squares problems. SIAM, Philadelphia, 1995). The singular values (SVs) will be sorted in descending order and placed on the screen in the <i>Singular value list</i> window.<p>

<b><i>Plot SVs</i></b> will plot the SVs in the plot area, by default in a linear vs. log scale (see above).<p>

The axes scales can be toggled between logarithmic and linear by pressing the <b><i>X</i></b> or <i><b>Y</i></b> buttons below the plot window.<p>

<b><i>Save SVs</i></b> will save the SVs to a file. Giving the filename a ".csv" extension will result in a comma separated output, otherwise, the output will be "TAB" separated.<p>

Selecting any set of SVs in the <i>Singular value list</i> by clicking on it will activate three more buttons: <b><i>TSVD reconstruction</i></b>, <b><i>Individual TSVD recon.</i></b>, and <i><b>Incremental TSVD recon.</i></b>.<p>

<p><center>
<img SRC="somo-HPLC-SAXS_SVD2.png" ALT="SOMO HPLC-SAXS SVD Utility">
</center>
<p>

<b><i>TSVD reconstruction</i></b> will generate a new dataset in the <b>Data files</b> section consisting of the reconstruction of the data based upon the selected SVs. "TSVD" means a truncated SVD reconstruction (Aster et al., Parameter Estimation and Inverse Problems. Elsevier Academic Press, 2005), which formally should be computed on the numerically highest SVs, but here we are using the term loosely, to mean reconstruction on any subset of the SVs. The resulting dataset can be selected, expanded and/or plotted identically to the original data. Expanding the TSVD data will show "I(q)", "I(t)", "SVs used" expandable subsections and also the root mean squared deviation over the number of points (RMSD) of the expansion and the name of the reference dataset for the reconstruction.<p>

<b><i>Individual TSVD recon.</i></b> will take the selected SVs and produce a TSVD reconstruction for each value selected individually, resulting in multiple TSVD reconstructions in the <b>Data files</b> section.<p>

<b><i>Incremental TSVD recon.</i></b> will take the selected singular values and produce a TSVD reconstruction for the first value selected, then for the first and second values selected, etc., until all the selected values are included in a reconstruction, again resulting in multiple reconstructions in the <b>Data files</b> section, as in the example shown above. Note that the display has been swithced to the "I(t)" mode, where the goodness of the reconstruction can be better appreciated than in the "I(q)" mode.<p>

When <b><i>Individual TSVD recon.</i></b> or <i><b>Incremental TSVD recon.</i></b> are selected, the <i>residuals</i> checkbox under the plot appears. Selecting this checkbox will plot the residuals of the reconstruction vs. the reference dataset in a new plot area below the main plot area. When residuals are displayed, additional checkboxes will be available under the plot. These include:<p>
<ul>
<li>
<i>Use SDs</i>, which turns on division of the residuals by the SD of the reference dataset and will not be available for data without SDs (as in the example shown above). Note that in the default mode, the residuals are displayed in a linear contiguous manner for each original dataset;<p>

<li>
<i>By percent</i>, which displays the differences by percent;<p>

<li>
<i>Reverse</i> which reverses the Y-axis around zero;<p>

<li>
<i>Reference</i>, which toggles on/off the display of the reference data in the main plot window;<p>

<li>
<i>Group</i>, which toggles grouping of the residuals between the linearly contiguous manner and superimposed (as shown below).<p>
</ul>

<p><center>
<img SRC="somo-HPLC-SAXS_SVD3.png" ALT="SOMO HPLC-SAXS SVD Utility">
</center>
<p>

Once an individual or incremental reconstruction is computed, two more buttons activate:<p>

<b><i>Plot RMSDs</i></b> and <b><i>Save RMSDs</i></b>, allowing plotting and saving analogous to the <b><i>Plot SVs</b></i> and <b><i>Save SVs</i></b> mentioned previously.<p>

<p><center>
<img SRC="somo-HPLC-SAXS_SVD4.png" ALT="SOMO HPLC-SAXS SVD Utility">
</center>
<p>

As mentioned above, any reconstructed dataset can then be added to the <b>US-SOMO/HPLC-SAXS</b> module by selecting and pressing the <b><i>To HPLC window</i></b> button. Note only the "I(q)" or "I(t)" data will be added depending on the plot mode.<p>

As an example, suppose one wants to determine the number of components present in a set of <i>I(q)</i> vs. <i>q</i> curves. After bringing them into the <b>SVD</b> module as described above, the SVD can be then computed. By looking at the SVs plot, one can evaluate that at most <i>N</i> singular values seem reasonable to reconstruct the dataset. One would then select the numerically largest <i>N</i> values in the SV list and run an incremental reconstruction. Subsequently, each reconstructed dataset could be compared by RMSD and visually to determine the effect of adding additional singular values to the reconstruction to assist the determination of the minimum number of singular values required to accurately reconstruct the original data. Another check would be to run the individual reconstruction on the same set of selected singular values and inspecting the individual datasets visually (preferable via I(t) plots) to see if there seems to be signal present in reconstructions past a minimum number of singular values. In this way, the <b>US-SOMO/HPLC/SVD</b> module can be used to approximate the number of independent components present in a HPLC experimental dataset or even a concentration series.
 


<p>
<hr>
<font face="helvetica" size="-1">
www contact: <a href="mailto:emre.brookes@umt.edu">Emre Brookes</a>
</font>
<p>
<font face="helvetica" size="-1">
This document is part of the <i><b>UltraScan</b></i> Software Documentation
distribution. <br><a href=copyright.html>Copyright &copy; notice</a>.<br><br> The latest version of this document can always be found at:
</font>
<p>
<font face="helvetica" size="-1">
<a href="http://somo.aucsolutions.com">http://somo.aucsolutions.com</a>
</font>
<p>
<font face="helvetica" size="-1">
Last modified on April 18, 2016.
</font>
</body>
</html>
