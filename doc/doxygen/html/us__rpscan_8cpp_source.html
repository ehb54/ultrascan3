<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> 
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/>
<title>us_rpscan.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="../custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div style="margin 0pt auto; width:50%;"><img src="../ultrascan3.png" alt="UltraScan III"/></div>
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_7b0a5d1507c7f681cbfa1deb5990c6ea.html">programs</a></li><li class="navelem"><a class="el" href="dir_79b9acda63c1f1f7fe9179d59f3e3965.html">us_pcsa</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">us_rpscan.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="us__rpscan_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="us__rpscan_8h.html">us_rpscan.h</a>&quot;</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="us__pcsa_8h.html">us_pcsa.h</a>&quot;</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="us__settings_8h.html">us_settings.h</a>&quot;</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="us__gui__settings_8h.html">us_gui_settings.h</a>&quot;</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="us__gui__util_8h.html">us_gui_util.h</a>&quot;</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="us__math2_8h.html">us_math2.h</a>&quot;</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="us__sleep_8h.html">us_sleep.h</a>&quot;</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;qwt_scale_widget.h&gt;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;qwt_scale_draw.h&gt;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#if QT_VERSION &lt; 0x050000</span></div><div class="line"><a name="l00014"></a><span class="lineno"><a class="line" href="us__rpscan_8cpp.html#adad95ef952c7a18ee02328875ab76dc3">   14</a></span>&#160;<span class="preprocessor">#define setSamples(a,b,c)  setData(a,b,c)</span></div><div class="line"><a name="l00015"></a><span class="lineno"><a class="line" href="us__rpscan_8cpp.html#ad402372332445305d93ed64ceb3481c8">   15</a></span>&#160;<span class="preprocessor">#define setSymbol(a)       setSymbol(*a)</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">// Constructor:  Regularization Parameter Scan widget</span></div><div class="line"><a name="l00019"></a><span class="lineno"><a class="line" href="classUS__RpScan.html#a4a438843f580b188f4dd1575b2191df8">   19</a></span>&#160;<a class="code" href="classUS__RpScan.html#a4a438843f580b188f4dd1575b2191df8">US_RpScan::US_RpScan</a>( QList&lt; US_SolveSim::DataSet* &gt;&amp;dsets,</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;      <a class="code" href="classUS__ModelRecord.html">US_ModelRecord</a>&amp; mr, <span class="keywordtype">int</span>&amp; thr, <span class="keywordtype">double</span>&amp; alf, QWidget* <a class="code" href="namespaceUS__WinData.html#a85f3cb45f5a36707c5fc56eea6821d55">p</a> )</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;   : <a class="code" href="classUS__WidgetsDialog.html">US_WidgetsDialog</a>( <a class="code" href="namespaceUS__WinData.html#a85f3cb45f5a36707c5fc56eea6821d55">p</a>, 0 ), dsets( dsets ), mrec( mr ), nthr( thr ),</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;   alpha( alf )</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;{</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;   <a class="code" href="classUS__RpScan.html#ae82bf6719884cc75eb7a4ec58f30e6b6">alpha</a>           = 0.0;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<a class="code" href="us__loadable__noise_8h.html#a48744322ededb3a6a1d2a410bb4d8bdc">DbgLv</a>(1) &lt;&lt; <span class="stringliteral">&quot;TRP:  RpScan IN&quot;</span>;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;   <span class="comment">// lay out the GUI</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;   setObjectName( <span class="stringliteral">&quot;US_RpScan&quot;</span> );</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;   setAttribute( Qt::WA_DeleteOnClose, <span class="keyword">false</span> );</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;   setWindowTitle( tr( <span class="stringliteral">&quot;Regularization Parameter (Alpha) Scan&quot;</span> ) );</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;   setPalette( <a class="code" href="classUS__GuiSettings.html#add175856da34329ec19668f2ec94fa6e">US_GuiSettings::frameColor</a>() );</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;   QSize p1size( 560, 480 );</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;   <a class="code" href="classUS__RpScan.html#a693c9b87865a3f540f7060bc17904948">dbg_level</a>       = <a class="code" href="classUS__Settings.html#aa42f5a10a330ef63746bd55e930e208a">US_Settings::us_debug</a>();</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;   <a class="code" href="classUS__RpScan.html#a0a6d604d2ef8c5774481f57c399541d1">v_line</a>          = NULL;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;   <a class="code" href="classUS__RpScan.html#af44f9385e0cd14e6ec1856b6b9317c53">mainLayout</a>      = <span class="keyword">new</span> QHBoxLayout( <span class="keyword">this</span> );</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;   <a class="code" href="classUS__RpScan.html#ae124d4a2d18ccbcb2d1b038735058749">leftLayout</a>      = <span class="keyword">new</span> QVBoxLayout();</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;   <a class="code" href="classUS__RpScan.html#abe3980d48229f2b7f39771fb6706dcfd">rightLayout</a>     = <span class="keyword">new</span> QVBoxLayout();</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;   <a class="code" href="classUS__RpScan.html#a2cc5331af7602f5efad43f3d3698693d">pltctrlsLayout</a>  = <span class="keyword">new</span> QGridLayout();</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;   <a class="code" href="classUS__RpScan.html#a5f0012ac896c1b1341ba18bf77884296">buttonsLayout</a>   = <span class="keyword">new</span> QHBoxLayout();</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;   <a class="code" href="classUS__RpScan.html#af44f9385e0cd14e6ec1856b6b9317c53">mainLayout</a>-&gt;setSpacing        ( 2 );</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;   <a class="code" href="classUS__RpScan.html#af44f9385e0cd14e6ec1856b6b9317c53">mainLayout</a>-&gt;setContentsMargins( 2, 2, 2, 2 );</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;   QLabel* lb_datctrls    = <a class="code" href="classUS__WidgetsDialog.html#a6682bbf362a7f13b082893e54d47bfd2">us_banner</a>( tr( <span class="stringliteral">&quot;PCSA Model Parameters&quot;</span> ) );</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;   QLabel* lb_mtype       = <a class="code" href="classUS__WidgetsDialog.html#a6609f3c76d6df5e63da38f20e3c82626">us_label</a>(  tr( <span class="stringliteral">&quot;Model Type:&quot;</span> ) );</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;   QLabel* lb_npoints     = <a class="code" href="classUS__WidgetsDialog.html#a6609f3c76d6df5e63da38f20e3c82626">us_label</a>(  tr( <span class="stringliteral">&quot;Points per Line:&quot;</span> ) );</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;   QLabel* lb_mdlpar1     = <a class="code" href="classUS__WidgetsDialog.html#a6609f3c76d6df5e63da38f20e3c82626">us_label</a>(  tr( <span class="stringliteral">&quot;Best Model Par 1:&quot;</span> ) );</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;   QLabel* lb_mdlpar2     = <a class="code" href="classUS__WidgetsDialog.html#a6609f3c76d6df5e63da38f20e3c82626">us_label</a>(  tr( <span class="stringliteral">&quot;Best Model Par 2:&quot;</span> ) );</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;   QLabel* lb_scnctrls    = <a class="code" href="classUS__WidgetsDialog.html#a6682bbf362a7f13b082893e54d47bfd2">us_banner</a>( tr( <span class="stringliteral">&quot;Alpha Scan Parameters&quot;</span> ) );</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;   QLabel* lb_stralpha    = <a class="code" href="classUS__WidgetsDialog.html#a6609f3c76d6df5e63da38f20e3c82626">us_label</a>(  tr( <span class="stringliteral">&quot;Starting Alpha:&quot;</span> ) );</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;   QLabel* lb_endalpha    = <a class="code" href="classUS__WidgetsDialog.html#a6609f3c76d6df5e63da38f20e3c82626">us_label</a>(  tr( <span class="stringliteral">&quot;Ending Alpha:&quot;</span> ) );</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;   QLabel* lb_incalpha    = <a class="code" href="classUS__WidgetsDialog.html#a6609f3c76d6df5e63da38f20e3c82626">us_label</a>(  tr( <span class="stringliteral">&quot;Alpha Increment:&quot;</span> ) );</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;   QLabel* lb_selalpha    = <a class="code" href="classUS__WidgetsDialog.html#a6609f3c76d6df5e63da38f20e3c82626">us_label</a>(  tr( <span class="stringliteral">&quot;Selected Alpha:&quot;</span> ) );</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;   QLabel* lb_status      = <a class="code" href="classUS__WidgetsDialog.html#a6609f3c76d6df5e63da38f20e3c82626">us_label</a>(  tr( <span class="stringliteral">&quot;Status:&quot;</span> ) );</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;   QPushButton* pb_scan   = <a class="code" href="classUS__WidgetsDialog.html#ac5ff592876f121e8de67e072df43cfa6">us_pushbutton</a>( tr( <span class="stringliteral">&quot;Start Scan&quot;</span> ) );</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;   QPushButton* pb_help   = <a class="code" href="classUS__WidgetsDialog.html#ac5ff592876f121e8de67e072df43cfa6">us_pushbutton</a>( tr( <span class="stringliteral">&quot;Help&quot;</span> ) );</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;   QPushButton* pb_accept = <a class="code" href="classUS__WidgetsDialog.html#ac5ff592876f121e8de67e072df43cfa6">us_pushbutton</a>( tr( <span class="stringliteral">&quot;Accept&quot;</span> ) );</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;   QPushButton* pb_cancel = <a class="code" href="classUS__WidgetsDialog.html#ac5ff592876f121e8de67e072df43cfa6">us_pushbutton</a>( tr( <span class="stringliteral">&quot;Cancel&quot;</span> ) );</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;   <span class="keywordtype">int</span> nppln    = <a class="code" href="classUS__RpScan.html#aa774aaa46a0d7e44b89fe0e87f679e88">mrec</a>.<a class="code" href="classUS__ModelRecord.html#aff3ed3f9bbecc208ac4ce036b948b271">isolutes</a>.size();</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<a class="code" href="us__loadable__noise_8h.html#a48744322ededb3a6a1d2a410bb4d8bdc">DbgLv</a>(1) &lt;&lt; <span class="stringliteral">&quot;TRP:  nppln&quot;</span> &lt;&lt; nppln;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;   <span class="comment">// lay out the GUI</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;   <span class="keywordtype">double</span> par1  = <a class="code" href="classUS__RpScan.html#aa774aaa46a0d7e44b89fe0e87f679e88">mrec</a>.<a class="code" href="classUS__ModelRecord.html#a014a3f5fe678ce301c304515c31ef869">par1</a>;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;   <span class="keywordtype">double</span> par2  = <a class="code" href="classUS__RpScan.html#aa774aaa46a0d7e44b89fe0e87f679e88">mrec</a>.<a class="code" href="classUS__ModelRecord.html#a6662defffb761058dfb669e0fc2500f3">par2</a>;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;   <a class="code" href="classUS__RpScan.html#a0da0c2c3b6f65a12f070281c64107665">le_mtype</a>     = <a class="code" href="classUS__WidgetsDialog.html#a76fe047edde0ad939dd865c840a1bde0">us_lineedit</a>( tr( <span class="stringliteral">&quot;Straight Line&quot;</span> ),    -1, <span class="keyword">true</span> );</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;   <a class="code" href="classUS__RpScan.html#a9b4a0f43193cb272897c687058aa9ff8">le_npoints</a>   = <a class="code" href="classUS__WidgetsDialog.html#a76fe047edde0ad939dd865c840a1bde0">us_lineedit</a>( QString::number( nppln ), -1, <span class="keyword">true</span> );</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;   <a class="code" href="classUS__RpScan.html#ae5e0c0ac7a01b6f858b5081d167ebb3f">le_mdlpar1</a>   = <a class="code" href="classUS__WidgetsDialog.html#a76fe047edde0ad939dd865c840a1bde0">us_lineedit</a>( QString::number( par1  ), -1, <span class="keyword">true</span> );</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;   <a class="code" href="classUS__RpScan.html#aa70e25c29dd1460ebca43be4031e2318">le_mdlpar2</a>   = <a class="code" href="classUS__WidgetsDialog.html#a76fe047edde0ad939dd865c840a1bde0">us_lineedit</a>( QString::number( par2  ), -1, <span class="keyword">true</span> );</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;   <a class="code" href="classUS__RpScan.html#a192b8f1a258847c542c637541c68e556">ct_stralpha</a>  = <a class="code" href="classUS__WidgetsDialog.html#a318a7e6cfd48b32a81f89a1ef0fb104b">us_counter</a>( 3, 0.000, 1000.0, 0.020 );</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;   <a class="code" href="classUS__RpScan.html#a5854c74286db65fa1064778e373f9b0b">ct_endalpha</a>  = <a class="code" href="classUS__WidgetsDialog.html#a318a7e6cfd48b32a81f89a1ef0fb104b">us_counter</a>( 3, 0.000, 1000.0, 0.800 );</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;   <a class="code" href="classUS__RpScan.html#ad409e78d19b7760a0d87d9f2d1218a46">ct_incalpha</a>  = <a class="code" href="classUS__WidgetsDialog.html#a318a7e6cfd48b32a81f89a1ef0fb104b">us_counter</a>( 3, 0.000, 1000.0, 0.020 );</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;   <a class="code" href="classUS__RpScan.html#aa68675b633ab0db9abb598a0c238186f">le_selalpha</a>  = <a class="code" href="classUS__WidgetsDialog.html#a76fe047edde0ad939dd865c840a1bde0">us_lineedit</a>( QString::number( <a class="code" href="classUS__RpScan.html#ae82bf6719884cc75eb7a4ec58f30e6b6">alpha</a> ), -1, <span class="keyword">false</span> );</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;   <a class="code" href="classUS__RpScan.html#a192b8f1a258847c542c637541c68e556">ct_stralpha</a>-&gt;setSingleStep( 0.001 );</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;   <a class="code" href="classUS__RpScan.html#a5854c74286db65fa1064778e373f9b0b">ct_endalpha</a>-&gt;setSingleStep( 0.001 );</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;   <a class="code" href="classUS__RpScan.html#ad409e78d19b7760a0d87d9f2d1218a46">ct_incalpha</a>-&gt;setSingleStep( 0.001 );</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;   <a class="code" href="classUS__RpScan.html#a8f8516724c3481bd843776855f1c9dbf">b_progress</a>   = <a class="code" href="classUS__WidgetsDialog.html#af885c37a818aee690ce2e76af584da13">us_progressBar</a>( 0, 100, 0 );</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;   <a class="code" href="classUS__RpScan.html#ae1290674c1816c67b6234caec58ff86a">le_stattext</a>  = <a class="code" href="classUS__WidgetsDialog.html#a76fe047edde0ad939dd865c840a1bde0">us_lineedit</a>( <span class="stringliteral">&quot;&quot;</span>, -1, <span class="keyword">true</span> );</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;   <span class="comment">// Adjust the size of line counters and rmsd text</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;   lb_mtype -&gt;adjustSize();</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;   QFont        font( <a class="code" href="classUS__GuiSettings.html#a9240f8fd7a4b6b2bb4d5f4a040924a37">US_GuiSettings::fontFamily</a>(),</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                      <a class="code" href="classUS__GuiSettings.html#a0503197dacde223a1688eaa38449fe25">US_GuiSettings::fontSize</a>() );</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;   QFontMetrics fmet( font );</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;   <span class="keywordtype">int</span>  fwidth   = fmet.maxWidth();</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;   <span class="keywordtype">int</span>  rheight  = lb_mtype-&gt;height();</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;   <span class="keywordtype">int</span>  cminw    = fwidth * 9;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;   <span class="keywordtype">int</span>  csizw    = cminw + fwidth;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;   <a class="code" href="classUS__RpScan.html#a192b8f1a258847c542c637541c68e556">ct_stralpha</a>-&gt;resize( csizw, rheight );</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;   <a class="code" href="classUS__RpScan.html#a5854c74286db65fa1064778e373f9b0b">ct_endalpha</a>-&gt;resize( csizw, rheight );</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;   <a class="code" href="classUS__RpScan.html#ad409e78d19b7760a0d87d9f2d1218a46">ct_incalpha</a>-&gt;resize( csizw, rheight );</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;   <a class="code" href="classUS__RpScan.html#a192b8f1a258847c542c637541c68e556">ct_stralpha</a>-&gt;setMinimumWidth( cminw );</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;   <a class="code" href="classUS__RpScan.html#a5854c74286db65fa1064778e373f9b0b">ct_endalpha</a>-&gt;setMinimumWidth( cminw );</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;   <a class="code" href="classUS__RpScan.html#ad409e78d19b7760a0d87d9f2d1218a46">ct_incalpha</a>-&gt;setMinimumWidth( cminw );</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<a class="code" href="us__loadable__noise_8h.html#a48744322ededb3a6a1d2a410bb4d8bdc">DbgLv</a>(1) &lt;&lt; <span class="stringliteral">&quot;TRP:  csizw cminw&quot;</span> &lt;&lt; csizw &lt;&lt; cminw;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;   <span class="comment">// Add elements to the controls layout</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;   <span class="keywordtype">int</span>  row      = 0;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;   <a class="code" href="classUS__RpScan.html#a2cc5331af7602f5efad43f3d3698693d">pltctrlsLayout</a>-&gt;addWidget( lb_datctrls, row++, 0, 1, 6 );</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;   <a class="code" href="classUS__RpScan.html#a2cc5331af7602f5efad43f3d3698693d">pltctrlsLayout</a>-&gt;addWidget( lb_mtype,    row,   0, 1, 3 );</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;   <a class="code" href="classUS__RpScan.html#a2cc5331af7602f5efad43f3d3698693d">pltctrlsLayout</a>-&gt;addWidget( <a class="code" href="classUS__RpScan.html#a0da0c2c3b6f65a12f070281c64107665">le_mtype</a>,    row++, 3, 1, 3 );</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;   <a class="code" href="classUS__RpScan.html#a2cc5331af7602f5efad43f3d3698693d">pltctrlsLayout</a>-&gt;addWidget( lb_npoints,  row,   0, 1, 3 );</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;   <a class="code" href="classUS__RpScan.html#a2cc5331af7602f5efad43f3d3698693d">pltctrlsLayout</a>-&gt;addWidget( <a class="code" href="classUS__RpScan.html#a9b4a0f43193cb272897c687058aa9ff8">le_npoints</a>,  row++, 3, 1, 3 );</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;   <a class="code" href="classUS__RpScan.html#a2cc5331af7602f5efad43f3d3698693d">pltctrlsLayout</a>-&gt;addWidget( lb_mdlpar1,  row,   0, 1, 3 );</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;   <a class="code" href="classUS__RpScan.html#a2cc5331af7602f5efad43f3d3698693d">pltctrlsLayout</a>-&gt;addWidget( <a class="code" href="classUS__RpScan.html#ae5e0c0ac7a01b6f858b5081d167ebb3f">le_mdlpar1</a>,  row++, 3, 1, 3 );</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;   <a class="code" href="classUS__RpScan.html#a2cc5331af7602f5efad43f3d3698693d">pltctrlsLayout</a>-&gt;addWidget( lb_mdlpar2,  row,   0, 1, 3 );</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;   <a class="code" href="classUS__RpScan.html#a2cc5331af7602f5efad43f3d3698693d">pltctrlsLayout</a>-&gt;addWidget( <a class="code" href="classUS__RpScan.html#aa70e25c29dd1460ebca43be4031e2318">le_mdlpar2</a>,  row++, 3, 1, 3 );</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;   <a class="code" href="classUS__RpScan.html#a2cc5331af7602f5efad43f3d3698693d">pltctrlsLayout</a>-&gt;addWidget( lb_scnctrls, row++, 0, 1, 6 );</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;   <a class="code" href="classUS__RpScan.html#a2cc5331af7602f5efad43f3d3698693d">pltctrlsLayout</a>-&gt;addWidget( lb_stralpha, row,   0, 1, 3 );</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;   <a class="code" href="classUS__RpScan.html#a2cc5331af7602f5efad43f3d3698693d">pltctrlsLayout</a>-&gt;addWidget( <a class="code" href="classUS__RpScan.html#a192b8f1a258847c542c637541c68e556">ct_stralpha</a>, row++, 3, 1, 3 );</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;   <a class="code" href="classUS__RpScan.html#a2cc5331af7602f5efad43f3d3698693d">pltctrlsLayout</a>-&gt;addWidget( lb_endalpha, row,   0, 1, 3 );</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;   <a class="code" href="classUS__RpScan.html#a2cc5331af7602f5efad43f3d3698693d">pltctrlsLayout</a>-&gt;addWidget( <a class="code" href="classUS__RpScan.html#a5854c74286db65fa1064778e373f9b0b">ct_endalpha</a>, row++, 3, 1, 3 );</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;   <a class="code" href="classUS__RpScan.html#a2cc5331af7602f5efad43f3d3698693d">pltctrlsLayout</a>-&gt;addWidget( lb_incalpha, row,   0, 1, 3 );</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;   <a class="code" href="classUS__RpScan.html#a2cc5331af7602f5efad43f3d3698693d">pltctrlsLayout</a>-&gt;addWidget( <a class="code" href="classUS__RpScan.html#ad409e78d19b7760a0d87d9f2d1218a46">ct_incalpha</a>, row++, 3, 1, 3 );</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;   <a class="code" href="classUS__RpScan.html#a2cc5331af7602f5efad43f3d3698693d">pltctrlsLayout</a>-&gt;addWidget( lb_selalpha, row,   0, 1, 3 );</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;   <a class="code" href="classUS__RpScan.html#a2cc5331af7602f5efad43f3d3698693d">pltctrlsLayout</a>-&gt;addWidget( <a class="code" href="classUS__RpScan.html#aa68675b633ab0db9abb598a0c238186f">le_selalpha</a>, row,   3, 1, 2 );</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;   <a class="code" href="classUS__RpScan.html#a2cc5331af7602f5efad43f3d3698693d">pltctrlsLayout</a>-&gt;addWidget( pb_scan,     row++, 5, 1, 1 );</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;   <a class="code" href="classUS__RpScan.html#a2cc5331af7602f5efad43f3d3698693d">pltctrlsLayout</a>-&gt;addWidget( lb_status,   row,   0, 1, 1 );</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;   <a class="code" href="classUS__RpScan.html#a2cc5331af7602f5efad43f3d3698693d">pltctrlsLayout</a>-&gt;addWidget( <a class="code" href="classUS__RpScan.html#a8f8516724c3481bd843776855f1c9dbf">b_progress</a>,  row++, 1, 1, 5 );</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;   <a class="code" href="classUS__RpScan.html#a2cc5331af7602f5efad43f3d3698693d">pltctrlsLayout</a>-&gt;addWidget( <a class="code" href="classUS__RpScan.html#ae1290674c1816c67b6234caec58ff86a">le_stattext</a>, row++, 0, 1, 6 );</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">//   row         += 7;</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;   QString ctype  = tr( <span class="stringliteral">&quot;Increasing Sigmoid&quot;</span> );</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;   <span class="keywordflow">if</span> ( <a class="code" href="classUS__RpScan.html#aa774aaa46a0d7e44b89fe0e87f679e88">mrec</a>.<a class="code" href="classUS__ModelRecord.html#ac4f1d2a6a363ad4a634d01aa63465ae6">str_y</a> == <a class="code" href="classUS__RpScan.html#aa774aaa46a0d7e44b89fe0e87f679e88">mrec</a>.<a class="code" href="classUS__ModelRecord.html#a014a3f5fe678ce301c304515c31ef869">par1</a> )</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;   {</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      ctype          = <a class="code" href="classUS__RpScan.html#aa774aaa46a0d7e44b89fe0e87f679e88">mrec</a>.<a class="code" href="classUS__ModelRecord.html#ac4f1d2a6a363ad4a634d01aa63465ae6">str_y</a> != <a class="code" href="classUS__RpScan.html#aa774aaa46a0d7e44b89fe0e87f679e88">mrec</a>.<a class="code" href="classUS__ModelRecord.html#a9e28ac7afac09bd3c3feee0714876370">end_y</a> </div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                     ? tr( <span class="stringliteral">&quot;Straight Line&quot;</span> )</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                     : tr( <span class="stringliteral">&quot;Horizontal Line&quot;</span> );</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;   }</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;   <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="classUS__RpScan.html#aa774aaa46a0d7e44b89fe0e87f679e88">mrec</a>.<a class="code" href="classUS__ModelRecord.html#ac4f1d2a6a363ad4a634d01aa63465ae6">str_y</a> &gt; <a class="code" href="classUS__RpScan.html#aa774aaa46a0d7e44b89fe0e87f679e88">mrec</a>.<a class="code" href="classUS__ModelRecord.html#a9e28ac7afac09bd3c3feee0714876370">end_y</a> )</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      ctype          = tr( <span class="stringliteral">&quot;Decreasing Sigmoid&quot;</span> );</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;   <a class="code" href="classUS__RpScan.html#a0da0c2c3b6f65a12f070281c64107665">le_mtype</a>-&gt;setText( ctype );</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;   <a class="code" href="classUS__RpScan.html#a5f0012ac896c1b1341ba18bf77884296">buttonsLayout</a> -&gt;addWidget( pb_help   );</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;   <a class="code" href="classUS__RpScan.html#a5f0012ac896c1b1341ba18bf77884296">buttonsLayout</a> -&gt;addWidget( pb_cancel );</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;   <a class="code" href="classUS__RpScan.html#a5f0012ac896c1b1341ba18bf77884296">buttonsLayout</a> -&gt;addWidget( pb_accept );</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;   <span class="comment">// Complete layouts and set up signals/slots</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;   <a class="code" href="classUS__RpScan.html#a2031ae8ecd7fe5d5e4514c8f66e1050e">plotLayout1</a> = <span class="keyword">new</span> <a class="code" href="classUS__Plot.html">US_Plot</a>( <a class="code" href="classUS__RpScan.html#a4003569cb1acc48bcd6d97bf9aa4f295">data_plot1</a>,</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;         tr( <span class="stringliteral">&quot;Alpha Scan Points&quot;</span> ),</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;         tr( <span class="stringliteral">&quot;Variance (x 1e-5)&quot;</span> ),</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;         tr( <span class="stringliteral">&quot;Norm of X (solute concentrations)&quot;</span> ) );</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;   <a class="code" href="classUS__RpScan.html#a4003569cb1acc48bcd6d97bf9aa4f295">data_plot1</a>-&gt;setCanvasBackground( Qt::black );</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;   <a class="code" href="classUS__RpScan.html#a4003569cb1acc48bcd6d97bf9aa4f295">data_plot1</a>-&gt;setMinimumSize( p1size );</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;   <a class="code" href="classUS__RpScan.html#a4003569cb1acc48bcd6d97bf9aa4f295">data_plot1</a>-&gt;enableAxis( QwtPlot::xBottom, <span class="keyword">true</span> );</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;   <a class="code" href="classUS__RpScan.html#a4003569cb1acc48bcd6d97bf9aa4f295">data_plot1</a>-&gt;enableAxis( QwtPlot::yLeft,   <span class="keyword">true</span> );</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;   <a class="code" href="classUS__RpScan.html#a5d0acb5eb449295ac7399decafc47163">pick</a>          = <span class="keyword">new</span> <a class="code" href="classUS__PlotPicker.html">US_PlotPicker</a>( <a class="code" href="classUS__RpScan.html#a4003569cb1acc48bcd6d97bf9aa4f295">data_plot1</a> );</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;   <a class="code" href="classUS__RpScan.html#a5d0acb5eb449295ac7399decafc47163">pick</a>-&gt;setRubberBand  ( QwtPicker::CrossRubberBand );</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;   <a class="code" href="classUS__RpScan.html#a5d0acb5eb449295ac7399decafc47163">pick</a>-&gt;setMousePattern( QwtEventPattern::MouseSelect1,</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                          Qt::LeftButton );</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;   <a class="code" href="classUS__RpScan.html#abe3980d48229f2b7f39771fb6706dcfd">rightLayout</a>-&gt;addLayout( <a class="code" href="classUS__RpScan.html#a2031ae8ecd7fe5d5e4514c8f66e1050e">plotLayout1</a>    );</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;   <a class="code" href="classUS__RpScan.html#ae124d4a2d18ccbcb2d1b038735058749">leftLayout</a> -&gt;addLayout( <a class="code" href="classUS__RpScan.html#a2cc5331af7602f5efad43f3d3698693d">pltctrlsLayout</a> );</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;   <a class="code" href="classUS__RpScan.html#ae124d4a2d18ccbcb2d1b038735058749">leftLayout</a> -&gt;addStretch();</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;   <a class="code" href="classUS__RpScan.html#ae124d4a2d18ccbcb2d1b038735058749">leftLayout</a> -&gt;addLayout( <a class="code" href="classUS__RpScan.html#a5f0012ac896c1b1341ba18bf77884296">buttonsLayout</a>  );</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;   <a class="code" href="classUS__RpScan.html#af44f9385e0cd14e6ec1856b6b9317c53">mainLayout</a>-&gt;addLayout( <a class="code" href="classUS__RpScan.html#ae124d4a2d18ccbcb2d1b038735058749">leftLayout</a>  );</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;   <a class="code" href="classUS__RpScan.html#af44f9385e0cd14e6ec1856b6b9317c53">mainLayout</a>-&gt;addLayout( <a class="code" href="classUS__RpScan.html#abe3980d48229f2b7f39771fb6706dcfd">rightLayout</a> );</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;   <a class="code" href="classUS__RpScan.html#af44f9385e0cd14e6ec1856b6b9317c53">mainLayout</a>-&gt;setStretchFactor( <a class="code" href="classUS__RpScan.html#ae124d4a2d18ccbcb2d1b038735058749">leftLayout</a>,  3 );</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;   <a class="code" href="classUS__RpScan.html#af44f9385e0cd14e6ec1856b6b9317c53">mainLayout</a>-&gt;setStretchFactor( <a class="code" href="classUS__RpScan.html#abe3980d48229f2b7f39771fb6706dcfd">rightLayout</a>, 5 );</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;   connect( pb_scan,   SIGNAL( clicked()        ),</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            <span class="keyword">this</span>,      SLOT  ( <a class="code" href="classUS__RpScan.html#a1a9f2e5e68b4c6be442a90495232f14f">scan</a>()           ) );</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;   connect( pb_help,   SIGNAL( clicked()        ),</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            <span class="keyword">this</span>,      SLOT  ( <a class="code" href="classUS__RpScan.html#a84191a4a280a20fea531bb489c150c6b">help</a>()           ) );</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;   connect( pb_cancel, SIGNAL( clicked()        ),</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            <span class="keyword">this</span>,      SLOT  ( <a class="code" href="classUS__RpScan.html#a71a5eff72f6ae1fc74329c2613790096">reject_it</a>()      ) );</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;   connect( pb_accept, SIGNAL( clicked()        ),</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            <span class="keyword">this</span>,      SLOT  ( <a class="code" href="classUS__RpScan.html#a8e7101409590eb31842b0dca296ed9f5">accept_it</a>()      ) );</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<a class="code" href="us__loadable__noise_8h.html#a48744322ededb3a6a1d2a410bb4d8bdc">DbgLv</a>(1) &lt;&lt; <span class="stringliteral">&quot;TRP:  p1size&quot;</span> &lt;&lt; p1size;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;   <a class="code" href="classUS__RpScan.html#a4003569cb1acc48bcd6d97bf9aa4f295">data_plot1</a> -&gt;resize( p1size );</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;   <a class="code" href="classUS__RpScan.html#a192b8f1a258847c542c637541c68e556">ct_stralpha</a>-&gt;resize( csizw, rheight );</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;   <a class="code" href="classUS__RpScan.html#a5854c74286db65fa1064778e373f9b0b">ct_endalpha</a>-&gt;resize( csizw, rheight );</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;   <a class="code" href="classUS__RpScan.html#ad409e78d19b7760a0d87d9f2d1218a46">ct_incalpha</a>-&gt;resize( csizw, rheight );</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;   adjustSize();</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<a class="code" href="us__loadable__noise_8h.html#a48744322ededb3a6a1d2a410bb4d8bdc">DbgLv</a>(1) &lt;&lt; <span class="stringliteral">&quot;TRP:   actual csizw&quot;</span> &lt;&lt; <a class="code" href="classUS__RpScan.html#ad409e78d19b7760a0d87d9f2d1218a46">ct_incalpha</a>-&gt;width();</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<a class="code" href="us__loadable__noise_8h.html#a48744322ededb3a6a1d2a410bb4d8bdc">DbgLv</a>(1) &lt;&lt; <span class="stringliteral">&quot;TRP:  mrec.taskx&quot;</span> &lt;&lt; <a class="code" href="classUS__RpScan.html#aa774aaa46a0d7e44b89fe0e87f679e88">mrec</a>.<a class="code" href="classUS__ModelRecord.html#a289f05665308be5bedc658c65d3a4eb7">taskx</a>;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<a class="code" href="us__loadable__noise_8h.html#a48744322ededb3a6a1d2a410bb4d8bdc">DbgLv</a>(1) &lt;&lt; <span class="stringliteral">&quot;TRP:  mrec.str_y&quot;</span> &lt;&lt; <a class="code" href="classUS__RpScan.html#aa774aaa46a0d7e44b89fe0e87f679e88">mrec</a>.<a class="code" href="classUS__ModelRecord.html#ac4f1d2a6a363ad4a634d01aa63465ae6">str_y</a>;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<a class="code" href="us__loadable__noise_8h.html#a48744322ededb3a6a1d2a410bb4d8bdc">DbgLv</a>(1) &lt;&lt; <span class="stringliteral">&quot;TRP:  mrec.end_y&quot;</span> &lt;&lt; <a class="code" href="classUS__RpScan.html#aa774aaa46a0d7e44b89fe0e87f679e88">mrec</a>.<a class="code" href="classUS__ModelRecord.html#a9e28ac7afac09bd3c3feee0714876370">end_y</a>;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<a class="code" href="us__loadable__noise_8h.html#a48744322ededb3a6a1d2a410bb4d8bdc">DbgLv</a>(1) &lt;&lt; <span class="stringliteral">&quot;TRP:  mrec.par1 &quot;</span> &lt;&lt; <a class="code" href="classUS__RpScan.html#aa774aaa46a0d7e44b89fe0e87f679e88">mrec</a>.<a class="code" href="classUS__ModelRecord.html#a014a3f5fe678ce301c304515c31ef869">par1</a>;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<a class="code" href="us__loadable__noise_8h.html#a48744322ededb3a6a1d2a410bb4d8bdc">DbgLv</a>(1) &lt;&lt; <span class="stringliteral">&quot;TRP:  mrec.par2 &quot;</span> &lt;&lt; <a class="code" href="classUS__RpScan.html#aa774aaa46a0d7e44b89fe0e87f679e88">mrec</a>.<a class="code" href="classUS__ModelRecord.html#a6662defffb761058dfb669e0fc2500f3">par2</a>;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<a class="code" href="us__loadable__noise_8h.html#a48744322ededb3a6a1d2a410bb4d8bdc">DbgLv</a>(1) &lt;&lt; <span class="stringliteral">&quot;TRP:  mrec.vari &quot;</span> &lt;&lt; <a class="code" href="classUS__RpScan.html#aa774aaa46a0d7e44b89fe0e87f679e88">mrec</a>.<a class="code" href="classUS__ModelRecord.html#a715cba5b8e7ccfd54bdd9371e69d4f27">variance</a>;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<a class="code" href="us__loadable__noise_8h.html#a48744322ededb3a6a1d2a410bb4d8bdc">DbgLv</a>(1) &lt;&lt; <span class="stringliteral">&quot;TRP:  mrec.rmsd &quot;</span> &lt;&lt; <a class="code" href="classUS__RpScan.html#aa774aaa46a0d7e44b89fe0e87f679e88">mrec</a>.<a class="code" href="classUS__ModelRecord.html#adaf7b69458e385b37a85334724f5cfe0">rmsd</a>;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<a class="code" href="us__loadable__noise_8h.html#a48744322ededb3a6a1d2a410bb4d8bdc">DbgLv</a>(1) &lt;&lt; <span class="stringliteral">&quot;TRP:  mrec.isolutes.size&quot;</span> &lt;&lt; <a class="code" href="classUS__RpScan.html#aa774aaa46a0d7e44b89fe0e87f679e88">mrec</a>.<a class="code" href="classUS__ModelRecord.html#aff3ed3f9bbecc208ac4ce036b948b271">isolutes</a>.size();</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<a class="code" href="us__loadable__noise_8h.html#a48744322ededb3a6a1d2a410bb4d8bdc">DbgLv</a>(1) &lt;&lt; <span class="stringliteral">&quot;TRP:  mrec.csolutes.size&quot;</span> &lt;&lt; <a class="code" href="classUS__RpScan.html#aa774aaa46a0d7e44b89fe0e87f679e88">mrec</a>.<a class="code" href="classUS__ModelRecord.html#a3a86e722c5e27fb6b4616d32d92c2bda">csolutes</a>.size();</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;   qApp-&gt;processEvents();</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;}</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">// Cancel button clicked</span></div><div class="line"><a name="l00197"></a><span class="lineno"><a class="line" href="classUS__RpScan.html#a71a5eff72f6ae1fc74329c2613790096">  197</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classUS__RpScan.html#a71a5eff72f6ae1fc74329c2613790096">US_RpScan::reject_it</a>()</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;{</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;   reject();</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;   close();</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;}</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">// Accept button clicked</span></div><div class="line"><a name="l00204"></a><span class="lineno"><a class="line" href="classUS__RpScan.html#a8e7101409590eb31842b0dca296ed9f5">  204</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classUS__RpScan.html#a8e7101409590eb31842b0dca296ed9f5">US_RpScan::accept_it</a>()</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;{</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;   accept();</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;   <a class="code" href="classUS__RpScan.html#ae82bf6719884cc75eb7a4ec58f30e6b6">alpha</a>       = <a class="code" href="classUS__RpScan.html#aa68675b633ab0db9abb598a0c238186f">le_selalpha</a>-&gt;text().toDouble();</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;   close();</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;}</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">// Scan alphas</span></div><div class="line"><a name="l00212"></a><span class="lineno"><a class="line" href="classUS__RpScan.html#a1a9f2e5e68b4c6be442a90495232f14f">  212</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classUS__RpScan.html#a1a9f2e5e68b4c6be442a90495232f14f">US_RpScan::scan</a>()</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;{</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;   QTime  timer;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;   <span class="keywordtype">int</span>    time_sc;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;   <span class="keywordtype">double</span> calpha = <a class="code" href="classUS__RpScan.html#a192b8f1a258847c542c637541c68e556">ct_stralpha</a>-&gt;value();</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;   <span class="keywordtype">double</span> ealpha = <a class="code" href="classUS__RpScan.html#a5854c74286db65fa1064778e373f9b0b">ct_endalpha</a>-&gt;value();</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;   <span class="keywordtype">double</span> dalpha = <a class="code" href="classUS__RpScan.html#ad409e78d19b7760a0d87d9f2d1218a46">ct_incalpha</a>-&gt;value();</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;   <a class="code" href="classUS__RpScan.html#a2ef4e12c02d8d5571c5c488b1cbf16e8">nalpha</a>        = qRound( ( ealpha - calpha ) / dalpha ) + 1;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;   <a class="code" href="classUS__RpScan.html#af79e844d38dc08f82a1c3516b7701e98">alphas</a>.clear();</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;   <a class="code" href="classUS__RpScan.html#a734363c97b5e23e2a09b803ceb553a47">varias</a>.clear();</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;   <a class="code" href="classUS__RpScan.html#adc3f6bb306e3f3be82c8698a1cba9961">xnorms</a>.clear();</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;   <a class="code" href="classUS__RpScan.html#a8f8516724c3481bd843776855f1c9dbf">b_progress</a>-&gt;reset();</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;   <a class="code" href="classUS__RpScan.html#a8f8516724c3481bd843776855f1c9dbf">b_progress</a>-&gt;setRange( 1, <a class="code" href="classUS__RpScan.html#a2ef4e12c02d8d5571c5c488b1cbf16e8">nalpha</a> );</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;   <span class="keywordtype">double</span> varmx  = 0.0;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;   <span class="keywordtype">double</span> xnomx  = 0.0;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;   <span class="keywordtype">double</span> v_vari = 0.0;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;   <span class="keywordtype">double</span> v_xnsq = 0.0;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;   QApplication::setOverrideCursor( QCursor( Qt::WaitCursor ) );</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;   <a class="code" href="classUS__RpScan.html#ae1290674c1816c67b6234caec58ff86a">le_stattext</a>-&gt;setText( tr( <span class="stringliteral">&quot;Beginning Alpha Scan ...&quot;</span> ) );</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;   timer.start();              <span class="comment">// Start a timer to measure run time</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;   qApp-&gt;processEvents();</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> ja = 0; ja &lt; <a class="code" href="classUS__RpScan.html#a2ef4e12c02d8d5571c5c488b1cbf16e8">nalpha</a>; ja++ )</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;   {  <span class="comment">// Loop to populate alpha scan arrays with preliminary values</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      <a class="code" href="classUS__RpScan.html#af79e844d38dc08f82a1c3516b7701e98">alphas</a> &lt;&lt; calpha;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      <a class="code" href="classUS__RpScan.html#a734363c97b5e23e2a09b803ceb553a47">varias</a> &lt;&lt; v_vari;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      <a class="code" href="classUS__RpScan.html#adc3f6bb306e3f3be82c8698a1cba9961">xnorms</a> &lt;&lt; v_xnsq;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      calpha += dalpha;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;   }</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="keywordtype">int</span> kalpha=<a class="code" href="classUS__RpScan.html#a2ef4e12c02d8d5571c5c488b1cbf16e8">nalpha</a>;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;   <a class="code" href="classUS__RpScan.html#a2ef4e12c02d8d5571c5c488b1cbf16e8">nalpha</a>        = <a class="code" href="classUS__RpScan.html#af79e844d38dc08f82a1c3516b7701e98">alphas</a>.size();</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<a class="code" href="us__loadable__noise_8h.html#a48744322ededb3a6a1d2a410bb4d8bdc">DbgLv</a>(1) &lt;&lt; <span class="stringliteral">&quot;ASC:  nalpha&quot;</span> &lt;&lt; <a class="code" href="classUS__RpScan.html#a2ef4e12c02d8d5571c5c488b1cbf16e8">nalpha</a> &lt;&lt; kalpha &lt;&lt; <span class="stringliteral">&quot;nthr&quot;</span> &lt;&lt; <a class="code" href="classUS__RpScan.html#a0a5da41e1b0ccbbf5ce8cb4e5c64ca14">nthr</a>;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;   <span class="keywordflow">if</span> ( <a class="code" href="classUS__RpScan.html#a0a5da41e1b0ccbbf5ce8cb4e5c64ca14">nthr</a> == 1 )</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;   {  <span class="comment">// Non-multi-threaded scan</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      QVector&lt; double &gt; csolutes;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      <a class="code" href="classUS__RpScan.html#ae974991719882b75383481f1ce7b1d89">sv_nnls_a</a>.clear();</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;      <a class="code" href="classUS__RpScan.html#a737d771410b447b19e34342c474c2fd9">sv_nnls_b</a>.clear();</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      <span class="keywordtype">int</span>    nscans      = <a class="code" href="classUS__RpScan.html#a0dde34f6ebc79614fab5bbe018a9eb07">dsets</a>[ 0 ]-&gt;run_data.scanCount();</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      <span class="keywordtype">int</span>    npoints     = <a class="code" href="classUS__RpScan.html#a0dde34f6ebc79614fab5bbe018a9eb07">dsets</a>[ 0 ]-&gt;run_data.pointCount();</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      <span class="keywordtype">int</span>    nisols      = <a class="code" href="classUS__RpScan.html#aa774aaa46a0d7e44b89fe0e87f679e88">mrec</a>.<a class="code" href="classUS__ModelRecord.html#aff3ed3f9bbecc208ac4ce036b948b271">isolutes</a>.size();</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      <a class="code" href="classUS__RpScan.html#ae1290674c1816c67b6234caec58ff86a">le_stattext</a>-&gt;setText( tr( <span class="stringliteral">&quot;Beginning Single-Thread Alpha Scan ...&quot;</span> ) );</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> ja = 0; ja &lt; <a class="code" href="classUS__RpScan.html#a2ef4e12c02d8d5571c5c488b1cbf16e8">nalpha</a>; ja++ )</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      {  <span class="comment">// Loop to evaluate each alpha in the specified range</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;         calpha             = <a class="code" href="classUS__RpScan.html#af79e844d38dc08f82a1c3516b7701e98">alphas</a>[ ja ];</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;         <span class="keywordflow">if</span> ( ja == 0 )</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;         {  <span class="comment">// For the first one do a full compute and save the A,B matrices</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            <a class="code" href="classUS__SolveSim_1_1Simulation.html">US_SolveSim::Simulation</a> sim_vals;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;            sim_vals.<a class="code" href="classUS__SolveSim_1_1Simulation.html#a1e0b0dbd235fcd66d5662f95d6de7f7d">alpha</a>     = calpha;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            sim_vals.<a class="code" href="classUS__SolveSim_1_1Simulation.html#ad143ba9609b409f6ab271b361f706dd9">noisflag</a>  = 0;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;            sim_vals.<a class="code" href="classUS__SolveSim_1_1Simulation.html#a290878cc7ab24441b3cd4c9e74d2c539">dbg_level</a> = 0;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            sim_vals.<a class="code" href="classUS__SolveSim_1_1Simulation.html#a0ae4082e1e3ef61123332da1a46ed1c9">zsolutes</a>  = <a class="code" href="classUS__RpScan.html#aa774aaa46a0d7e44b89fe0e87f679e88">mrec</a>.<a class="code" href="classUS__ModelRecord.html#aff3ed3f9bbecc208ac4ce036b948b271">isolutes</a>;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            <a class="code" href="classUS__SolveSim.html">US_SolveSim</a>* solvesim = <span class="keyword">new</span> <a class="code" href="classUS__SolveSim.html">US_SolveSim</a>( <a class="code" href="classUS__RpScan.html#a0dde34f6ebc79614fab5bbe018a9eb07">dsets</a>, 0, <span class="keyword">false</span> );</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            solvesim-&gt;<a class="code" href="classUS__SolveSim.html#a9af78c1a2397dc1fa1388cdda0295b72">calc_residuals</a>( 0, 1, sim_vals, <span class="keyword">true</span>,</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                  &amp;<a class="code" href="classUS__RpScan.html#ae974991719882b75383481f1ce7b1d89">sv_nnls_a</a>, &amp;<a class="code" href="classUS__RpScan.html#a737d771410b447b19e34342c474c2fd9">sv_nnls_b</a> );</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            v_vari             = sim_vals.<a class="code" href="classUS__SolveSim_1_1Simulation.html#a07addb810c685c4dad7b2a7b1fde85f7">variance</a>;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            v_xnsq             = sim_vals.<a class="code" href="classUS__SolveSim_1_1Simulation.html#aba1c5681b9f22c5027a75710f8b86364">xnormsq</a>;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;         }</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;         <span class="keywordflow">else</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;         {  <span class="comment">// After 1st, regularize by modifying A matrix diagonal, then NNLS</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            <a class="code" href="classUS__RpScan.html#a775c9ce9f99e9e0bb01f630eba1f3cac">apply_alpha</a>( calpha, &amp;<a class="code" href="classUS__RpScan.html#ae974991719882b75383481f1ce7b1d89">sv_nnls_a</a>, &amp;<a class="code" href="classUS__RpScan.html#a737d771410b447b19e34342c474c2fd9">sv_nnls_b</a>,</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                         nscans, npoints, nisols, v_vari, v_xnsq );</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;         }</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;         <a class="code" href="classUS__RpScan.html#a734363c97b5e23e2a09b803ceb553a47">varias</a>[ ja ]       = v_vari;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;         <a class="code" href="classUS__RpScan.html#adc3f6bb306e3f3be82c8698a1cba9961">xnorms</a>[ ja ]       = v_xnsq;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;         <span class="keywordtype">int</span> kalf           = ja + 1;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;         <a class="code" href="classUS__RpScan.html#a8f8516724c3481bd843776855f1c9dbf">b_progress</a>-&gt;setValue( kalf );</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;         varmx              = qMax( varmx, v_vari );</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;         xnomx              = qMax( xnomx, v_xnsq );</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;         QString astat      = tr( <span class="stringliteral">&quot;Of %1 models, computed %2 (Alpha %3)&quot;</span> )</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            .arg( <a class="code" href="classUS__RpScan.html#a2ef4e12c02d8d5571c5c488b1cbf16e8">nalpha</a> ).arg( kalf ).arg( calpha );</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;         <a class="code" href="classUS__RpScan.html#ae1290674c1816c67b6234caec58ff86a">le_stattext</a>-&gt;setText( astat );</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<a class="code" href="us__loadable__noise_8h.html#a48744322ededb3a6a1d2a410bb4d8bdc">DbgLv</a>(1) &lt;&lt; <span class="stringliteral">&quot;a v x&quot;</span> &lt;&lt; calpha &lt;&lt; v_vari &lt;&lt; v_xnsq;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;         qApp-&gt;processEvents();</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      }</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      <a class="code" href="classUS__RpScan.html#ae974991719882b75383481f1ce7b1d89">sv_nnls_a</a>.clear();</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      <a class="code" href="classUS__RpScan.html#a737d771410b447b19e34342c474c2fd9">sv_nnls_b</a>.clear();</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;   }</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;   {  <span class="comment">// Multi-threaded alpha scan</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      <a class="code" href="classUS__RpScan.html#ae1290674c1816c67b6234caec58ff86a">le_stattext</a>-&gt;setText( tr( <span class="stringliteral">&quot;Beginning %1-Thread Alpha Scan ...&quot;</span> )</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                            .arg( <a class="code" href="classUS__RpScan.html#a0a5da41e1b0ccbbf5ce8cb4e5c64ca14">nthr</a> ) );</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      qApp-&gt;processEvents();</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      <a class="code" href="classUS__RpScan.html#a8f8612f8a30f779893d88039976a7e0f">wthreads</a> .clear();</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      <a class="code" href="classUS__RpScan.html#ae974991719882b75383481f1ce7b1d89">sv_nnls_a</a>.clear();</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      <a class="code" href="classUS__RpScan.html#a737d771410b447b19e34342c474c2fd9">sv_nnls_b</a>.clear();</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      <span class="comment">// Run a complete model computation to get the A,B matrices</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      <a class="code" href="classUS__SolveSim_1_1Simulation.html">US_SolveSim::Simulation</a> sim_vals;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      calpha             = <a class="code" href="classUS__RpScan.html#af79e844d38dc08f82a1c3516b7701e98">alphas</a>[ 0 ];</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      sim_vals.<a class="code" href="classUS__SolveSim_1_1Simulation.html#a1e0b0dbd235fcd66d5662f95d6de7f7d">alpha</a>     = calpha;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      sim_vals.<a class="code" href="classUS__SolveSim_1_1Simulation.html#ad143ba9609b409f6ab271b361f706dd9">noisflag</a>  = 0;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      sim_vals.<a class="code" href="classUS__SolveSim_1_1Simulation.html#a290878cc7ab24441b3cd4c9e74d2c539">dbg_level</a> = 0;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      sim_vals.<a class="code" href="classUS__SolveSim_1_1Simulation.html#a0ae4082e1e3ef61123332da1a46ed1c9">zsolutes</a>  = <a class="code" href="classUS__RpScan.html#aa774aaa46a0d7e44b89fe0e87f679e88">mrec</a>.<a class="code" href="classUS__ModelRecord.html#aff3ed3f9bbecc208ac4ce036b948b271">isolutes</a>;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      <a class="code" href="classUS__SolveSim.html">US_SolveSim</a>* solvesim = <span class="keyword">new</span> <a class="code" href="classUS__SolveSim.html">US_SolveSim</a>( <a class="code" href="classUS__RpScan.html#a0dde34f6ebc79614fab5bbe018a9eb07">dsets</a>, 0, <span class="keyword">false</span> );</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      solvesim-&gt;<a class="code" href="classUS__SolveSim.html#a9af78c1a2397dc1fa1388cdda0295b72">calc_residuals</a>( 0, 1, sim_vals, <span class="keyword">true</span>, &amp;<a class="code" href="classUS__RpScan.html#ae974991719882b75383481f1ce7b1d89">sv_nnls_a</a>, &amp;<a class="code" href="classUS__RpScan.html#a737d771410b447b19e34342c474c2fd9">sv_nnls_b</a> );</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      v_vari        = sim_vals.<a class="code" href="classUS__SolveSim_1_1Simulation.html#a07addb810c685c4dad7b2a7b1fde85f7">variance</a>;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      v_xnsq        = sim_vals.<a class="code" href="classUS__SolveSim_1_1Simulation.html#aba1c5681b9f22c5027a75710f8b86364">xnormsq</a>;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;qDebug() &lt;&lt; <span class="stringliteral">&quot;A0: alpha&quot;</span> &lt;&lt; calpha &lt;&lt; <span class="stringliteral">&quot;vari xnsq&quot;</span> &lt;&lt; v_vari &lt;&lt; v_xnsq</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160; &lt;&lt; <span class="stringliteral">&quot;ncsols&quot;</span> &lt;&lt; sim_vals.<a class="code" href="classUS__SolveSim_1_1Simulation.html#a0ae4082e1e3ef61123332da1a46ed1c9">zsolutes</a>.size();;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      <a class="code" href="classUS__RpScan.html#a734363c97b5e23e2a09b803ceb553a47">varias</a>[ 0 ]   = v_vari;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      <a class="code" href="classUS__RpScan.html#adc3f6bb306e3f3be82c8698a1cba9961">xnorms</a>[ 0 ]   = v_xnsq;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      <a class="code" href="classUS__RpScan.html#ac14f28b852a18d1fcaa662a93ed7f11a">nasubm</a>        = 1;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      <a class="code" href="classUS__RpScan.html#af1913b8e8abf07c102e7276dcd106171">nacomp</a>        = 1;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      QString astat =</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;         tr( <span class="stringliteral">&quot;Of %1 models, %2 done (Alpha %3, thread %4)&quot;</span> )</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;         .arg( <a class="code" href="classUS__RpScan.html#a2ef4e12c02d8d5571c5c488b1cbf16e8">nalpha</a> ).arg( <a class="code" href="classUS__RpScan.html#af1913b8e8abf07c102e7276dcd106171">nacomp</a> ).arg( <a class="code" href="classUS__RpScan.html#af79e844d38dc08f82a1c3516b7701e98">alphas</a>[ 0 ] ).arg( 0 );</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      <a class="code" href="classUS__RpScan.html#ae1290674c1816c67b6234caec58ff86a">le_stattext</a>-&gt;setText( astat );</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      <a class="code" href="classUS__RpScan.html#a8f8516724c3481bd843776855f1c9dbf">b_progress</a>-&gt;setValue( 1 );</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> jt = 0; jt &lt; <a class="code" href="classUS__RpScan.html#a0a5da41e1b0ccbbf5ce8cb4e5c64ca14">nthr</a>; jt++ )</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      {  <span class="comment">// Submit the first tasks using available threads</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;         <a class="code" href="structwork__packet__pc__s.html">WorkPacketPc</a> wtask;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;         calpha               = <a class="code" href="classUS__RpScan.html#af79e844d38dc08f82a1c3516b7701e98">alphas</a>[ jt + 1 ];</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;         <a class="code" href="classUS__SolveSim_1_1Simulation.html">US_SolveSim::Simulation</a> sim_vals;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;         sim_vals.<a class="code" href="classUS__SolveSim_1_1Simulation.html#a1e0b0dbd235fcd66d5662f95d6de7f7d">alpha</a>       = calpha;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;         sim_vals.<a class="code" href="classUS__SolveSim_1_1Simulation.html#ad143ba9609b409f6ab271b361f706dd9">noisflag</a>    = 0;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;         sim_vals.<a class="code" href="classUS__SolveSim_1_1Simulation.html#a290878cc7ab24441b3cd4c9e74d2c539">dbg_level</a>   = qMax( 0, ( <a class="code" href="classUS__RpScan.html#a693c9b87865a3f540f7060bc17904948">dbg_level</a> - 1 ) );</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;         sim_vals.<a class="code" href="classUS__SolveSim_1_1Simulation.html#a0ae4082e1e3ef61123332da1a46ed1c9">zsolutes</a>    = <a class="code" href="classUS__RpScan.html#aa774aaa46a0d7e44b89fe0e87f679e88">mrec</a>.<a class="code" href="classUS__ModelRecord.html#aff3ed3f9bbecc208ac4ce036b948b271">isolutes</a>;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;         wtask.<a class="code" href="structwork__packet__pc__s.html#a8dc482fa50b936b719e83e34f7a9aa0c">thrn</a>           = jt + 1;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;         wtask.<a class="code" href="structwork__packet__pc__s.html#adb49b9c01f6c08bc85c5216cd6c874d9">taskx</a>          = <a class="code" href="classUS__RpScan.html#ac14f28b852a18d1fcaa662a93ed7f11a">nasubm</a>;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;         wtask.<a class="code" href="structwork__packet__pc__s.html#ad473908a6cefed4d48845dbf8f2203d3">str_y</a>          = <a class="code" href="classUS__RpScan.html#aa774aaa46a0d7e44b89fe0e87f679e88">mrec</a>.<a class="code" href="classUS__ModelRecord.html#ac4f1d2a6a363ad4a634d01aa63465ae6">str_y</a>;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;         wtask.<a class="code" href="structwork__packet__pc__s.html#ad5cf7a9a554c08ab44f0f94f152de78a">end_y</a>          = <a class="code" href="classUS__RpScan.html#aa774aaa46a0d7e44b89fe0e87f679e88">mrec</a>.<a class="code" href="classUS__ModelRecord.html#a9e28ac7afac09bd3c3feee0714876370">end_y</a>;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;         wtask.<a class="code" href="structwork__packet__pc__s.html#ad40e9acfd1f5430d5d4fda6e44c165aa">par1</a>           = <a class="code" href="classUS__RpScan.html#aa774aaa46a0d7e44b89fe0e87f679e88">mrec</a>.<a class="code" href="classUS__ModelRecord.html#a014a3f5fe678ce301c304515c31ef869">par1</a>;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;         wtask.<a class="code" href="structwork__packet__pc__s.html#adc4d9caba6b7db9ddb8070fe480231dd">par2</a>           = <a class="code" href="classUS__RpScan.html#aa774aaa46a0d7e44b89fe0e87f679e88">mrec</a>.<a class="code" href="classUS__ModelRecord.html#a6662defffb761058dfb669e0fc2500f3">par2</a>;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;         wtask.<a class="code" href="structwork__packet__pc__s.html#aa3e2f1144f2bd5ae6cffa1f348d0fbb8">sim_vals</a>       = sim_vals;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;         wtask.<a class="code" href="structwork__packet__pc__s.html#abf445fc86dab71781a7867ea8a93a125">isolutes</a>       = sim_vals.<a class="code" href="classUS__SolveSim_1_1Simulation.html#a0ae4082e1e3ef61123332da1a46ed1c9">zsolutes</a>;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;         wtask.<a class="code" href="structwork__packet__pc__s.html#aaca9acf8e1c53c305878ca3eb07e755b">dsets</a>          = <a class="code" href="classUS__RpScan.html#a0dde34f6ebc79614fab5bbe018a9eb07">dsets</a>;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;         wtask.<a class="code" href="structwork__packet__pc__s.html#afefd3a1c312b0cb9b563cdbaf26f9435">depth</a>          = 1;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;         wtask.<a class="code" href="structwork__packet__pc__s.html#a9844322a86d6799d2144e36a4d8a52f6">state</a>          = 0;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;         wtask.<a class="code" href="structwork__packet__pc__s.html#a2d77f80574bbf431561ec15b1ef324c1">noisf</a>          = sim_vals.<a class="code" href="classUS__SolveSim_1_1Simulation.html#ad143ba9609b409f6ab271b361f706dd9">noisflag</a>;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;         wtask.<a class="code" href="structwork__packet__pc__s.html#abb3f63cb1cb28ea077887f11cafb2c25">psv_nnls_a</a>     = &amp;<a class="code" href="classUS__RpScan.html#ae974991719882b75383481f1ce7b1d89">sv_nnls_a</a>;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;         wtask.<a class="code" href="structwork__packet__pc__s.html#addf0e70bb95af80b325d5acc9aece891">psv_nnls_b</a>     = &amp;<a class="code" href="classUS__RpScan.html#a737d771410b447b19e34342c474c2fd9">sv_nnls_b</a>;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;         wtask.<a class="code" href="structwork__packet__pc__s.html#a1a7822b875f556167e51a600f7208e51">csolutes</a>.clear();</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<a class="code" href="us__loadable__noise_8h.html#a48744322ededb3a6a1d2a410bb4d8bdc">DbgLv</a>(1) &lt;&lt; <span class="stringliteral">&quot;ASC:   jt&quot;</span> &lt;&lt; jt &lt;&lt; <span class="stringliteral">&quot;alpha&quot;</span> &lt;&lt; calpha;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;         <a class="code" href="classWorkerThreadPc.html">WorkerThreadPc</a>* wthr   = <span class="keyword">new</span> <a class="code" href="classWorkerThreadPc.html">WorkerThreadPc</a>( <span class="keyword">this</span> );</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;         wthr-&gt;<a class="code" href="classWorkerThreadPc.html#a601321ecaa13f6ab9fa2252146e93a6f">define_work</a>( wtask );</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;         <a class="code" href="classUS__RpScan.html#a8f8612f8a30f779893d88039976a7e0f">wthreads</a> &lt;&lt; wthr;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;         connect( wthr, SIGNAL( work_complete( <a class="code" href="classWorkerThreadPc.html">WorkerThreadPc</a>* ) ),</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                  <span class="keyword">this</span>, SLOT(   <a class="code" href="classUS__RpScan.html#ac72f318abd9b4d446119210270eeb7e1">process_job</a>(   <a class="code" href="classWorkerThreadPc.html">WorkerThreadPc</a>* ) ) );</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;         wthr-&gt;start();</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;         <a class="code" href="classUS__RpScan.html#ac14f28b852a18d1fcaa662a93ed7f11a">nasubm</a>++;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<a class="code" href="us__loadable__noise_8h.html#a48744322ededb3a6a1d2a410bb4d8bdc">DbgLv</a>(1) &lt;&lt; <span class="stringliteral">&quot;ASC:      defined: nasubm&quot;</span> &lt;&lt; <a class="code" href="classUS__RpScan.html#ac14f28b852a18d1fcaa662a93ed7f11a">nasubm</a>;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;         qApp-&gt;processEvents();</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      }</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;      <span class="comment">// Keep testing to see if all tasks are complete</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      <span class="keywordflow">while</span>( <a class="code" href="classUS__RpScan.html#af1913b8e8abf07c102e7276dcd106171">nacomp</a> &lt; <a class="code" href="classUS__RpScan.html#a2ef4e12c02d8d5571c5c488b1cbf16e8">nalpha</a> )</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      {</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;         <a class="code" href="classUS__Sleep.html#afe5bbbbaa8eee77fdaa8ad1a99757a83">US_Sleep::msleep</a>( 500 );</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;         qApp-&gt;processEvents();</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;      }</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      <span class="comment">// Once all threads are done, determine max variance,norm</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> ja = 0; ja &lt; <a class="code" href="classUS__RpScan.html#a2ef4e12c02d8d5571c5c488b1cbf16e8">nalpha</a>; ja++ )</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      {</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;         varmx              = qMax( varmx, <a class="code" href="classUS__RpScan.html#a734363c97b5e23e2a09b803ceb553a47">varias</a>[ ja ] );</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;         xnomx              = qMax( xnomx, <a class="code" href="classUS__RpScan.html#adc3f6bb306e3f3be82c8698a1cba9961">xnorms</a>[ ja ] );</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      }</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      <span class="comment">// Delete worker threads and free saved A,B matrices</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> jt = 0; jt &lt; <a class="code" href="classUS__RpScan.html#a0a5da41e1b0ccbbf5ce8cb4e5c64ca14">nthr</a>; jt++ )</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;         <span class="keyword">delete</span> <a class="code" href="classUS__RpScan.html#a8f8612f8a30f779893d88039976a7e0f">wthreads</a>[ jt ];</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      <a class="code" href="classUS__RpScan.html#ae974991719882b75383481f1ce7b1d89">sv_nnls_a</a>.clear();</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      <a class="code" href="classUS__RpScan.html#a737d771410b447b19e34342c474c2fd9">sv_nnls_b</a>.clear();</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;   }</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;   <a class="code" href="classUS__RpScan.html#ad541ec56537a721fa16634c4fbe15c9d">lgv</a>           = 0  -(int)qFloor( log10( varmx ) );</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;   <a class="code" href="classUS__RpScan.html#ad8851f90a438f6dd5b45774096f44e40">lgx</a>           = -1 -(int)qFloor( log10( xnomx ) );</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;   <a class="code" href="classUS__RpScan.html#a1e316fdba3c4b5a62fa22ccc91208289">vscl</a>          = qPow( 10.0, <a class="code" href="classUS__RpScan.html#ad541ec56537a721fa16634c4fbe15c9d">lgv</a> );</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;   <a class="code" href="classUS__RpScan.html#a319f2fabd47c9d5aafded392ed8a9403">xscl</a>          = qPow( 10.0, <a class="code" href="classUS__RpScan.html#ad8851f90a438f6dd5b45774096f44e40">lgx</a> );</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<a class="code" href="us__loadable__noise_8h.html#a48744322ededb3a6a1d2a410bb4d8bdc">DbgLv</a>(1) &lt;&lt; <span class="stringliteral">&quot;Log-varia Log-xnorm&quot;</span> &lt;&lt; <a class="code" href="classUS__RpScan.html#ad541ec56537a721fa16634c4fbe15c9d">lgv</a> &lt;&lt; <a class="code" href="classUS__RpScan.html#ad8851f90a438f6dd5b45774096f44e40">lgx</a> &lt;&lt; <span class="stringliteral">&quot;vscl xscl&quot;</span> &lt;&lt; <a class="code" href="classUS__RpScan.html#a1e316fdba3c4b5a62fa22ccc91208289">vscl</a> &lt;&lt; <a class="code" href="classUS__RpScan.html#a319f2fabd47c9d5aafded392ed8a9403">xscl</a>;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> ja = 0; ja &lt; <a class="code" href="classUS__RpScan.html#a2ef4e12c02d8d5571c5c488b1cbf16e8">nalpha</a>; ja++ )</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;   {  <span class="comment">// Scale the variance,normsq points</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;      <a class="code" href="classUS__RpScan.html#a734363c97b5e23e2a09b803ceb553a47">varias</a>[ ja ] *= <a class="code" href="classUS__RpScan.html#a1e316fdba3c4b5a62fa22ccc91208289">vscl</a>;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      <a class="code" href="classUS__RpScan.html#adc3f6bb306e3f3be82c8698a1cba9961">xnorms</a>[ ja ] *= <a class="code" href="classUS__RpScan.html#a319f2fabd47c9d5aafded392ed8a9403">xscl</a>;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;   }</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;   <a class="code" href="classUS__RpScan.html#a8f8516724c3481bd843776855f1c9dbf">b_progress</a>-&gt;setValue( <a class="code" href="classUS__RpScan.html#a2ef4e12c02d8d5571c5c488b1cbf16e8">nalpha</a> );</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;   QApplication::restoreOverrideCursor();</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;   qApp-&gt;processEvents();</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;   <span class="comment">// Determine elapsed time</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;   time_sc    = timer.elapsed();</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;   <span class="keywordtype">int</span> ktimes = ( time_sc + 500 ) / 1000;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;   <span class="keywordtype">int</span> ktimeh = ktimes / 3600;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;   <span class="keywordtype">int</span> ktimem = ( ktimes - ktimeh * 3600 ) / 60;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;   ktimes     = ktimes - ktimeh * 3600 - ktimem * 60;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;   <span class="comment">// Compose and display completed-scan status message</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;   QString astat = tr( <span class="stringliteral">&quot;%1 alphas evaluated in&quot;</span> ).arg( <a class="code" href="classUS__RpScan.html#a2ef4e12c02d8d5571c5c488b1cbf16e8">nalpha</a> );</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;   <span class="keywordflow">if</span> ( ktimeh &gt; 0 )</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      astat     += tr( <span class="stringliteral">&quot; %1 hr., %2 min., %3 sec.&quot;</span> )</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;         .arg( ktimeh ).arg( ktimem ).arg( ktimes );</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      astat     += tr( <span class="stringliteral">&quot; %1 min., %2 sec.&quot;</span> ).arg( ktimem ).arg( ktimes );</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;   astat     += tr( <span class="stringliteral">&quot;, in %1 threads&quot;</span> ).arg( <a class="code" href="classUS__RpScan.html#a0a5da41e1b0ccbbf5ce8cb4e5c64ca14">nthr</a> );</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;   <a class="code" href="classUS__RpScan.html#ae1290674c1816c67b6234caec58ff86a">le_stattext</a>-&gt;setText( astat );</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;   qApp-&gt;processEvents();</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;   <a class="code" href="classUS__RpScan.html#a0a4515d4cf1fe7096741c7977864ab2d">plot_data</a>();</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;}</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">// Plot the data</span></div><div class="line"><a name="l00438"></a><span class="lineno"><a class="line" href="classUS__RpScan.html#a0a4515d4cf1fe7096741c7977864ab2d">  438</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classUS__RpScan.html#a0a4515d4cf1fe7096741c7977864ab2d">US_RpScan::plot_data</a>()</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;{</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;   <a class="code" href="us__gui__util_8h.html#a3f4a96754578df9a5970e7a9b09bd8f1">dataPlotClear</a>( <a class="code" href="classUS__RpScan.html#a4003569cb1acc48bcd6d97bf9aa4f295">data_plot1</a> );</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;   <span class="keywordflow">if</span> ( <a class="code" href="classUS__RpScan.html#a2ef4e12c02d8d5571c5c488b1cbf16e8">nalpha</a> &gt; 1 )</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;   {</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      <span class="keywordtype">int</span>    je     = <a class="code" href="classUS__RpScan.html#a2ef4e12c02d8d5571c5c488b1cbf16e8">nalpha</a> - 1;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      <span class="keywordtype">double</span> ainc   = <a class="code" href="classUS__RpScan.html#af79e844d38dc08f82a1c3516b7701e98">alphas</a>[ 1 ] - <a class="code" href="classUS__RpScan.html#af79e844d38dc08f82a1c3516b7701e98">alphas</a>[ 0 ];</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;      <a class="code" href="classUS__RpScan.html#a4003569cb1acc48bcd6d97bf9aa4f295">data_plot1</a>-&gt;setTitle(</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;            tr( <span class="stringliteral">&quot;Alpha Scan Points\nAlphas from %1 to %2 by %3&quot;</span> )</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;            .arg( <a class="code" href="classUS__RpScan.html#af79e844d38dc08f82a1c3516b7701e98">alphas</a>[ 0 ] ).arg( <a class="code" href="classUS__RpScan.html#af79e844d38dc08f82a1c3516b7701e98">alphas</a>[ je ] ).arg( ainc ) );</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;   }</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;   <span class="keywordflow">else</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;   {</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      <a class="code" href="classUS__RpScan.html#a4003569cb1acc48bcd6d97bf9aa4f295">data_plot1</a>-&gt;setTitle( tr( <span class="stringliteral">&quot;Alpha Scan Points&quot;</span> ) );</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;   }</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;   <a class="code" href="classUS__RpScan.html#a4003569cb1acc48bcd6d97bf9aa4f295">data_plot1</a>-&gt;setAxisTitle( QwtPlot::xBottom,</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;         tr( <span class="stringliteral">&quot;Variance (x 1e%1)&quot;</span> ).arg( <a class="code" href="classUS__RpScan.html#ad541ec56537a721fa16634c4fbe15c9d">lgv</a> ) ),</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;   <a class="code" href="classUS__RpScan.html#a4003569cb1acc48bcd6d97bf9aa4f295">data_plot1</a>-&gt;setAxisTitle( QwtPlot::yLeft,</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;         ( <a class="code" href="classUS__RpScan.html#ad8851f90a438f6dd5b45774096f44e40">lgx</a> == 0 ) ?</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;         tr( <span class="stringliteral">&quot;Norm of X (solute concentrations)&quot;</span> ) :</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;         tr( <span class="stringliteral">&quot;Norm of X (solute concentrations x 1e%1)&quot;</span> ).arg( <a class="code" href="classUS__RpScan.html#ad8851f90a438f6dd5b45774096f44e40">lgx</a> ) );</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;   <a class="code" href="classUS__RpScan.html#a5e55d588278713b388532d5f0075dc68">grid</a>          = <a class="code" href="classUS__WidgetsDialog.html#a929072f81802a01b5676e92e18fb0447">us_grid</a>( <a class="code" href="classUS__RpScan.html#a4003569cb1acc48bcd6d97bf9aa4f295">data_plot1</a> );</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;   QwtPlotCurve* curvln;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;   QwtPlotCurve* curvpt;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;   <span class="keywordtype">double</span>* xx    = <a class="code" href="classUS__RpScan.html#a734363c97b5e23e2a09b803ceb553a47">varias</a>.data();</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;   <span class="keywordtype">double</span>* yy    = <a class="code" href="classUS__RpScan.html#adc3f6bb306e3f3be82c8698a1cba9961">xnorms</a>.data();</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;   QPen    pen_plot( <a class="code" href="classUS__GuiSettings.html#a9bc386c32fb0f28ed71e8cb780371e9b">US_GuiSettings::plotCurve</a>(), 1 );</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;   <span class="comment">// Draw the variance,xnorm line</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;   curvln        = <a class="code" href="classUS__WidgetsDialog.html#a92c176cd1696a73581ffffad32651392">us_curve</a>( <a class="code" href="classUS__RpScan.html#a4003569cb1acc48bcd6d97bf9aa4f295">data_plot1</a>, tr( <span class="stringliteral">&quot;Curve V-X&quot;</span> ) );</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;   curvln-&gt;setPen    ( pen_plot );</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;   curvln-&gt;setSamples( xx, yy, <a class="code" href="classUS__RpScan.html#a2ef4e12c02d8d5571c5c488b1cbf16e8">nalpha</a> );</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;   <span class="comment">// Show the variance,xnorm points</span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;   curvpt        = <a class="code" href="classUS__WidgetsDialog.html#a92c176cd1696a73581ffffad32651392">us_curve</a>( <a class="code" href="classUS__RpScan.html#a4003569cb1acc48bcd6d97bf9aa4f295">data_plot1</a>, tr( <span class="stringliteral">&quot;Alpha Points&quot;</span> ) );</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;   QwtSymbol* sym = <span class="keyword">new</span> QwtSymbol;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;   sym-&gt;setStyle( QwtSymbol::Ellipse );</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;   sym-&gt;setPen  ( QPen( Qt::blue ) );</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;   sym-&gt;setBrush( QBrush( Qt::white ) );</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;   sym-&gt;setSize ( 8 );</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;   curvpt-&gt;setStyle  ( QwtPlotCurve::NoCurve );</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;   curvpt-&gt;setSymbol ( sym );</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;   curvpt-&gt;setSamples( xx, yy, <a class="code" href="classUS__RpScan.html#a2ef4e12c02d8d5571c5c488b1cbf16e8">nalpha</a> );</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;   <span class="comment">// Compute and show lines that hint at the elbow point of the curve</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;   <span class="keywordflow">if</span> ( <a class="code" href="classUS__RpScan.html#a2ef4e12c02d8d5571c5c488b1cbf16e8">nalpha</a> &gt; 6 )</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;   {</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;      <span class="keywordtype">double</span>  xh[ 2 ];</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      <span class="keywordtype">double</span>  yh[ 2 ];</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;      <span class="keywordtype">double</span>  xa[ 5 ];</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;      <span class="keywordtype">double</span>  ya[ 5 ];</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;      <span class="keywordtype">double</span>* xe = (<span class="keywordtype">double</span>*)xa;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;      <span class="keywordtype">double</span>* ye = (<span class="keywordtype">double</span>*)ya;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;      QwtPlotCurve* curvh1;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;      QwtPlotCurve* curvh2;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      QwtPlotCurve* curvh3;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;      <span class="keywordtype">double</span>  slope; <span class="keywordtype">double</span> slop2;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;      <span class="keywordtype">double</span>  intcp; <span class="keywordtype">double</span> intc2;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;      <span class="keywordtype">double</span>  sigma; <span class="keywordtype">double</span>  corre;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;      <span class="keywordtype">double</span>  xl1p1; <span class="keywordtype">double</span> xl1p2; <span class="keywordtype">double</span> yl1p1; <span class="keywordtype">double</span> yl1p2;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;      <span class="keywordtype">double</span>  xl2p1; <span class="keywordtype">double</span> xl2p2; <span class="keywordtype">double</span> yl2p1; <span class="keywordtype">double</span> yl2p2;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      <span class="keywordtype">double</span>  xl3p1; <span class="keywordtype">double</span> xl3p2; <span class="keywordtype">double</span> yl3p1; <span class="keywordtype">double</span> yl3p2;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;      QPen    pen_red ( Qt::red,  0, Qt::DashLine );</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      QPen    pen_cyan( Qt::cyan, 0, Qt::DashLine );</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;      <span class="comment">// Compute a line fitted to the first few main curve points</span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      <span class="keywordtype">int</span>  nlp  = 5;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;      <span class="keywordflow">while</span> ( nlp &lt; <a class="code" href="classUS__RpScan.html#a2ef4e12c02d8d5571c5c488b1cbf16e8">nalpha</a> )</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;      {</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;         <span class="keywordtype">double</span> avg  = <a class="code" href="classUS__Math2.html#a2c6a484e0b2c11ba23e657e42141009f">US_Math2::linefit</a>( &amp;xx, &amp;yy, &amp;slope, &amp;intcp,</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                                          &amp;sigma, &amp;corre, nlp );</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<a class="code" href="us__loadable__noise_8h.html#a48744322ededb3a6a1d2a410bb4d8bdc">DbgLv</a>(1) &lt;&lt; <span class="stringliteral">&quot;TRP:H1:  avg&quot;</span> &lt;&lt; avg &lt;&lt; <span class="stringliteral">&quot;nlp&quot;</span> &lt;&lt; nlp;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<a class="code" href="us__loadable__noise_8h.html#a48744322ededb3a6a1d2a410bb4d8bdc">DbgLv</a>(1) &lt;&lt; <span class="stringliteral">&quot;TRP:H1:   sl&quot;</span> &lt;&lt; slope &lt;&lt; <span class="stringliteral">&quot;in&quot;</span> &lt;&lt; intcp &lt;&lt; <span class="stringliteral">&quot;sg&quot;</span> &lt;&lt; sigma</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;   &lt;&lt; <span class="stringliteral">&quot;co&quot;</span> &lt;&lt; corre;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;         <span class="keywordflow">if</span> ( slope &lt; 1e99  &amp;&amp;  slope &gt; (-1e99) )</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;         nlp      += 2;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;      }</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<a class="code" href="us__loadable__noise_8h.html#a48744322ededb3a6a1d2a410bb4d8bdc">DbgLv</a>(1) &lt;&lt; <span class="stringliteral">&quot;TRP:H1:  intcp slope&quot;</span> &lt;&lt; intcp &lt;&lt; slope;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;      yl1p1     = yy[ 0 ];</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;      xl1p1     = ( slope == 0.0 ) ? xx[ 0 ] : ( yl1p1 - intcp ) / slope;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;      yl1p2     = yy[ <a class="code" href="classUS__RpScan.html#a2ef4e12c02d8d5571c5c488b1cbf16e8">nalpha</a> - 5 ];</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;      xl1p2     = ( slope == 0.0 ) ? xl1p1 : ( yl1p2 - intcp ) / slope;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<a class="code" href="us__loadable__noise_8h.html#a48744322ededb3a6a1d2a410bb4d8bdc">DbgLv</a>(1) &lt;&lt; <span class="stringliteral">&quot;TRP:H1:   l1: x1,y1,x2,y2&quot;</span> &lt;&lt; xl1p1 &lt;&lt; yl1p1 &lt;&lt; xl1p2 &lt;&lt; yl1p2;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;      <span class="comment">// Compute a line fitted to the last few main curve points</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;      <span class="keywordtype">int</span> je    = <a class="code" href="classUS__RpScan.html#a2ef4e12c02d8d5571c5c488b1cbf16e8">nalpha</a> - 1;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> jj = 0; jj &lt; 5; jj++, je-- )</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;      {</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;         xe[ jj ]  = xx[ je ];</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;         ye[ jj ]  = yy[ je ];</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<a class="code" href="us__loadable__noise_8h.html#a48744322ededb3a6a1d2a410bb4d8bdc">DbgLv</a>(1) &lt;&lt; <span class="stringliteral">&quot;TRP:H2: jj x y&quot;</span> &lt;&lt; jj &lt;&lt; xe[jj] &lt;&lt; ye[jj] &lt;&lt; <span class="stringliteral">&quot;je&quot;</span> &lt;&lt; je;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;      }</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;      <a class="code" href="classUS__Math2.html#a2c6a484e0b2c11ba23e657e42141009f">US_Math2::linefit</a>( &amp;xe, &amp;ye, &amp;slop2, &amp;intc2, &amp;sigma, &amp;corre, 5 );</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<a class="code" href="us__loadable__noise_8h.html#a48744322ededb3a6a1d2a410bb4d8bdc">DbgLv</a>(1) &lt;&lt; <span class="stringliteral">&quot;TRP:H2:  intcp slope&quot;</span> &lt;&lt; intc2 &lt;&lt; slop2;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;      xl2p1     = xe[ 0 ];</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;      yl2p1     = slop2 * xl2p1 + intc2;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;      xl2p2     = xx[ 4 ];</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;      yl2p2     = slop2 * xl2p2 + intc2;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<a class="code" href="us__loadable__noise_8h.html#a48744322ededb3a6a1d2a410bb4d8bdc">DbgLv</a>(1) &lt;&lt; <span class="stringliteral">&quot;TRP:H2:   l2: x1,y1,x2,y2&quot;</span> &lt;&lt; xl2p1 &lt;&lt; yl2p1 &lt;&lt; xl2p2 &lt;&lt; yl2p2;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;      <span class="comment">// Find the intersection point for the 2 fitted lines</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;      <a class="code" href="classUS__Math2.html#aa1ef9a25186985c8f9ab2d3a17c6d058">US_Math2::intersect</a>( slope, intcp, slop2, intc2, &amp;xl3p1, &amp;yl3p1 );</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<a class="code" href="us__loadable__noise_8h.html#a48744322ededb3a6a1d2a410bb4d8bdc">DbgLv</a>(1) &lt;&lt; <span class="stringliteral">&quot;TRP:H3:   l3: x1,y1&quot;</span> &lt;&lt; xl3p1 &lt;&lt; yl3p1;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;      <span class="comment">// Find the curve point nearest to the intersection point;</span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;      <span class="comment">//  then compute a line from intersection to nearest curve point.</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;      <a class="code" href="classUS__Math2.html#ac9887709fd5d15d23369c7289d1a5ae1">US_Math2::nearest_curve_point</a>( xx, yy, <a class="code" href="classUS__RpScan.html#a2ef4e12c02d8d5571c5c488b1cbf16e8">nalpha</a>, <span class="keyword">true</span>, xl3p1, yl3p1,</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;            &amp;xl3p2, &amp;yl3p2, <a class="code" href="classUS__RpScan.html#af79e844d38dc08f82a1c3516b7701e98">alphas</a>.data(), &amp;<a class="code" href="classUS__RpScan.html#ae82bf6719884cc75eb7a4ec58f30e6b6">alpha</a> );</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;      <span class="comment">// Do a sanity check. If the intersection point is outside the</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;      <span class="comment">// rectangle that encloses the curve, we likely have an aberrant curve.</span></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;      <span class="comment">// So, skip plotting hint lines that are probably just confusing.</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;      <span class="keywordtype">double</span> xcvp1  = xx[ 0 ];</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;      <span class="keywordtype">double</span> ycvp1  = yy[ 0 ];</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;      <span class="keywordtype">double</span> xcvp2  = xx[ je ];</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;      <span class="keywordtype">double</span> ycvp2  = yy[ je ];</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;      <span class="keywordtype">bool</span> do_plot  = ( xl3p1 &gt;= xcvp1  &amp;&amp;  yl3p1 &lt;= ycvp1  &amp;&amp;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                        xl3p1 &lt;= xcvp2  &amp;&amp;  yl3p1 &gt;= ycvp2 );</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<a class="code" href="us__loadable__noise_8h.html#a48744322ededb3a6a1d2a410bb4d8bdc">DbgLv</a>(1) &lt;&lt; <span class="stringliteral">&quot;TRP:T4:   cv: x1,y1&quot;</span> &lt;&lt; xcvp1 &lt;&lt; ycvp1</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160; &lt;&lt; <span class="stringliteral">&quot;x2,y2&quot;</span> &lt;&lt; xcvp2 &lt;&lt; ycvp2 &lt;&lt; <span class="stringliteral">&quot; do_plot&quot;</span> &lt;&lt; do_plot;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;      <span class="keywordflow">if</span> ( do_plot )</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;      {</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;         <span class="comment">// Plot the alpha hint lines</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;         curvh1        = <a class="code" href="classUS__WidgetsDialog.html#a92c176cd1696a73581ffffad32651392">us_curve</a>( <a class="code" href="classUS__RpScan.html#a4003569cb1acc48bcd6d97bf9aa4f295">data_plot1</a>, tr( <span class="stringliteral">&quot;Curve Hint 1&quot;</span> ) );</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;         curvh1-&gt;setPen( pen_red );</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;         xh[ 0 ]   = xl1p1;    <span class="comment">// Line fitted to first few points</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;         yh[ 0 ]   = yl1p1;</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;         xh[ 1 ]   = xl3p1;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;         yh[ 1 ]   = yl3p1;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;         curvh1-&gt;setSamples( xh, yh, 2 );</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;         curvh2        = <a class="code" href="classUS__WidgetsDialog.html#a92c176cd1696a73581ffffad32651392">us_curve</a>( <a class="code" href="classUS__RpScan.html#a4003569cb1acc48bcd6d97bf9aa4f295">data_plot1</a>, tr( <span class="stringliteral">&quot;Curve Hint 2&quot;</span> ) );</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;         curvh2-&gt;setPen( pen_red );</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;         xh[ 0 ]   = xl2p1;    <span class="comment">// Line fitted to last few points</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;         yh[ 0 ]   = yl2p1;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;         xh[ 1 ]   = xl3p1;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;         yh[ 1 ]   = yl3p1;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;         curvh2-&gt;setSamples( xh, yh, 2 );</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;         curvh3        = <a class="code" href="classUS__WidgetsDialog.html#a92c176cd1696a73581ffffad32651392">us_curve</a>( <a class="code" href="classUS__RpScan.html#a4003569cb1acc48bcd6d97bf9aa4f295">data_plot1</a>, tr( <span class="stringliteral">&quot;Curve Hint 3&quot;</span> ) );</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;         curvh3-&gt;setPen( pen_cyan );</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;         xh[ 0 ]   = xl3p1;    <span class="comment">// Line between hint intersection and main curve</span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;         yh[ 0 ]   = yl3p1;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;         xh[ 1 ]   = xl3p2;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;         yh[ 1 ]   = yl3p2;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<a class="code" href="us__loadable__noise_8h.html#a48744322ededb3a6a1d2a410bb4d8bdc">DbgLv</a>(1) &lt;&lt; <span class="stringliteral">&quot;TRP:H3: x1,y1,x2,y2&quot;</span> &lt;&lt; xl3p1 &lt;&lt; yl3p1 &lt;&lt; yl3p2 &lt;&lt; yl3p2;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;         curvh3-&gt;setSamples( xh, yh, 2 );</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;      }</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;      <span class="keywordflow">else</span>   <span class="comment">// If no good intersection point, default the half-way alpha</span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;         <a class="code" href="classUS__RpScan.html#ae82bf6719884cc75eb7a4ec58f30e6b6">alpha</a>     = <a class="code" href="classUS__RpScan.html#af79e844d38dc08f82a1c3516b7701e98">alphas</a>[ <a class="code" href="classUS__RpScan.html#a2ef4e12c02d8d5571c5c488b1cbf16e8">nalpha</a> / 2 ];</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;      <span class="comment">// Use nearest curve point for default alpha</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;      <a class="code" href="classUS__RpScan.html#aa68675b633ab0db9abb598a0c238186f">le_selalpha</a>-&gt;setText( QString().sprintf( <span class="stringliteral">&quot;%.3f&quot;</span>, <a class="code" href="classUS__RpScan.html#ae82bf6719884cc75eb7a4ec58f30e6b6">alpha</a> ) );</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;   }</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;   connect( <a class="code" href="classUS__RpScan.html#a5d0acb5eb449295ac7399decafc47163">pick</a>, SIGNAL( cMouseUp( <span class="keyword">const</span> QwtDoublePoint&amp; ) ),</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;            <span class="keyword">this</span>, SLOT  ( <a class="code" href="classUS__RpScan.html#ac9916ed83ee043a2332dca629cec0f8c">mouse</a>   ( <span class="keyword">const</span> QwtDoublePoint&amp; ) ) );</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;   <a class="code" href="classUS__RpScan.html#a4003569cb1acc48bcd6d97bf9aa4f295">data_plot1</a>-&gt;replot();</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;}</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="comment">// Handle a mouse click near to a curve point location</span></div><div class="line"><a name="l00611"></a><span class="lineno"><a class="line" href="classUS__RpScan.html#ac9916ed83ee043a2332dca629cec0f8c">  611</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classUS__RpScan.html#ac9916ed83ee043a2332dca629cec0f8c">US_RpScan::mouse</a>( <span class="keyword">const</span> QwtDoublePoint&amp; <a class="code" href="namespaceUS__WinData.html#a85f3cb45f5a36707c5fc56eea6821d55">p</a> )</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;{</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;   <span class="keywordtype">double</span> xloc    = <a class="code" href="namespaceUS__WinData.html#a85f3cb45f5a36707c5fc56eea6821d55">p</a>.x();</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;   <span class="keywordtype">double</span> yloc    = <a class="code" href="namespaceUS__WinData.html#a85f3cb45f5a36707c5fc56eea6821d55">p</a>.y();</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;   <span class="keywordtype">double</span> xcurv;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;   <span class="keywordtype">double</span> ycurv;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;   <span class="keywordtype">double</span> xlabl;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;   <span class="keywordtype">double</span> ylabl;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;   <a class="code" href="classUS__Math2.html#ac9887709fd5d15d23369c7289d1a5ae1">US_Math2::nearest_curve_point</a>( <a class="code" href="classUS__RpScan.html#a734363c97b5e23e2a09b803ceb553a47">varias</a>.data(), <a class="code" href="classUS__RpScan.html#adc3f6bb306e3f3be82c8698a1cba9961">xnorms</a>.data(), <a class="code" href="classUS__RpScan.html#a2ef4e12c02d8d5571c5c488b1cbf16e8">nalpha</a>, <span class="keyword">true</span>,</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;         xloc, yloc, &amp;xcurv, &amp;ycurv, <a class="code" href="classUS__RpScan.html#af79e844d38dc08f82a1c3516b7701e98">alphas</a>.data(), &amp;<a class="code" href="classUS__RpScan.html#ae82bf6719884cc75eb7a4ec58f30e6b6">alpha</a> );</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;   <a class="code" href="classUS__RpScan.html#ae82bf6719884cc75eb7a4ec58f30e6b6">alpha</a>          = (double)qRound( <a class="code" href="classUS__RpScan.html#ae82bf6719884cc75eb7a4ec58f30e6b6">alpha</a> * 1000.0 ) / 1000.0;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;   QString salpha = QString().sprintf( <span class="stringliteral">&quot;%.3f&quot;</span>, <a class="code" href="classUS__RpScan.html#ae82bf6719884cc75eb7a4ec58f30e6b6">alpha</a> );</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;   <a class="code" href="classUS__RpScan.html#aa68675b633ab0db9abb598a0c238186f">le_selalpha</a>-&gt;setText( salpha );</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;   <span class="comment">// Mark selected curve point and give it a label</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;   xlabl          = xcurv + qAbs( <a class="code" href="classUS__RpScan.html#a734363c97b5e23e2a09b803ceb553a47">varias</a>[ 0 ] - <a class="code" href="classUS__RpScan.html#a734363c97b5e23e2a09b803ceb553a47">varias</a>[ <a class="code" href="classUS__RpScan.html#a2ef4e12c02d8d5571c5c488b1cbf16e8">nalpha</a> - 1 ] ) / 10.0;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;   ylabl          = ycurv + qAbs( <a class="code" href="classUS__RpScan.html#adc3f6bb306e3f3be82c8698a1cba9961">xnorms</a>[ 0 ] - <a class="code" href="classUS__RpScan.html#adc3f6bb306e3f3be82c8698a1cba9961">xnorms</a>[ <a class="code" href="classUS__RpScan.html#a2ef4e12c02d8d5571c5c488b1cbf16e8">nalpha</a> - 1 ] ) / 10.0;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;   <a class="code" href="classUS__RpScan.html#a4003569cb1acc48bcd6d97bf9aa4f295">data_plot1</a>-&gt;detachItems( QwtPlotItem::Rtti_PlotMarker );</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;   QwtPlotMarker* msymbo = <span class="keyword">new</span> QwtPlotMarker;</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;   QBrush sbrush( Qt::cyan );</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;   QPen   spen  ( sbrush, 2.0 );</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;   QwtSymbol* sym = <span class="keyword">new</span> QwtSymbol( QwtSymbol::Cross, sbrush, spen, QSize( 8, 8 ) );</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;   msymbo-&gt;setValue( xcurv, ycurv );</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;   msymbo-&gt;setSymbol( sym );</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;   msymbo-&gt;attach  ( <a class="code" href="classUS__RpScan.html#a4003569cb1acc48bcd6d97bf9aa4f295">data_plot1</a> );</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;   QwtPlotMarker* <a class="code" href="classUS__RpScan.html#a29aa41656a6dbcad59eab37ca922048d">marker</a> = <span class="keyword">new</span> QwtPlotMarker;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;   QwtText label;</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;   label.setText ( salpha );</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;   label.setColor( Qt::cyan );</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;   <a class="code" href="classUS__RpScan.html#a29aa41656a6dbcad59eab37ca922048d">marker</a>-&gt;setValue( xlabl, ylabl );</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;   <a class="code" href="classUS__RpScan.html#a29aa41656a6dbcad59eab37ca922048d">marker</a>-&gt;setLabel( label );</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;   <a class="code" href="classUS__RpScan.html#a29aa41656a6dbcad59eab37ca922048d">marker</a>-&gt;setLabelAlignment( Qt::AlignHCenter | Qt::AlignVCenter );</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;   <a class="code" href="classUS__RpScan.html#a29aa41656a6dbcad59eab37ca922048d">marker</a>-&gt;attach  ( <a class="code" href="classUS__RpScan.html#a4003569cb1acc48bcd6d97bf9aa4f295">data_plot1</a> );</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;   <a class="code" href="classUS__RpScan.html#a4003569cb1acc48bcd6d97bf9aa4f295">data_plot1</a>-&gt;replot();</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;}</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;</div><div class="line"><a name="l00651"></a><span class="lineno"><a class="line" href="classUS__RpScan.html#ac72f318abd9b4d446119210270eeb7e1">  651</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classUS__RpScan.html#ac72f318abd9b4d446119210270eeb7e1">US_RpScan::process_job</a>( <a class="code" href="classWorkerThreadPc.html">WorkerThreadPc</a>* wthrd )</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;{</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<a class="code" href="us__loadable__noise_8h.html#a48744322ededb3a6a1d2a410bb4d8bdc">DbgLv</a>(1) &lt;&lt; <span class="stringliteral">&quot;SCPJ: IN&quot;</span>;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;   <a class="code" href="structwork__packet__pc__s.html">WorkPacketPc</a> wresult;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;   <a class="code" href="classUS__RpScan.html#af1913b8e8abf07c102e7276dcd106171">nacomp</a>++;                            <span class="comment">// Bump alphas-complete count</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;   <a class="code" href="classUS__RpScan.html#a8f8516724c3481bd843776855f1c9dbf">b_progress</a>-&gt;setValue( <a class="code" href="classUS__RpScan.html#af1913b8e8abf07c102e7276dcd106171">nacomp</a> );</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;   wthrd-&gt;<a class="code" href="classWorkerThreadPc.html#a7b896df1f9497a2743bfce6492a585a9">get_result</a>( wresult );        <span class="comment">// Get results of thread task</span></div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;   <span class="keywordtype">int</span>    thrn     = wresult.<a class="code" href="structwork__packet__pc__s.html#a8dc482fa50b936b719e83e34f7a9aa0c">thrn</a>;      <span class="comment">// Thread number of task</span></div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;   <span class="keywordtype">int</span>    taskx    = wresult.<a class="code" href="structwork__packet__pc__s.html#adb49b9c01f6c08bc85c5216cd6c874d9">taskx</a>;     <span class="comment">// Task index of task</span></div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<a class="code" href="us__loadable__noise_8h.html#a48744322ededb3a6a1d2a410bb4d8bdc">DbgLv</a>(1) &lt;&lt; <span class="stringliteral">&quot;SCPJ:  thrn&quot;</span> &lt;&lt; thrn &lt;&lt; <span class="stringliteral">&quot;taskx&quot;</span> &lt;&lt; taskx;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;   <span class="keywordtype">double</span> variance = wresult.<a class="code" href="structwork__packet__pc__s.html#aa3e2f1144f2bd5ae6cffa1f348d0fbb8">sim_vals</a>.<a class="code" href="classUS__SolveSim_1_1Simulation.html#a07addb810c685c4dad7b2a7b1fde85f7">variance</a>;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;   <span class="keywordtype">double</span> xnormsq  = wresult.<a class="code" href="structwork__packet__pc__s.html#aa3e2f1144f2bd5ae6cffa1f348d0fbb8">sim_vals</a>.<a class="code" href="classUS__SolveSim_1_1Simulation.html#aba1c5681b9f22c5027a75710f8b86364">xnormsq</a>;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<a class="code" href="us__loadable__noise_8h.html#a48744322ededb3a6a1d2a410bb4d8bdc">DbgLv</a>(1) &lt;&lt; <span class="stringliteral">&quot;SCPJ:   a v x&quot;</span> &lt;&lt; <a class="code" href="classUS__RpScan.html#af79e844d38dc08f82a1c3516b7701e98">alphas</a>[taskx] &lt;&lt; variance &lt;&lt; xnormsq;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;   <a class="code" href="classUS__RpScan.html#a734363c97b5e23e2a09b803ceb553a47">varias</a>[ taskx ] = variance;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;   <a class="code" href="classUS__RpScan.html#adc3f6bb306e3f3be82c8698a1cba9961">xnorms</a>[ taskx ] = xnormsq;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="comment">//   delete wthrd;</span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;   QString astat      =</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;      tr( <span class="stringliteral">&quot;Of %1 models, %2 done (Alpha %3, thread %4)&quot;</span> )</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;      .arg( <a class="code" href="classUS__RpScan.html#a2ef4e12c02d8d5571c5c488b1cbf16e8">nalpha</a> ).arg( <a class="code" href="classUS__RpScan.html#af1913b8e8abf07c102e7276dcd106171">nacomp</a> ).arg( <a class="code" href="classUS__RpScan.html#af79e844d38dc08f82a1c3516b7701e98">alphas</a>[ taskx ] ).arg( thrn );</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;   <a class="code" href="classUS__RpScan.html#ae1290674c1816c67b6234caec58ff86a">le_stattext</a>-&gt;setText( astat );</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<a class="code" href="us__loadable__noise_8h.html#a48744322ededb3a6a1d2a410bb4d8bdc">DbgLv</a>(1) &lt;&lt; <span class="stringliteral">&quot;SCPJ:    astat&quot;</span> &lt;&lt; astat;</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;   <span class="keywordflow">if</span> ( <a class="code" href="classUS__RpScan.html#af1913b8e8abf07c102e7276dcd106171">nacomp</a> == <a class="code" href="classUS__RpScan.html#a2ef4e12c02d8d5571c5c488b1cbf16e8">nalpha</a> )</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;   {  <span class="comment">// We are done with all tasks</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;      qApp-&gt;processEvents();</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<a class="code" href="us__loadable__noise_8h.html#a48744322ededb3a6a1d2a410bb4d8bdc">DbgLv</a>(1) &lt;&lt; <span class="stringliteral">&quot;SCPJ:    ALL-DONE&quot;</span>;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;   }</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;   <span class="keywordflow">if</span> ( <a class="code" href="classUS__RpScan.html#ac14f28b852a18d1fcaa662a93ed7f11a">nasubm</a> &lt; <a class="code" href="classUS__RpScan.html#a2ef4e12c02d8d5571c5c488b1cbf16e8">nalpha</a> )</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;   {  <span class="comment">// We need to set up to submit another task</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;      <a class="code" href="structwork__packet__pc__s.html">WorkPacketPc</a> wtask   = wresult;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;      wtask.<a class="code" href="structwork__packet__pc__s.html#adb49b9c01f6c08bc85c5216cd6c874d9">taskx</a>          = <a class="code" href="classUS__RpScan.html#ac14f28b852a18d1fcaa662a93ed7f11a">nasubm</a>;</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;      wtask.<a class="code" href="structwork__packet__pc__s.html#aa3e2f1144f2bd5ae6cffa1f348d0fbb8">sim_vals</a>.<a class="code" href="classUS__SolveSim_1_1Simulation.html#a1e0b0dbd235fcd66d5662f95d6de7f7d">alpha</a> = <a class="code" href="classUS__RpScan.html#af79e844d38dc08f82a1c3516b7701e98">alphas</a>[ <a class="code" href="classUS__RpScan.html#ac14f28b852a18d1fcaa662a93ed7f11a">nasubm</a> ];</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;      wtask.<a class="code" href="structwork__packet__pc__s.html#aaca9acf8e1c53c305878ca3eb07e755b">dsets</a>          = <a class="code" href="classUS__RpScan.html#a0dde34f6ebc79614fab5bbe018a9eb07">dsets</a>;</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;      wtask.<a class="code" href="structwork__packet__pc__s.html#afefd3a1c312b0cb9b563cdbaf26f9435">depth</a>          = 1;</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;      wtask.<a class="code" href="structwork__packet__pc__s.html#a9844322a86d6799d2144e36a4d8a52f6">state</a>          = 0;</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;      wtask.<a class="code" href="structwork__packet__pc__s.html#abb3f63cb1cb28ea077887f11cafb2c25">psv_nnls_a</a>     = &amp;<a class="code" href="classUS__RpScan.html#ae974991719882b75383481f1ce7b1d89">sv_nnls_a</a>;</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;      wtask.<a class="code" href="structwork__packet__pc__s.html#addf0e70bb95af80b325d5acc9aece891">psv_nnls_b</a>     = &amp;<a class="code" href="classUS__RpScan.html#a737d771410b447b19e34342c474c2fd9">sv_nnls_b</a>;</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<a class="code" href="us__loadable__noise_8h.html#a48744322ededb3a6a1d2a410bb4d8bdc">DbgLv</a>(1) &lt;&lt; <span class="stringliteral">&quot;SCPJ:     new subm nnls_a nnls_b&quot;</span> &lt;&lt; wtask.<a class="code" href="structwork__packet__pc__s.html#abb3f63cb1cb28ea077887f11cafb2c25">psv_nnls_a</a></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160; &lt;&lt; wtask.<a class="code" href="structwork__packet__pc__s.html#addf0e70bb95af80b325d5acc9aece891">psv_nnls_b</a> &lt;&lt; <span class="stringliteral">&quot;b size&quot;</span> &lt;&lt; <a class="code" href="classUS__RpScan.html#a737d771410b447b19e34342c474c2fd9">sv_nnls_b</a>.size();</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;      wtask.<a class="code" href="structwork__packet__pc__s.html#a1a7822b875f556167e51a600f7208e51">csolutes</a>.clear();</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<a class="code" href="us__loadable__noise_8h.html#a48744322ededb3a6a1d2a410bb4d8bdc">DbgLv</a>(1) &lt;&lt; <span class="stringliteral">&quot;SCPJ:     new subm taskx alpha&quot;</span> &lt;&lt; <a class="code" href="classUS__RpScan.html#ac14f28b852a18d1fcaa662a93ed7f11a">nasubm</a> &lt;&lt; wtask.<a class="code" href="structwork__packet__pc__s.html#aa3e2f1144f2bd5ae6cffa1f348d0fbb8">sim_vals</a>.<a class="code" href="classUS__SolveSim_1_1Simulation.html#a1e0b0dbd235fcd66d5662f95d6de7f7d">alpha</a>;</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="comment">//      WorkerThreadPc* wthr   = new WorkerThreadPc( this );</span></div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;      wthrd-&gt;disconnect();</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;      <a class="code" href="classWorkerThreadPc.html">WorkerThreadPc</a>* wthr = wthrd;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;      wthr-&gt;<a class="code" href="classWorkerThreadPc.html#a601321ecaa13f6ab9fa2252146e93a6f">define_work</a>( wtask );</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<a class="code" href="us__loadable__noise_8h.html#a48744322ededb3a6a1d2a410bb4d8bdc">DbgLv</a>(1) &lt;&lt; <span class="stringliteral">&quot;SCPJ:     new subm   work defined  sv_nnls_a&quot;</span> &lt;&lt; wtask.<a class="code" href="structwork__packet__pc__s.html#addf0e70bb95af80b325d5acc9aece891">psv_nnls_b</a>;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="comment">//      wthr-&gt;disconnect();</span></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;      connect( wthr, SIGNAL( work_complete( <a class="code" href="classWorkerThreadPc.html">WorkerThreadPc</a>* ) ),</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;               <span class="keyword">this</span>, SLOT(   <a class="code" href="classUS__RpScan.html#ac72f318abd9b4d446119210270eeb7e1">process_job</a>(   <a class="code" href="classWorkerThreadPc.html">WorkerThreadPc</a>* ) ) );</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;      wthr-&gt;start();</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;      <a class="code" href="classUS__RpScan.html#ac14f28b852a18d1fcaa662a93ed7f11a">nasubm</a>++;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<a class="code" href="us__loadable__noise_8h.html#a48744322ededb3a6a1d2a410bb4d8bdc">DbgLv</a>(1) &lt;&lt; <span class="stringliteral">&quot;SCPJ:     new subm   tsk started&quot;</span> &lt;&lt; <a class="code" href="classUS__RpScan.html#ac14f28b852a18d1fcaa662a93ed7f11a">nasubm</a>;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;   }</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;   qApp-&gt;processEvents();</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;}</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;</div><div class="line"><a name="l00711"></a><span class="lineno"><a class="line" href="classUS__RpScan.html#a775c9ce9f99e9e0bb01f630eba1f3cac">  711</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classUS__RpScan.html#a775c9ce9f99e9e0bb01f630eba1f3cac">US_RpScan::apply_alpha</a>( <span class="keyword">const</span> <span class="keywordtype">double</span> alpha, QVector&lt; double &gt;* psv_nnls_a,</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;      QVector&lt; double &gt;* psv_nnls_b, <span class="keyword">const</span> <span class="keywordtype">int</span> nscans, <span class="keyword">const</span> <span class="keywordtype">int</span> npoints,</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> nisols, <span class="keywordtype">double</span>&amp; variance, <span class="keywordtype">double</span>&amp; xnormsq )</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;{</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;   <span class="keywordtype">int</span>    ntotal   = nscans * npoints;</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;   <span class="keywordtype">int</span>    narows   = ntotal + nisols;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;   <span class="keywordtype">int</span>    ncsols   = 0;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;          variance = 0.0;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;          xnormsq  = 0.0;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;   QVector&lt; double &gt; nnls_a = *psv_nnls_a;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;   QVector&lt; double &gt; nnls_b = *psv_nnls_b;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;   QVector&lt; double &gt; nnls_x;</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;   QVector&lt; double &gt; simdat;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;   nnls_x.fill( 0.0, nisols );</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;   simdat.fill( 0.0, ntotal );</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;qDebug() &lt;&lt; <span class="stringliteral">&quot;AA: ns np ni na&quot;</span> &lt;&lt; nscans &lt;&lt; npoints &lt;&lt; nisols &lt;&lt; narows;</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;   <span class="comment">// Replace alpha in the diagonal of the lower square of A</span></div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;   <span class="keywordtype">int</span>    dx       = ntotal;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;   <span class="keywordtype">int</span>    dinc     = ntotal + nisols + 1;</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="comment">//qDebug() &lt;&lt; &quot;AA:  alf alfd&quot; &lt;&lt; alpha &lt;&lt; alphad &lt;&lt; &quot;dx dinc&quot; &lt;&lt; dx &lt;&lt; dinc;</span></div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;qDebug() &lt;&lt; <span class="stringliteral">&quot;AA:  alf&quot;</span> &lt;&lt; <a class="code" href="classUS__RpScan.html#ae82bf6719884cc75eb7a4ec58f30e6b6">alpha</a> &lt;&lt; <span class="stringliteral">&quot;dx dinc&quot;</span> &lt;&lt; dx &lt;&lt; dinc;</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> cc = 0; cc &lt; nisols; cc++ )</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;   {</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;      nnls_a[ dx ]    = <a class="code" href="classUS__RpScan.html#ae82bf6719884cc75eb7a4ec58f30e6b6">alpha</a>;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;      dx             += dinc;</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;   }</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;   <span class="comment">// Compute the X vector using NNLS</span></div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;   <a class="code" href="classUS__Math2.html#a3d994d90b0c1e6d25b93eaf7a5427568">US_Math2::nnls</a>( nnls_a.data(), narows, narows, nisols,</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                   nnls_b.data(), nnls_x.data() );</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;   <span class="comment">// Construct the output solutes and the implied simulation and xnorm-sq</span></div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> cc = 0; cc &lt; nisols; cc++ )</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;   {</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;      <span class="keywordtype">double</span> soluval  = nnls_x[ cc ];   <span class="comment">// Computed concentration, this solute</span></div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;      <span class="keywordflow">if</span> ( soluval &gt; 0.0 )</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;      {</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;         xnormsq        += <a class="code" href="us__math2_8h.html#ae7616788b30810a219d9cdee95904ba4">sq</a>( soluval );</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;         ncsols++;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;         <span class="keywordtype">int</span>    aa       = cc * narows;</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;         <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> kk = 0; kk &lt; ntotal; kk++ )</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;         {</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;            simdat[ kk ]   += ( soluval * (*psv_nnls_a)[ aa++ ] );</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;         }</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;      }</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;   }</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;   <span class="comment">// Calculate the sum for the variance computation</span></div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> kk = 0; kk &lt; ntotal; kk++ )</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;   {</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;      variance       += <a class="code" href="us__math2_8h.html#ae7616788b30810a219d9cdee95904ba4">sq</a>( ( (*psv_nnls_b)[ kk ] - simdat[ kk ] ) );</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;   }</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;qDebug() &lt;&lt; <span class="stringliteral">&quot;AA:    ntotal&quot;</span> &lt;&lt; ntotal &lt;&lt; <span class="stringliteral">&quot;varisum&quot;</span> &lt;&lt; variance;</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;   <span class="comment">// Return computed variance and xnorm-sq</span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;   variance         /= (double)ntotal;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;qDebug() &lt;&lt; <span class="stringliteral">&quot;AA: alpha&quot;</span> &lt;&lt; <a class="code" href="classUS__RpScan.html#ae82bf6719884cc75eb7a4ec58f30e6b6">alpha</a> &lt;&lt; <span class="stringliteral">&quot;vari xnsq&quot;</span> &lt;&lt; variance &lt;&lt; xnormsq</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160; &lt;&lt; <span class="stringliteral">&quot;ncsols&quot;</span> &lt;&lt; ncsols;</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="keywordtype">int</span> mm = npoints / 2;</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;qDebug() &lt;&lt; <span class="stringliteral">&quot;AA: mm=&quot;</span> &lt;&lt; mm &lt;&lt; <span class="stringliteral">&quot;a[m] b[m] s[m]&quot;</span> &lt;&lt; (*psv_nnls_a)[mm]</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;   &lt;&lt; (*psv_nnls_b)[mm] &lt;&lt; simdat[mm];</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;}</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;</div><div class="ttc" id="classUS__RpScan_html_ae974991719882b75383481f1ce7b1d89"><div class="ttname"><a href="classUS__RpScan.html#ae974991719882b75383481f1ce7b1d89">US_RpScan::sv_nnls_a</a></div><div class="ttdeci">QVector&lt; double &gt; sv_nnls_a</div><div class="ttdef"><b>Definition:</b> <a href="us__rpscan_8h_source.html#l00076">us_rpscan.h:76</a></div></div>
<div class="ttc" id="classUS__RpScan_html_a71a5eff72f6ae1fc74329c2613790096"><div class="ttname"><a href="classUS__RpScan.html#a71a5eff72f6ae1fc74329c2613790096">US_RpScan::reject_it</a></div><div class="ttdeci">void reject_it(void)</div><div class="ttdef"><b>Definition:</b> <a href="us__rpscan_8cpp_source.html#l00197">us_rpscan.cpp:197</a></div></div>
<div class="ttc" id="classUS__RpScan_html_ae124d4a2d18ccbcb2d1b038735058749"><div class="ttname"><a href="classUS__RpScan.html#ae124d4a2d18ccbcb2d1b038735058749">US_RpScan::leftLayout</a></div><div class="ttdeci">QVBoxLayout * leftLayout</div><div class="ttdef"><b>Definition:</b> <a href="us__rpscan_8h_source.html#l00047">us_rpscan.h:47</a></div></div>
<div class="ttc" id="classUS__RpScan_html_a734363c97b5e23e2a09b803ceb553a47"><div class="ttname"><a href="classUS__RpScan.html#a734363c97b5e23e2a09b803ceb553a47">US_RpScan::varias</a></div><div class="ttdeci">QVector&lt; double &gt; varias</div><div class="ttdef"><b>Definition:</b> <a href="us__rpscan_8h_source.html#l00074">us_rpscan.h:74</a></div></div>
<div class="ttc" id="classUS__RpScan_html_ad409e78d19b7760a0d87d9f2d1218a46"><div class="ttname"><a href="classUS__RpScan.html#ad409e78d19b7760a0d87d9f2d1218a46">US_RpScan::ct_incalpha</a></div><div class="ttdeci">QwtCounter * ct_incalpha</div><div class="ttdef"><b>Definition:</b> <a href="us__rpscan_8h_source.html#l00061">us_rpscan.h:61</a></div></div>
<div class="ttc" id="classUS__RpScan_html_a29aa41656a6dbcad59eab37ca922048d"><div class="ttname"><a href="classUS__RpScan.html#a29aa41656a6dbcad59eab37ca922048d">US_RpScan::marker</a></div><div class="ttdeci">QwtPlotMarker * marker</div><div class="ttdef"><b>Definition:</b> <a href="us__rpscan_8h_source.html#l00043">us_rpscan.h:43</a></div></div>
<div class="ttc" id="structwork__packet__pc__s_html_a2d77f80574bbf431561ec15b1ef324c1"><div class="ttname"><a href="structwork__packet__pc__s.html#a2d77f80574bbf431561ec15b1ef324c1">work_packet_pc_s::noisf</a></div><div class="ttdeci">int noisf</div><div class="ttdoc">noise flag (0-3 for NONE,TI,RI,BOTH) </div><div class="ttdef"><b>Definition:</b> <a href="us__worker__pc_8h_source.html#l00026">us_worker_pc.h:26</a></div></div>
<div class="ttc" id="classUS__ModelRecord_html_adaf7b69458e385b37a85334724f5cfe0"><div class="ttname"><a href="classUS__ModelRecord.html#adaf7b69458e385b37a85334724f5cfe0">US_ModelRecord::rmsd</a></div><div class="ttdeci">double rmsd</div><div class="ttdoc">RMSD value. </div><div class="ttdef"><b>Definition:</b> <a href="us__pcsa__modelrec_8h_source.html#l00052">us_pcsa_modelrec.h:52</a></div></div>
<div class="ttc" id="classUS__SolveSim_1_1Simulation_html_a1e0b0dbd235fcd66d5662f95d6de7f7d"><div class="ttname"><a href="classUS__SolveSim_1_1Simulation.html#a1e0b0dbd235fcd66d5662f95d6de7f7d">US_SolveSim::Simulation::alpha</a></div><div class="ttdeci">double alpha</div><div class="ttdoc">Tikhonov regularization factor. </div><div class="ttdef"><b>Definition:</b> <a href="us__solve__sim_8h_source.html#l00070">us_solve_sim.h:70</a></div></div>
<div class="ttc" id="classUS__RpScan_html_a0a5da41e1b0ccbbf5ce8cb4e5c64ca14"><div class="ttname"><a href="classUS__RpScan.html#a0a5da41e1b0ccbbf5ce8cb4e5c64ca14">US_RpScan::nthr</a></div><div class="ttdeci">int &amp; nthr</div><div class="ttdef"><b>Definition:</b> <a href="us__rpscan_8h_source.html#l00032">us_rpscan.h:32</a></div></div>
<div class="ttc" id="structwork__packet__pc__s_html_afefd3a1c312b0cb9b563cdbaf26f9435"><div class="ttname"><a href="structwork__packet__pc__s.html#afefd3a1c312b0cb9b563cdbaf26f9435">work_packet_pc_s::depth</a></div><div class="ttdeci">int depth</div><div class="ttdoc">depth (0-&gt;fit, 1-&gt;alpha-scan) </div><div class="ttdef"><b>Definition:</b> <a href="us__worker__pc_8h_source.html#l00024">us_worker_pc.h:24</a></div></div>
<div class="ttc" id="classUS__RpScan_html_a1e316fdba3c4b5a62fa22ccc91208289"><div class="ttname"><a href="classUS__RpScan.html#a1e316fdba3c4b5a62fa22ccc91208289">US_RpScan::vscl</a></div><div class="ttdeci">double vscl</div><div class="ttdef"><b>Definition:</b> <a href="us__rpscan_8h_source.html#l00070">us_rpscan.h:70</a></div></div>
<div class="ttc" id="classUS__ModelRecord_html_aff3ed3f9bbecc208ac4ce036b948b271"><div class="ttname"><a href="classUS__ModelRecord.html#aff3ed3f9bbecc208ac4ce036b948b271">US_ModelRecord::isolutes</a></div><div class="ttdeci">QVector&lt; US_ZSolute &gt; isolutes</div><div class="ttdoc">Input solutes. </div><div class="ttdef"><b>Definition:</b> <a href="us__pcsa__modelrec_8h_source.html#l00060">us_pcsa_modelrec.h:60</a></div></div>
<div class="ttc" id="us__settings_8h_html"><div class="ttname"><a href="us__settings_8h.html">us_settings.h</a></div></div>
<div class="ttc" id="classUS__RpScan_html_aa774aaa46a0d7e44b89fe0e87f679e88"><div class="ttname"><a href="classUS__RpScan.html#aa774aaa46a0d7e44b89fe0e87f679e88">US_RpScan::mrec</a></div><div class="ttdeci">US_ModelRecord &amp; mrec</div><div class="ttdef"><b>Definition:</b> <a href="us__rpscan_8h_source.html#l00031">us_rpscan.h:31</a></div></div>
<div class="ttc" id="classUS__RpScan_html_ac9916ed83ee043a2332dca629cec0f8c"><div class="ttname"><a href="classUS__RpScan.html#ac9916ed83ee043a2332dca629cec0f8c">US_RpScan::mouse</a></div><div class="ttdeci">void mouse(const QwtDoublePoint &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="us__rpscan_8cpp_source.html#l00611">us_rpscan.cpp:611</a></div></div>
<div class="ttc" id="classUS__RpScan_html_a775c9ce9f99e9e0bb01f630eba1f3cac"><div class="ttname"><a href="classUS__RpScan.html#a775c9ce9f99e9e0bb01f630eba1f3cac">US_RpScan::apply_alpha</a></div><div class="ttdeci">void apply_alpha(const double, QVector&lt; double &gt; *, QVector&lt; double &gt; *, const int, const int, const int, double &amp;, double &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="us__rpscan_8cpp_source.html#l00711">us_rpscan.cpp:711</a></div></div>
<div class="ttc" id="classUS__GuiSettings_html_a9240f8fd7a4b6b2bb4d5f4a040924a37"><div class="ttname"><a href="classUS__GuiSettings.html#a9240f8fd7a4b6b2bb4d5f4a040924a37">US_GuiSettings::fontFamily</a></div><div class="ttdeci">static QString fontFamily(void)</div><div class="ttdoc">Get font family setting. </div><div class="ttdef"><b>Definition:</b> <a href="us__gui__settings_8cpp_source.html#l00017">us_gui_settings.cpp:17</a></div></div>
<div class="ttc" id="classUS__RpScan_html_a84191a4a280a20fea531bb489c150c6b"><div class="ttname"><a href="classUS__RpScan.html#a84191a4a280a20fea531bb489c150c6b">US_RpScan::help</a></div><div class="ttdeci">void help(void)</div><div class="ttdef"><b>Definition:</b> <a href="us__rpscan_8h_source.html#l00094">us_rpscan.h:94</a></div></div>
<div class="ttc" id="us__pcsa_8h_html"><div class="ttname"><a href="us__pcsa_8h.html">us_pcsa.h</a></div></div>
<div class="ttc" id="classUS__SolveSim_1_1Simulation_html_a0ae4082e1e3ef61123332da1a46ed1c9"><div class="ttname"><a href="classUS__SolveSim_1_1Simulation.html#a0ae4082e1e3ef61123332da1a46ed1c9">US_SolveSim::Simulation::zsolutes</a></div><div class="ttdeci">QVector&lt; US_ZSolute &gt; zsolutes</div><div class="ttdoc">Input/Output solutes. </div><div class="ttdef"><b>Definition:</b> <a href="us__solve__sim_8h_source.html#l00075">us_solve_sim.h:75</a></div></div>
<div class="ttc" id="classUS__Math2_html_a3d994d90b0c1e6d25b93eaf7a5427568"><div class="ttname"><a href="classUS__Math2.html#a3d994d90b0c1e6d25b93eaf7a5427568">US_Math2::nnls</a></div><div class="ttdeci">static int nnls(double *a, int a_dim1, int m, int n, double *b, double *x, double *rnorm=NULL, double *wp=NULL, double *zzp=NULL, int *indexp=NULL)</div><div class="ttdef"><b>Definition:</b> <a href="us__math2_8cpp_source.html#l00863">us_math2.cpp:863</a></div></div>
<div class="ttc" id="classUS__Math2_html_aa1ef9a25186985c8f9ab2d3a17c6d058"><div class="ttname"><a href="classUS__Math2.html#aa1ef9a25186985c8f9ab2d3a17c6d058">US_Math2::intersect</a></div><div class="ttdeci">static bool intersect(double &amp;, double &amp;, double &amp;, double &amp;, double *, double *)</div><div class="ttdoc">Given the slopes and intercepts of two lines, return the intersection point of the two lines...</div><div class="ttdef"><b>Definition:</b> <a href="us__math2_8cpp_source.html#l00316">us_math2.cpp:316</a></div></div>
<div class="ttc" id="classUS__WidgetsDialog_html"><div class="ttname"><a href="classUS__WidgetsDialog.html">US_WidgetsDialog</a></div><div class="ttdoc">Set up widgets the UltraScan way. </div><div class="ttdef"><b>Definition:</b> <a href="us__widgets__dialog_8h_source.html#l00031">us_widgets_dialog.h:31</a></div></div>
<div class="ttc" id="classUS__RpScan_html_af79e844d38dc08f82a1c3516b7701e98"><div class="ttname"><a href="classUS__RpScan.html#af79e844d38dc08f82a1c3516b7701e98">US_RpScan::alphas</a></div><div class="ttdeci">QVector&lt; double &gt; alphas</div><div class="ttdef"><b>Definition:</b> <a href="us__rpscan_8h_source.html#l00073">us_rpscan.h:73</a></div></div>
<div class="ttc" id="structwork__packet__pc__s_html_ad40e9acfd1f5430d5d4fda6e44c165aa"><div class="ttname"><a href="structwork__packet__pc__s.html#ad40e9acfd1f5430d5d4fda6e44c165aa">work_packet_pc_s::par1</a></div><div class="ttdeci">double par1</div><div class="ttdoc">sigmoid model par1 value </div><div class="ttdef"><b>Definition:</b> <a href="us__worker__pc_8h_source.html#l00030">us_worker_pc.h:30</a></div></div>
<div class="ttc" id="classUS__RpScan_html_ae1290674c1816c67b6234caec58ff86a"><div class="ttname"><a href="classUS__RpScan.html#ae1290674c1816c67b6234caec58ff86a">US_RpScan::le_stattext</a></div><div class="ttdeci">QLineEdit * le_stattext</div><div class="ttdef"><b>Definition:</b> <a href="us__rpscan_8h_source.html#l00057">us_rpscan.h:57</a></div></div>
<div class="ttc" id="classUS__WidgetsDialog_html_a92c176cd1696a73581ffffad32651392"><div class="ttname"><a href="classUS__WidgetsDialog.html#a92c176cd1696a73581ffffad32651392">US_WidgetsDialog::us_curve</a></div><div class="ttdeci">QwtPlotCurve * us_curve(QwtPlot *, const QString &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="us__widgets__dialog_8cpp_source.html#l00366">us_widgets_dialog.cpp:366</a></div></div>
<div class="ttc" id="classUS__RpScan_html_aa68675b633ab0db9abb598a0c238186f"><div class="ttname"><a href="classUS__RpScan.html#aa68675b633ab0db9abb598a0c238186f">US_RpScan::le_selalpha</a></div><div class="ttdeci">QLineEdit * le_selalpha</div><div class="ttdef"><b>Definition:</b> <a href="us__rpscan_8h_source.html#l00056">us_rpscan.h:56</a></div></div>
<div class="ttc" id="classUS__RpScan_html_abe3980d48229f2b7f39771fb6706dcfd"><div class="ttname"><a href="classUS__RpScan.html#abe3980d48229f2b7f39771fb6706dcfd">US_RpScan::rightLayout</a></div><div class="ttdeci">QVBoxLayout * rightLayout</div><div class="ttdef"><b>Definition:</b> <a href="us__rpscan_8h_source.html#l00048">us_rpscan.h:48</a></div></div>
<div class="ttc" id="classUS__Math2_html_ac9887709fd5d15d23369c7289d1a5ae1"><div class="ttname"><a href="classUS__Math2.html#ac9887709fd5d15d23369c7289d1a5ae1">US_Math2::nearest_curve_point</a></div><div class="ttdeci">static int nearest_curve_point(double *, double *, const int, bool, double &amp;, double &amp;, double *, double *, double *, double *)</div><div class="ttdoc">Given a set of curve points and a given outside point, return the curve point nearest the given point...</div><div class="ttdef"><b>Definition:</b> <a href="us__math2_8cpp_source.html#l00195">us_math2.cpp:195</a></div></div>
<div class="ttc" id="classUS__RpScan_html_a319f2fabd47c9d5aafded392ed8a9403"><div class="ttname"><a href="classUS__RpScan.html#a319f2fabd47c9d5aafded392ed8a9403">US_RpScan::xscl</a></div><div class="ttdeci">double xscl</div><div class="ttdef"><b>Definition:</b> <a href="us__rpscan_8h_source.html#l00071">us_rpscan.h:71</a></div></div>
<div class="ttc" id="classUS__WidgetsDialog_html_af885c37a818aee690ce2e76af584da13"><div class="ttname"><a href="classUS__WidgetsDialog.html#af885c37a818aee690ce2e76af584da13">US_WidgetsDialog::us_progressBar</a></div><div class="ttdeci">QProgressBar * us_progressBar(int, int, int=0)</div><div class="ttdef"><b>Definition:</b> <a href="us__widgets__dialog_8cpp_source.html#l00233">us_widgets_dialog.cpp:233</a></div></div>
<div class="ttc" id="classUS__RpScan_html_a0a4515d4cf1fe7096741c7977864ab2d"><div class="ttname"><a href="classUS__RpScan.html#a0a4515d4cf1fe7096741c7977864ab2d">US_RpScan::plot_data</a></div><div class="ttdeci">void plot_data(void)</div><div class="ttdef"><b>Definition:</b> <a href="us__rpscan_8cpp_source.html#l00438">us_rpscan.cpp:438</a></div></div>
<div class="ttc" id="classUS__Settings_html_aa42f5a10a330ef63746bd55e930e208a"><div class="ttname"><a href="classUS__Settings.html#aa42f5a10a330ef63746bd55e930e208a">US_Settings::us_debug</a></div><div class="ttdeci">static int us_debug(void)</div><div class="ttdoc">Get the US_Debug setting. </div><div class="ttdef"><b>Definition:</b> <a href="us__settings_8cpp_source.html#l00191">us_settings.cpp:191</a></div></div>
<div class="ttc" id="classUS__RpScan_html_a2031ae8ecd7fe5d5e4514c8f66e1050e"><div class="ttname"><a href="classUS__RpScan.html#a2031ae8ecd7fe5d5e4514c8f66e1050e">US_RpScan::plotLayout1</a></div><div class="ttdeci">US_Plot * plotLayout1</div><div class="ttdef"><b>Definition:</b> <a href="us__rpscan_8h_source.html#l00037">us_rpscan.h:37</a></div></div>
<div class="ttc" id="classUS__RpScan_html_a192b8f1a258847c542c637541c68e556"><div class="ttname"><a href="classUS__RpScan.html#a192b8f1a258847c542c637541c68e556">US_RpScan::ct_stralpha</a></div><div class="ttdeci">QwtCounter * ct_stralpha</div><div class="ttdef"><b>Definition:</b> <a href="us__rpscan_8h_source.html#l00059">us_rpscan.h:59</a></div></div>
<div class="ttc" id="classUS__SolveSim_1_1Simulation_html_ad143ba9609b409f6ab271b361f706dd9"><div class="ttname"><a href="classUS__SolveSim_1_1Simulation.html#ad143ba9609b409f6ab271b361f706dd9">US_SolveSim::Simulation::noisflag</a></div><div class="ttdeci">int noisflag</div><div class="ttdoc">Calculated-noise flag: 0-3. </div><div class="ttdef"><b>Definition:</b> <a href="us__solve__sim_8h_source.html#l00077">us_solve_sim.h:77</a></div></div>
<div class="ttc" id="classUS__ModelRecord_html_a289f05665308be5bedc658c65d3a4eb7"><div class="ttname"><a href="classUS__ModelRecord.html#a289f05665308be5bedc658c65d3a4eb7">US_ModelRecord::taskx</a></div><div class="ttdeci">int taskx</div><div class="ttdoc">Task index (submit order) </div><div class="ttdef"><b>Definition:</b> <a href="us__pcsa__modelrec_8h_source.html#l00039">us_pcsa_modelrec.h:39</a></div></div>
<div class="ttc" id="classUS__RpScan_html_af44f9385e0cd14e6ec1856b6b9317c53"><div class="ttname"><a href="classUS__RpScan.html#af44f9385e0cd14e6ec1856b6b9317c53">US_RpScan::mainLayout</a></div><div class="ttdeci">QHBoxLayout * mainLayout</div><div class="ttdef"><b>Definition:</b> <a href="us__rpscan_8h_source.html#l00046">us_rpscan.h:46</a></div></div>
<div class="ttc" id="classUS__SolveSim_1_1Simulation_html_a290878cc7ab24441b3cd4c9e74d2c539"><div class="ttname"><a href="classUS__SolveSim_1_1Simulation.html#a290878cc7ab24441b3cd4c9e74d2c539">US_SolveSim::Simulation::dbg_level</a></div><div class="ttdeci">int dbg_level</div><div class="ttdoc">Debug level. </div><div class="ttdef"><b>Definition:</b> <a href="us__solve__sim_8h_source.html#l00078">us_solve_sim.h:78</a></div></div>
<div class="ttc" id="namespaceUS__WinData_html_a85f3cb45f5a36707c5fc56eea6821d55"><div class="ttname"><a href="namespaceUS__WinData.html#a85f3cb45f5a36707c5fc56eea6821d55">US_WinData::p</a></div><div class="ttdeci">struct US_WinData::processes p[]</div><div class="ttdoc">An array of processes. </div></div>
<div class="ttc" id="classUS__RpScan_html_a4a438843f580b188f4dd1575b2191df8"><div class="ttname"><a href="classUS__RpScan.html#a4a438843f580b188f4dd1575b2191df8">US_RpScan::US_RpScan</a></div><div class="ttdeci">US_RpScan(QList&lt; US_SolveSim::DataSet * &gt; &amp;, US_ModelRecord &amp;, int &amp;, double &amp;, QWidget *p=0)</div><div class="ttdoc">Regularization Parameter Scan constructor. </div><div class="ttdef"><b>Definition:</b> <a href="us__rpscan_8cpp_source.html#l00019">us_rpscan.cpp:19</a></div></div>
<div class="ttc" id="classUS__RpScan_html_a1a9f2e5e68b4c6be442a90495232f14f"><div class="ttname"><a href="classUS__RpScan.html#a1a9f2e5e68b4c6be442a90495232f14f">US_RpScan::scan</a></div><div class="ttdeci">void scan(void)</div><div class="ttdef"><b>Definition:</b> <a href="us__rpscan_8cpp_source.html#l00212">us_rpscan.cpp:212</a></div></div>
<div class="ttc" id="classWorkerThreadPc_html"><div class="ttname"><a href="classWorkerThreadPc.html">WorkerThreadPc</a></div><div class="ttdoc">Worker thread to do the actual computational work of PCSA analysis. </div><div class="ttdef"><b>Definition:</b> <a href="us__worker__pc_8h_source.html#l00051">us_worker_pc.h:51</a></div></div>
<div class="ttc" id="classUS__WidgetsDialog_html_a76fe047edde0ad939dd865c840a1bde0"><div class="ttname"><a href="classUS__WidgetsDialog.html#a76fe047edde0ad939dd865c840a1bde0">US_WidgetsDialog::us_lineedit</a></div><div class="ttdeci">QLineEdit * us_lineedit(const QString &amp;=0, int=0, bool=false)</div><div class="ttdef"><b>Definition:</b> <a href="us__widgets__dialog_8cpp_source.html#l00108">us_widgets_dialog.cpp:108</a></div></div>
<div class="ttc" id="classWorkerThreadPc_html_a7b896df1f9497a2743bfce6492a585a9"><div class="ttname"><a href="classWorkerThreadPc.html#a7b896df1f9497a2743bfce6492a585a9">WorkerThreadPc::get_result</a></div><div class="ttdeci">void get_result(WorkPacketPc &amp;)</div><div class="ttdoc">Get the results work packet of a completed worker thread. </div><div class="ttdef"><b>Definition:</b> <a href="us__worker__pc_8cpp_source.html#l00086">us_worker_pc.cpp:86</a></div></div>
<div class="ttc" id="us__gui__util_8h_html"><div class="ttname"><a href="us__gui__util_8h.html">us_gui_util.h</a></div></div>
<div class="ttc" id="classUS__RpScan_html_ad541ec56537a721fa16634c4fbe15c9d"><div class="ttname"><a href="classUS__RpScan.html#ad541ec56537a721fa16634c4fbe15c9d">US_RpScan::lgv</a></div><div class="ttdeci">int lgv</div><div class="ttdef"><b>Definition:</b> <a href="us__rpscan_8h_source.html#l00067">us_rpscan.h:67</a></div></div>
<div class="ttc" id="classUS__RpScan_html_a0a6d604d2ef8c5774481f57c399541d1"><div class="ttname"><a href="classUS__RpScan.html#a0a6d604d2ef8c5774481f57c399541d1">US_RpScan::v_line</a></div><div class="ttdeci">QwtPlotCurve * v_line</div><div class="ttdef"><b>Definition:</b> <a href="us__rpscan_8h_source.html#l00041">us_rpscan.h:41</a></div></div>
<div class="ttc" id="structwork__packet__pc__s_html_ad5cf7a9a554c08ab44f0f94f152de78a"><div class="ttname"><a href="structwork__packet__pc__s.html#ad5cf7a9a554c08ab44f0f94f152de78a">work_packet_pc_s::end_y</a></div><div class="ttdeci">double end_y</div><div class="ttdoc">model end y value </div><div class="ttdef"><b>Definition:</b> <a href="us__worker__pc_8h_source.html#l00029">us_worker_pc.h:29</a></div></div>
<div class="ttc" id="classUS__ModelRecord_html_a3a86e722c5e27fb6b4616d32d92c2bda"><div class="ttname"><a href="classUS__ModelRecord.html#a3a86e722c5e27fb6b4616d32d92c2bda">US_ModelRecord::csolutes</a></div><div class="ttdeci">QVector&lt; US_ZSolute &gt; csolutes</div><div class="ttdoc">Computed solutes. </div><div class="ttdef"><b>Definition:</b> <a href="us__pcsa__modelrec_8h_source.html#l00061">us_pcsa_modelrec.h:61</a></div></div>
<div class="ttc" id="classUS__RpScan_html_a693c9b87865a3f540f7060bc17904948"><div class="ttname"><a href="classUS__RpScan.html#a693c9b87865a3f540f7060bc17904948">US_RpScan::dbg_level</a></div><div class="ttdeci">int dbg_level</div><div class="ttdef"><b>Definition:</b> <a href="us__rpscan_8h_source.html#l00063">us_rpscan.h:63</a></div></div>
<div class="ttc" id="classUS__RpScan_html_a0da0c2c3b6f65a12f070281c64107665"><div class="ttname"><a href="classUS__RpScan.html#a0da0c2c3b6f65a12f070281c64107665">US_RpScan::le_mtype</a></div><div class="ttdeci">QLineEdit * le_mtype</div><div class="ttdef"><b>Definition:</b> <a href="us__rpscan_8h_source.html#l00052">us_rpscan.h:52</a></div></div>
<div class="ttc" id="classUS__RpScan_html_a8e7101409590eb31842b0dca296ed9f5"><div class="ttname"><a href="classUS__RpScan.html#a8e7101409590eb31842b0dca296ed9f5">US_RpScan::accept_it</a></div><div class="ttdeci">void accept_it(void)</div><div class="ttdef"><b>Definition:</b> <a href="us__rpscan_8cpp_source.html#l00204">us_rpscan.cpp:204</a></div></div>
<div class="ttc" id="classUS__GuiSettings_html_add175856da34329ec19668f2ec94fa6e"><div class="ttname"><a href="classUS__GuiSettings.html#add175856da34329ec19668f2ec94fa6e">US_GuiSettings::frameColor</a></div><div class="ttdeci">static QPalette frameColor(void)</div><div class="ttdoc">Get current frame palette. </div><div class="ttdef"><b>Definition:</b> <a href="us__gui__settings_8cpp_source.html#l00218">us_gui_settings.cpp:218</a></div></div>
<div class="ttc" id="structwork__packet__pc__s_html_aaca9acf8e1c53c305878ca3eb07e755b"><div class="ttname"><a href="structwork__packet__pc__s.html#aaca9acf8e1c53c305878ca3eb07e755b">work_packet_pc_s::dsets</a></div><div class="ttdeci">QList&lt; US_SolveSim::DataSet *&gt; dsets</div><div class="ttdoc">list of data set object pointers </div><div class="ttdef"><b>Definition:</b> <a href="us__worker__pc_8h_source.html#l00041">us_worker_pc.h:41</a></div></div>
<div class="ttc" id="classWorkerThreadPc_html_a601321ecaa13f6ab9fa2252146e93a6f"><div class="ttname"><a href="classWorkerThreadPc.html#a601321ecaa13f6ab9fa2252146e93a6f">WorkerThreadPc::define_work</a></div><div class="ttdeci">void define_work(WorkPacketPc &amp;)</div><div class="ttdoc">Define the work packet for a worker thread. </div><div class="ttdef"><b>Definition:</b> <a href="us__worker__pc_8cpp_source.html#l00044">us_worker_pc.cpp:44</a></div></div>
<div class="ttc" id="structwork__packet__pc__s_html_a8dc482fa50b936b719e83e34f7a9aa0c"><div class="ttname"><a href="structwork__packet__pc__s.html#a8dc482fa50b936b719e83e34f7a9aa0c">work_packet_pc_s::thrn</a></div><div class="ttdeci">int thrn</div><div class="ttdoc">thread number (1,...) </div><div class="ttdef"><b>Definition:</b> <a href="us__worker__pc_8h_source.html#l00022">us_worker_pc.h:22</a></div></div>
<div class="ttc" id="classUS__SolveSim_html"><div class="ttname"><a href="classUS__SolveSim.html">US_SolveSim</a></div><div class="ttdoc">Solve a simulation, using an experiment data set, a model, and simulation parameters. </div><div class="ttdef"><b>Definition:</b> <a href="us__solve__sim_8h_source.html#l00024">us_solve_sim.h:24</a></div></div>
<div class="ttc" id="classUS__ModelRecord_html_ac4f1d2a6a363ad4a634d01aa63465ae6"><div class="ttname"><a href="classUS__ModelRecord.html#ac4f1d2a6a363ad4a634d01aa63465ae6">US_ModelRecord::str_y</a></div><div class="ttdeci">double str_y</div><div class="ttdoc">Start k value. </div><div class="ttdef"><b>Definition:</b> <a href="us__pcsa__modelrec_8h_source.html#l00046">us_pcsa_modelrec.h:46</a></div></div>
<div class="ttc" id="classUS__RpScan_html_a4003569cb1acc48bcd6d97bf9aa4f295"><div class="ttname"><a href="classUS__RpScan.html#a4003569cb1acc48bcd6d97bf9aa4f295">US_RpScan::data_plot1</a></div><div class="ttdeci">QwtPlot * data_plot1</div><div class="ttdef"><b>Definition:</b> <a href="us__rpscan_8h_source.html#l00039">us_rpscan.h:39</a></div></div>
<div class="ttc" id="classUS__SolveSim_1_1Simulation_html_aba1c5681b9f22c5027a75710f8b86364"><div class="ttname"><a href="classUS__SolveSim_1_1Simulation.html#aba1c5681b9f22c5027a75710f8b86364">US_SolveSim::Simulation::xnormsq</a></div><div class="ttdeci">double xnormsq</div><div class="ttdoc">X-norm squared. </div><div class="ttdef"><b>Definition:</b> <a href="us__solve__sim_8h_source.html#l00069">us_solve_sim.h:69</a></div></div>
<div class="ttc" id="classUS__WidgetsDialog_html_a318a7e6cfd48b32a81f89a1ef0fb104b"><div class="ttname"><a href="classUS__WidgetsDialog.html#a318a7e6cfd48b32a81f89a1ef0fb104b">US_WidgetsDialog::us_counter</a></div><div class="ttdeci">QwtCounter * us_counter(int, double, double, double=0.0)</div><div class="ttdef"><b>Definition:</b> <a href="us__widgets__dialog_8cpp_source.html#l00280">us_widgets_dialog.cpp:280</a></div></div>
<div class="ttc" id="classUS__Math2_html_a2c6a484e0b2c11ba23e657e42141009f"><div class="ttname"><a href="classUS__Math2.html#a2c6a484e0b2c11ba23e657e42141009f">US_Math2::linefit</a></div><div class="ttdeci">static double linefit(double **, double **, double *, double *, double *, double *, int)</div><div class="ttdoc">Given a line as a set of x and y coordinates, calculate the line&amp;#39;s characteristics. </div><div class="ttdef"><b>Definition:</b> <a href="us__math2_8cpp_source.html#l00107">us_math2.cpp:107</a></div></div>
<div class="ttc" id="structwork__packet__pc__s_html_adb49b9c01f6c08bc85c5216cd6c874d9"><div class="ttname"><a href="structwork__packet__pc__s.html#adb49b9c01f6c08bc85c5216cd6c874d9">work_packet_pc_s::taskx</a></div><div class="ttdeci">int taskx</div><div class="ttdoc">task index (0,...) </div><div class="ttdef"><b>Definition:</b> <a href="us__worker__pc_8h_source.html#l00023">us_worker_pc.h:23</a></div></div>
<div class="ttc" id="classUS__RpScan_html_a2cc5331af7602f5efad43f3d3698693d"><div class="ttname"><a href="classUS__RpScan.html#a2cc5331af7602f5efad43f3d3698693d">US_RpScan::pltctrlsLayout</a></div><div class="ttdeci">QGridLayout * pltctrlsLayout</div><div class="ttdef"><b>Definition:</b> <a href="us__rpscan_8h_source.html#l00049">us_rpscan.h:49</a></div></div>
<div class="ttc" id="classUS__WidgetsDialog_html_a929072f81802a01b5676e92e18fb0447"><div class="ttname"><a href="classUS__WidgetsDialog.html#a929072f81802a01b5676e92e18fb0447">US_WidgetsDialog::us_grid</a></div><div class="ttdeci">QwtPlotGrid * us_grid(QwtPlot *)</div><div class="ttdef"><b>Definition:</b> <a href="us__widgets__dialog_8cpp_source.html#l00355">us_widgets_dialog.cpp:355</a></div></div>
<div class="ttc" id="classUS__RpScan_html_a5d0acb5eb449295ac7399decafc47163"><div class="ttname"><a href="classUS__RpScan.html#a5d0acb5eb449295ac7399decafc47163">US_RpScan::pick</a></div><div class="ttdeci">US_PlotPicker * pick</div><div class="ttdef"><b>Definition:</b> <a href="us__rpscan_8h_source.html#l00044">us_rpscan.h:44</a></div></div>
<div class="ttc" id="classUS__ModelRecord_html_a9e28ac7afac09bd3c3feee0714876370"><div class="ttname"><a href="classUS__ModelRecord.html#a9e28ac7afac09bd3c3feee0714876370">US_ModelRecord::end_y</a></div><div class="ttdeci">double end_y</div><div class="ttdoc">End k value. </div><div class="ttdef"><b>Definition:</b> <a href="us__pcsa__modelrec_8h_source.html#l00047">us_pcsa_modelrec.h:47</a></div></div>
<div class="ttc" id="structwork__packet__pc__s_html"><div class="ttname"><a href="structwork__packet__pc__s.html">work_packet_pc_s</a></div><div class="ttdoc">Worker thread task packet. </div><div class="ttdef"><b>Definition:</b> <a href="us__worker__pc_8h_source.html#l00020">us_worker_pc.h:20</a></div></div>
<div class="ttc" id="classUS__RpScan_html_aa70e25c29dd1460ebca43be4031e2318"><div class="ttname"><a href="classUS__RpScan.html#aa70e25c29dd1460ebca43be4031e2318">US_RpScan::le_mdlpar2</a></div><div class="ttdeci">QLineEdit * le_mdlpar2</div><div class="ttdef"><b>Definition:</b> <a href="us__rpscan_8h_source.html#l00055">us_rpscan.h:55</a></div></div>
<div class="ttc" id="classUS__RpScan_html_ae5e0c0ac7a01b6f858b5081d167ebb3f"><div class="ttname"><a href="classUS__RpScan.html#ae5e0c0ac7a01b6f858b5081d167ebb3f">US_RpScan::le_mdlpar1</a></div><div class="ttdeci">QLineEdit * le_mdlpar1</div><div class="ttdef"><b>Definition:</b> <a href="us__rpscan_8h_source.html#l00054">us_rpscan.h:54</a></div></div>
<div class="ttc" id="classUS__ModelRecord_html_a715cba5b8e7ccfd54bdd9371e69d4f27"><div class="ttname"><a href="classUS__ModelRecord.html#a715cba5b8e7ccfd54bdd9371e69d4f27">US_ModelRecord::variance</a></div><div class="ttdeci">double variance</div><div class="ttdoc">Variance value. </div><div class="ttdef"><b>Definition:</b> <a href="us__pcsa__modelrec_8h_source.html#l00051">us_pcsa_modelrec.h:51</a></div></div>
<div class="ttc" id="structwork__packet__pc__s_html_adc4d9caba6b7db9ddb8070fe480231dd"><div class="ttname"><a href="structwork__packet__pc__s.html#adc4d9caba6b7db9ddb8070fe480231dd">work_packet_pc_s::par2</a></div><div class="ttdeci">double par2</div><div class="ttdoc">sigmoid model par2 value </div><div class="ttdef"><b>Definition:</b> <a href="us__worker__pc_8h_source.html#l00031">us_worker_pc.h:31</a></div></div>
<div class="ttc" id="classUS__RpScan_html_a9b4a0f43193cb272897c687058aa9ff8"><div class="ttname"><a href="classUS__RpScan.html#a9b4a0f43193cb272897c687058aa9ff8">US_RpScan::le_npoints</a></div><div class="ttdeci">QLineEdit * le_npoints</div><div class="ttdef"><b>Definition:</b> <a href="us__rpscan_8h_source.html#l00053">us_rpscan.h:53</a></div></div>
<div class="ttc" id="classUS__Plot_html"><div class="ttname"><a href="classUS__Plot.html">US_Plot</a></div><div class="ttdoc">A class that provides plot widgets. </div><div class="ttdef"><b>Definition:</b> <a href="us__plot_8h_source.html#l00055">us_plot.h:55</a></div></div>
<div class="ttc" id="us__loadable__noise_8h_html_a48744322ededb3a6a1d2a410bb4d8bdc"><div class="ttname"><a href="us__loadable__noise_8h.html#a48744322ededb3a6a1d2a410bb4d8bdc">DbgLv</a></div><div class="ttdeci">#define DbgLv(a)</div><div class="ttdoc">debug-level-conditioned qDebug() </div><div class="ttdef"><b>Definition:</b> <a href="us__loadable__noise_8h_source.html#l00016">us_loadable_noise.h:16</a></div></div>
<div class="ttc" id="classUS__RpScan_html_a2ef4e12c02d8d5571c5c488b1cbf16e8"><div class="ttname"><a href="classUS__RpScan.html#a2ef4e12c02d8d5571c5c488b1cbf16e8">US_RpScan::nalpha</a></div><div class="ttdeci">int nalpha</div><div class="ttdef"><b>Definition:</b> <a href="us__rpscan_8h_source.html#l00064">us_rpscan.h:64</a></div></div>
<div class="ttc" id="classUS__ModelRecord_html_a014a3f5fe678ce301c304515c31ef869"><div class="ttname"><a href="classUS__ModelRecord.html#a014a3f5fe678ce301c304515c31ef869">US_ModelRecord::par1</a></div><div class="ttdeci">double par1</div><div class="ttdoc">Sigmoid/PL par1/A value. </div><div class="ttdef"><b>Definition:</b> <a href="us__pcsa__modelrec_8h_source.html#l00048">us_pcsa_modelrec.h:48</a></div></div>
<div class="ttc" id="us__math2_8h_html"><div class="ttname"><a href="us__math2_8h.html">us_math2.h</a></div></div>
<div class="ttc" id="classUS__GuiSettings_html_a9bc386c32fb0f28ed71e8cb780371e9b"><div class="ttname"><a href="classUS__GuiSettings.html#a9bc386c32fb0f28ed71e8cb780371e9b">US_GuiSettings::plotCurve</a></div><div class="ttdeci">static QColor plotCurve(void)</div><div class="ttdoc">Get current plot curve color. </div><div class="ttdef"><b>Definition:</b> <a href="us__gui__settings_8cpp_source.html#l00431">us_gui_settings.cpp:431</a></div></div>
<div class="ttc" id="us__rpscan_8h_html"><div class="ttname"><a href="us__rpscan_8h.html">us_rpscan.h</a></div></div>
<div class="ttc" id="us__math2_8h_html_ae7616788b30810a219d9cdee95904ba4"><div class="ttname"><a href="us__math2_8h.html#ae7616788b30810a219d9cdee95904ba4">sq</a></div><div class="ttdeci">#define sq(x)</div><div class="ttdoc">us_math2.h </div><div class="ttdef"><b>Definition:</b> <a href="us__math2_8h_source.html#l00010">us_math2.h:10</a></div></div>
<div class="ttc" id="structwork__packet__pc__s_html_aa3e2f1144f2bd5ae6cffa1f348d0fbb8"><div class="ttname"><a href="structwork__packet__pc__s.html#aa3e2f1144f2bd5ae6cffa1f348d0fbb8">work_packet_pc_s::sim_vals</a></div><div class="ttdeci">US_SolveSim::Simulation sim_vals</div><div class="ttdoc">simulation values </div><div class="ttdef"><b>Definition:</b> <a href="us__worker__pc_8h_source.html#l00042">us_worker_pc.h:42</a></div></div>
<div class="ttc" id="classUS__RpScan_html_ad8851f90a438f6dd5b45774096f44e40"><div class="ttname"><a href="classUS__RpScan.html#ad8851f90a438f6dd5b45774096f44e40">US_RpScan::lgx</a></div><div class="ttdeci">int lgx</div><div class="ttdef"><b>Definition:</b> <a href="us__rpscan_8h_source.html#l00068">us_rpscan.h:68</a></div></div>
<div class="ttc" id="us__sleep_8h_html"><div class="ttname"><a href="us__sleep_8h.html">us_sleep.h</a></div></div>
<div class="ttc" id="classUS__WidgetsDialog_html_ac5ff592876f121e8de67e072df43cfa6"><div class="ttname"><a href="classUS__WidgetsDialog.html#ac5ff592876f121e8de67e072df43cfa6">US_WidgetsDialog::us_pushbutton</a></div><div class="ttdeci">QPushButton * us_pushbutton(const QString &amp;, bool=true, int=0)</div><div class="ttdef"><b>Definition:</b> <a href="us__widgets__dialog_8cpp_source.html#l00074">us_widgets_dialog.cpp:74</a></div></div>
<div class="ttc" id="classUS__RpScan_html_a8f8612f8a30f779893d88039976a7e0f"><div class="ttname"><a href="classUS__RpScan.html#a8f8612f8a30f779893d88039976a7e0f">US_RpScan::wthreads</a></div><div class="ttdeci">QList&lt; WorkerThreadPc *&gt; wthreads</div><div class="ttdef"><b>Definition:</b> <a href="us__rpscan_8h_source.html#l00035">us_rpscan.h:35</a></div></div>
<div class="ttc" id="structwork__packet__pc__s_html_abb3f63cb1cb28ea077887f11cafb2c25"><div class="ttname"><a href="structwork__packet__pc__s.html#abb3f63cb1cb28ea077887f11cafb2c25">work_packet_pc_s::psv_nnls_a</a></div><div class="ttdeci">QVector&lt; double &gt; * psv_nnls_a</div><div class="ttdoc">pointer to nnls A matrix </div><div class="ttdef"><b>Definition:</b> <a href="us__worker__pc_8h_source.html#l00038">us_worker_pc.h:38</a></div></div>
<div class="ttc" id="classUS__SolveSim_html_a9af78c1a2397dc1fa1388cdda0295b72"><div class="ttname"><a href="classUS__SolveSim.html#a9af78c1a2397dc1fa1388cdda0295b72">US_SolveSim::calc_residuals</a></div><div class="ttdeci">void calc_residuals(int, int, Simulation &amp;, bool=false, QVector&lt; double &gt; *=0, QVector&lt; double &gt; *=0, QVector&lt; double &gt; *=0)</div><div class="ttdoc">Calculate a simulation and the resulting residuals. </div><div class="ttdef"><b>Definition:</b> <a href="us__solve__sim_8cpp_source.html#l00164">us_solve_sim.cpp:164</a></div></div>
<div class="ttc" id="classUS__RpScan_html_a737d771410b447b19e34342c474c2fd9"><div class="ttname"><a href="classUS__RpScan.html#a737d771410b447b19e34342c474c2fd9">US_RpScan::sv_nnls_b</a></div><div class="ttdeci">QVector&lt; double &gt; sv_nnls_b</div><div class="ttdef"><b>Definition:</b> <a href="us__rpscan_8h_source.html#l00077">us_rpscan.h:77</a></div></div>
<div class="ttc" id="classUS__ModelRecord_html"><div class="ttname"><a href="classUS__ModelRecord.html">US_ModelRecord</a></div><div class="ttdoc">US_ModelRecord object. </div><div class="ttdef"><b>Definition:</b> <a href="us__pcsa__modelrec_8h_source.html#l00031">us_pcsa_modelrec.h:31</a></div></div>
<div class="ttc" id="classUS__RpScan_html_a5e55d588278713b388532d5f0075dc68"><div class="ttname"><a href="classUS__RpScan.html#a5e55d588278713b388532d5f0075dc68">US_RpScan::grid</a></div><div class="ttdeci">QwtPlotGrid * grid</div><div class="ttdef"><b>Definition:</b> <a href="us__rpscan_8h_source.html#l00042">us_rpscan.h:42</a></div></div>
<div class="ttc" id="classUS__ModelRecord_html_a6662defffb761058dfb669e0fc2500f3"><div class="ttname"><a href="classUS__ModelRecord.html#a6662defffb761058dfb669e0fc2500f3">US_ModelRecord::par2</a></div><div class="ttdeci">double par2</div><div class="ttdoc">Sigmoid/PL par2/B value. </div><div class="ttdef"><b>Definition:</b> <a href="us__pcsa__modelrec_8h_source.html#l00049">us_pcsa_modelrec.h:49</a></div></div>
<div class="ttc" id="classUS__PlotPicker_html"><div class="ttname"><a href="classUS__PlotPicker.html">US_PlotPicker</a></div><div class="ttdoc">Customize plot picker characteristics and mouse events. </div><div class="ttdef"><b>Definition:</b> <a href="us__plot_8h_source.html#l00376">us_plot.h:376</a></div></div>
<div class="ttc" id="structwork__packet__pc__s_html_a1a7822b875f556167e51a600f7208e51"><div class="ttname"><a href="structwork__packet__pc__s.html#a1a7822b875f556167e51a600f7208e51">work_packet_pc_s::csolutes</a></div><div class="ttdeci">QVector&lt; US_ZSolute &gt; csolutes</div><div class="ttdoc">computed solutes </div><div class="ttdef"><b>Definition:</b> <a href="us__worker__pc_8h_source.html#l00035">us_worker_pc.h:35</a></div></div>
<div class="ttc" id="structwork__packet__pc__s_html_ad473908a6cefed4d48845dbf8f2203d3"><div class="ttname"><a href="structwork__packet__pc__s.html#ad473908a6cefed4d48845dbf8f2203d3">work_packet_pc_s::str_y</a></div><div class="ttdeci">double str_y</div><div class="ttdoc">model start y value </div><div class="ttdef"><b>Definition:</b> <a href="us__worker__pc_8h_source.html#l00028">us_worker_pc.h:28</a></div></div>
<div class="ttc" id="classUS__GuiSettings_html_a0503197dacde223a1688eaa38449fe25"><div class="ttname"><a href="classUS__GuiSettings.html#a0503197dacde223a1688eaa38449fe25">US_GuiSettings::fontSize</a></div><div class="ttdeci">static int fontSize(void)</div><div class="ttdoc">Get font size setting. </div><div class="ttdef"><b>Definition:</b> <a href="us__gui__settings_8cpp_source.html#l00032">us_gui_settings.cpp:32</a></div></div>
<div class="ttc" id="classUS__RpScan_html_a5854c74286db65fa1064778e373f9b0b"><div class="ttname"><a href="classUS__RpScan.html#a5854c74286db65fa1064778e373f9b0b">US_RpScan::ct_endalpha</a></div><div class="ttdeci">QwtCounter * ct_endalpha</div><div class="ttdef"><b>Definition:</b> <a href="us__rpscan_8h_source.html#l00060">us_rpscan.h:60</a></div></div>
<div class="ttc" id="structwork__packet__pc__s_html_a9844322a86d6799d2144e36a4d8a52f6"><div class="ttname"><a href="structwork__packet__pc__s.html#a9844322a86d6799d2144e36a4d8a52f6">work_packet_pc_s::state</a></div><div class="ttdeci">int state</div><div class="ttdoc">state flag (0-3 for READY,RUNNING,COMPLETE,ABORTED) </div><div class="ttdef"><b>Definition:</b> <a href="us__worker__pc_8h_source.html#l00025">us_worker_pc.h:25</a></div></div>
<div class="ttc" id="us__gui__settings_8h_html"><div class="ttname"><a href="us__gui__settings_8h.html">us_gui_settings.h</a></div></div>
<div class="ttc" id="classUS__RpScan_html_a5f0012ac896c1b1341ba18bf77884296"><div class="ttname"><a href="classUS__RpScan.html#a5f0012ac896c1b1341ba18bf77884296">US_RpScan::buttonsLayout</a></div><div class="ttdeci">QHBoxLayout * buttonsLayout</div><div class="ttdef"><b>Definition:</b> <a href="us__rpscan_8h_source.html#l00050">us_rpscan.h:50</a></div></div>
<div class="ttc" id="classUS__SolveSim_1_1Simulation_html_a07addb810c685c4dad7b2a7b1fde85f7"><div class="ttname"><a href="classUS__SolveSim_1_1Simulation.html#a07addb810c685c4dad7b2a7b1fde85f7">US_SolveSim::Simulation::variance</a></div><div class="ttdeci">double variance</div><div class="ttdoc">Total variance. </div><div class="ttdef"><b>Definition:</b> <a href="us__solve__sim_8h_source.html#l00068">us_solve_sim.h:68</a></div></div>
<div class="ttc" id="structwork__packet__pc__s_html_abf445fc86dab71781a7867ea8a93a125"><div class="ttname"><a href="structwork__packet__pc__s.html#abf445fc86dab71781a7867ea8a93a125">work_packet_pc_s::isolutes</a></div><div class="ttdeci">QVector&lt; US_ZSolute &gt; isolutes</div><div class="ttdoc">input solutes </div><div class="ttdef"><b>Definition:</b> <a href="us__worker__pc_8h_source.html#l00034">us_worker_pc.h:34</a></div></div>
<div class="ttc" id="classUS__SolveSim_1_1Simulation_html"><div class="ttname"><a href="classUS__SolveSim_1_1Simulation.html">US_SolveSim::Simulation</a></div><div class="ttdoc">Class for communicating simulation. </div><div class="ttdef"><b>Definition:</b> <a href="us__solve__sim_8h_source.html#l00062">us_solve_sim.h:62</a></div></div>
<div class="ttc" id="classUS__WidgetsDialog_html_a6682bbf362a7f13b082893e54d47bfd2"><div class="ttname"><a href="classUS__WidgetsDialog.html#a6682bbf362a7f13b082893e54d47bfd2">US_WidgetsDialog::us_banner</a></div><div class="ttdeci">QLabel * us_banner(const QString &amp;, int=0, int=QFont::Bold)</div><div class="ttdef"><b>Definition:</b> <a href="us__widgets__dialog_8cpp_source.html#l00058">us_widgets_dialog.cpp:58</a></div></div>
<div class="ttc" id="us__gui__util_8h_html_a3f4a96754578df9a5970e7a9b09bd8f1"><div class="ttname"><a href="us__gui__util_8h.html#a3f4a96754578df9a5970e7a9b09bd8f1">dataPlotClear</a></div><div class="ttdeci">#define dataPlotClear(a)</div><div class="ttdef"><b>Definition:</b> <a href="us__gui__util_8h_source.html#l00013">us_gui_util.h:13</a></div></div>
<div class="ttc" id="classUS__Sleep_html_afe5bbbbaa8eee77fdaa8ad1a99757a83"><div class="ttname"><a href="classUS__Sleep.html#afe5bbbbaa8eee77fdaa8ad1a99757a83">US_Sleep::msleep</a></div><div class="ttdeci">static void msleep(unsigned long msecs)</div><div class="ttdoc">A static function that sleeps milliseconds. </div><div class="ttdef"><b>Definition:</b> <a href="us__sleep_8h_source.html#l00029">us_sleep.h:29</a></div></div>
<div class="ttc" id="classUS__RpScan_html_adc3f6bb306e3f3be82c8698a1cba9961"><div class="ttname"><a href="classUS__RpScan.html#adc3f6bb306e3f3be82c8698a1cba9961">US_RpScan::xnorms</a></div><div class="ttdeci">QVector&lt; double &gt; xnorms</div><div class="ttdef"><b>Definition:</b> <a href="us__rpscan_8h_source.html#l00075">us_rpscan.h:75</a></div></div>
<div class="ttc" id="classUS__RpScan_html_ae82bf6719884cc75eb7a4ec58f30e6b6"><div class="ttname"><a href="classUS__RpScan.html#ae82bf6719884cc75eb7a4ec58f30e6b6">US_RpScan::alpha</a></div><div class="ttdeci">double &amp; alpha</div><div class="ttdef"><b>Definition:</b> <a href="us__rpscan_8h_source.html#l00033">us_rpscan.h:33</a></div></div>
<div class="ttc" id="classUS__RpScan_html_a0dde34f6ebc79614fab5bbe018a9eb07"><div class="ttname"><a href="classUS__RpScan.html#a0dde34f6ebc79614fab5bbe018a9eb07">US_RpScan::dsets</a></div><div class="ttdeci">QList&lt; US_SolveSim::DataSet *&gt; &amp; dsets</div><div class="ttdef"><b>Definition:</b> <a href="us__rpscan_8h_source.html#l00030">us_rpscan.h:30</a></div></div>
<div class="ttc" id="classUS__RpScan_html_af1913b8e8abf07c102e7276dcd106171"><div class="ttname"><a href="classUS__RpScan.html#af1913b8e8abf07c102e7276dcd106171">US_RpScan::nacomp</a></div><div class="ttdeci">int nacomp</div><div class="ttdef"><b>Definition:</b> <a href="us__rpscan_8h_source.html#l00066">us_rpscan.h:66</a></div></div>
<div class="ttc" id="classUS__WidgetsDialog_html_a6609f3c76d6df5e63da38f20e3c82626"><div class="ttname"><a href="classUS__WidgetsDialog.html#a6609f3c76d6df5e63da38f20e3c82626">US_WidgetsDialog::us_label</a></div><div class="ttdeci">QLabel * us_label(const QString &amp;, int=0, int=QFont::Bold)</div><div class="ttdef"><b>Definition:</b> <a href="us__widgets__dialog_8cpp_source.html#l00026">us_widgets_dialog.cpp:26</a></div></div>
<div class="ttc" id="classUS__RpScan_html_ac14f28b852a18d1fcaa662a93ed7f11a"><div class="ttname"><a href="classUS__RpScan.html#ac14f28b852a18d1fcaa662a93ed7f11a">US_RpScan::nasubm</a></div><div class="ttdeci">int nasubm</div><div class="ttdef"><b>Definition:</b> <a href="us__rpscan_8h_source.html#l00065">us_rpscan.h:65</a></div></div>
<div class="ttc" id="classUS__RpScan_html_a8f8516724c3481bd843776855f1c9dbf"><div class="ttname"><a href="classUS__RpScan.html#a8f8516724c3481bd843776855f1c9dbf">US_RpScan::b_progress</a></div><div class="ttdeci">QProgressBar * b_progress</div><div class="ttdef"><b>Definition:</b> <a href="us__rpscan_8h_source.html#l00081">us_rpscan.h:81</a></div></div>
<div class="ttc" id="structwork__packet__pc__s_html_addf0e70bb95af80b325d5acc9aece891"><div class="ttname"><a href="structwork__packet__pc__s.html#addf0e70bb95af80b325d5acc9aece891">work_packet_pc_s::psv_nnls_b</a></div><div class="ttdeci">QVector&lt; double &gt; * psv_nnls_b</div><div class="ttdoc">pointer to nnls B matrix </div><div class="ttdef"><b>Definition:</b> <a href="us__worker__pc_8h_source.html#l00039">us_worker_pc.h:39</a></div></div>
<div class="ttc" id="classUS__RpScan_html_ac72f318abd9b4d446119210270eeb7e1"><div class="ttname"><a href="classUS__RpScan.html#ac72f318abd9b4d446119210270eeb7e1">US_RpScan::process_job</a></div><div class="ttdeci">void process_job(WorkerThreadPc *)</div><div class="ttdef"><b>Definition:</b> <a href="us__rpscan_8cpp_source.html#l00651">us_rpscan.cpp:651</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Jul 11 2025 12:51:04 for UltraScan III by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
