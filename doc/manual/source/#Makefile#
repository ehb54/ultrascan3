#Makefile for Sphinx documentation

SPHINXBUILD = sphinx-build
SOURCEDIR   = .
BUILDDIR    = ../build/doc/manual
INSTALLDIR  = ../../../bin
PROJECT    	= manual

.PHONY: all help html qthelp qch qhc qthelpinstall latex latexpdf

all: html qthelpinstall pdf

help:
	@echo "Sphinx Makefile targets:"
	@echo "  make all              to call html qthelpinstall pdf"
	@echo "  make html             to build HTML documentation"
	@echo "  make qthelp           to build Qt Help (.qhp/.qhcp)"
	@echo "  make qthelpinstall    to copy .qch and .qhc to bin"
	@echo "  make latex            to generate LaTeX source files"
	@echo "  make pdf              to generate PDF (requires LaTeX tools)"
	@echo "  make help             to show this message"

html:
	$(SPHINXBUILD) -b html $(SOURCEDIR) $(BUILDDIR)/html

qthelp:
	$(SPHINXBUILD) -b qthelp $(SOURCEDIR) $(BUILDDIR)/qthelp
	qhelpgenerator $(BUILDDIR)/qthelp/$(PROJECT).qhp -o $(BUILDDIR)/qthelp/$(PROJECT).qch
	qhelpgenerator $(BUILDDIR)/qthelp/$(PROJECT).qhcp -o $(BUILDDIR)/qthelp/$(PROJECT).qhc

qthelpinstall: qthelp
	@mkdir -p $(INSTALLDIR)
	@cp -v $(BUILDDIR)/qthelp/$(PROJECT).qch $(INSTALLDIR)/
	@cp -v $(BUILDDIR)/qthelp/$(PROJECT).qhc $(INSTALLDIR)/

latex:
	$(SPHINXBUILD) -b latex $(SOURCEDIR) $(BUILDDIR)/latex

pdf: latex
	$(MAKE) -C $(BUILDDIR)/latex all-pdf

clean:
	rm -rf $(BUILDDIR)/html
	rm -rf $(BUILDDIR)/latex
	rm -rf $(BUILDDIR)/qthelp
	rm -f $(INSTALLDIR)/$(PROJECT).qch
	rm -f $(INSTALLDIR)/$(PROJECT).qhc
